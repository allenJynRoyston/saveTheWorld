var PhaserGameObject=function(){function t(){this.game=null,this.global={pause:!1}}return t.prototype.init=function(t,e,i){var n=new PHASER_MASTER({game:new Phaser.Game(i.width,i.height,Phaser.WEBGL,t,{preload:function(){var t=n.game();t.load.enableParallel=!0,t.stage.backgroundColor="#2f2f2f";var e="src/phaser/saveTheWorld/resources";t.load.image("bullet",e+"/images/bullet.png"),t.load.image("bomb",e+"/images/enemy-bullet.png"),t.load.spritesheet("invader",e+"/images/invader32x32x4.png",32,32),t.load.image("player",e+"/images/ship.png"),t.load.spritesheet("kaboom",e+"/images/explode.png",128,128),t.load.image("background",e+"/images/starfield.png"),t.load.image("particlefx",e+"/images/gem.png"),t.load.image("earth",e+"/images/earth.png"),t.load.bitmapFont("gem",e+"/fonts/gem.png",e+"/fonts/gem.xml"),n.changeState("PRELOAD"),new PHASER_PRELOADER({game:t,delayInSeconds:0,done:function(){var t,e,i;t=n.game(),e=n.get("devMode"),i=function(){var t=n.game(),e=o.add({name:"player",reference:"player",visible:!1});return e.anchor.setTo(.5,.5),e.scale.setTo(.5,.5),e.isInvincible=!0,t.physics.enable(e,Phaser.Physics.ARCADE),u.add(8,e),e.onUpdate=function(){o.getGroup("trails").length,n.checkState("ENDLEVEL");var e=o.add({name:"trail_"+t.rnd.integer(),group:"trails",x:this.x,y:this.y,reference:"player",visible:!0});e.anchor.setTo(.5,.5),e.scale.setTo(this.scale.x,this.scale.y),e.alpha=.5,e.tint=255,u.add(7,e),e.destroySelf=function(){var t=this;this.game.add.tween(this).to({alpha:0},n.checkState("ENDLEVEL")?400:100,Phaser.Easing.Linear.In,!0,0).onComplete.add(function(){o.destroy(t.name)},this)},e.destroySelf()},e.selfDestruct=function(){var e=this;t.add.tween(this.scale).to({x:.25,y:.25},350,Phaser.Easing.Linear.In,!0,0).game.add.tween(this).to({angle:720},350,Phaser.Easing.Linear.In,!0,0).onComplete.add(function(){o.destroy(e.name),v(e.x,e.y,1.5)},this)},e.moveToStart=function(){this.visible=!0,this.x=this.game.world.centerX,this.y=this.game.world.centerY+550,t.add.tween(this).to({y:t.world.centerY+200},1e3,Phaser.Easing.Exponential.InOut,!0,0,0,!1)},e.moveX=function(t){this.x+=t,this.checkLimits()},e.moveY=function(t){this.y+=t,this.checkLimits()},e.checkLimits=function(){this.y-this.height<0&&(this.y=this.height),this.y+this.height>this.game.canvas.height&&(this.y=this.game.canvas.height-this.height),this.x<0&&(this.x=this.game.canvas.width+this.width),this.x>this.game.canvas.width+this.width&&(this.x=0)},e.playEndSequence=function(t){var e=this;this.game.add.tween(this.scale).to({x:2,y:2},1500,Phaser.Easing.Exponential.InOut,!0,0,0,!1),this.game.add.tween(this).to({x:this.game.world.centerX,y:this.game.world.centerY+50},1500,Phaser.Easing.Exponential.InOut,!0,0,0,!1).onComplete.add(function(){e.game.add.tween(e).to({y:e.game.world.height+200},1500,Phaser.Easing.Exponential.InOut,!0,250,0,!1).onComplete.add(function(){e.game.add.tween(e).to({y:-200},1e3,Phaser.Easing.Exponential.InOut,!0,0,0,!1).onComplete.add(function(){t()},e)},e)},this)},e}(),o.get("overlay").fadeOut(Phaser.Timer.SECOND/2,function(){p("SAVE THE WORLD",function(){i.moveToStart(),t.time.events.add(e?0*Phaser.Timer.SECOND:1*Phaser.Timer.SECOND,function(){p(n.get("roundTime")+" SECONDS GO",function(){h.getGroup("timeKeeper").forEach(function(t){t.reveal()}),t.time.events.add(e?0*Phaser.Timer.SECOND:Phaser.Timer.SECOND/2,function(){h.getGroup("ui").forEach(function(t){t.reveal()}),o.getGroup("ui").forEach(function(t){t.reveal()})}).autoDestroy=!0,n.get("clock").start(),n.changeState("READY")})})})})}})},create:function(){var t=n.game(),i=n.get("gameData");a.assign(t),r.assign(t),o.assign(t),s.assign(t),h.assign(t),d.assign(t),u.assign(t),l.assign(t),n.let("score",i.score),n.let("roundTime",30),n.let("clock",t.time.create(!1)),n.let("elapsedTime",0),n.let("devMode",!1),n.let("starMomentum",{x:0,y:0}),n.let("population",{total:i.population.total,killed:i.population.killed}),n.let("primaryWeapon",i.primaryWeapon),n.let("secondaryWeapon",i.secondaryWeapon),t.onPause.add(function(){n.get("clock").stop()},this),t.onResume.add(function(){n.get("clock").start()},this),t.physics.startSystem(Phaser.Physics.ARCADE);var c=o.add({x:0,y:0,name:"filterBG",group:"filter",reference:"background"});c.width=t.world.width,c.height=t.world.height;var y=n.let("filter",new Phaser.Filter(t,{iChannel0:{type:"sampler2D",value:c.texture,textureData:{repeat:!0}}},["precision mediump float;","uniform float     time;","uniform vec2      resolution;","uniform sampler2D iChannel0;","void main( void ) {","float t = time;","vec2 uv = gl_FragCoord.xy / resolution.xy;","vec2 texcoord = gl_FragCoord.xy / vec2(resolution.y);","texcoord.y -= t*0.2;","float zz = 1.0/(1.0-uv.y*1.7);","texcoord.y -= zz * sign(zz);","vec2 maa = texcoord.xy * vec2(zz, 1.0) - vec2(zz, 0.0) ;","vec2 maa2 = (texcoord.xy * vec2(zz, 1.0) - vec2(zz, 0.0))*0.3 ;","vec4 stone = texture2D(iChannel0, maa);","vec4 blips = texture2D(iChannel0, maa);","vec4 mixer = texture2D(iChannel0, maa2);","float shade = abs(1.0/zz);","vec3 outp = mix(shade*stone.rgb, mix(1.0, shade, abs(sin(t+maa.y-sin(maa.x))))*blips.rgb, min(1.0, pow(mixer.g*2.1, 2.0)));","gl_FragColor = vec4(outp,1.0);","}"]));y.setResolution(1920,1080),c.filters=[y],u.add(0,c);var m=s.addGradient({name:"blockBmp",group:"particles",start:"#FFFF00",end:"#ff8100",width:2,height:2,render:!1}),f=n.let("emitter",t.add.emitter(t,0,0,1e3));f.makeParticles(m),f.gravity=0,u.layer(1).add(f);for(var b=s.addGradient({name:"starBmp",group:"blockBmpGroup",start:"#ffffff",end:"#ffffff",width:1,height:1,render:!1}),x=function(){var e=o.add({name:"star_"+E,group:"movingStarField",x:t.rnd.integerInRange(0,t.world.width),y:t.rnd.integerInRange(0,t.world.height),reference:b});e.starType=t.rnd.integerInRange(1,3),e.scale.setTo(e.starType,e.starType),e.onUpdate=function(){var i=.25+5*(3-e.starType),a=n.get("starMomentum");this.y>this.game.world.height&&(this.y=10,this.x=t.rnd.integerInRange(-100,t.world.width)),this.x>this.game.world.width&&(this.x=0),this.x<0&&(this.x=this.game.world.width),a.x>0&&(a.x-=.05),a.x<0&&(a.x+=.05),a.y>0&&(a.y-=.05),a.y<0&&(a.y+=.05),this.x+=(3-e.starType)*a.x,this.y+=i+a.y},e.fadeOut=function(){this.game.add.tween(this).to({alpha:0},Phaser.Timer.SECOND,Phaser.Easing.Back.InOut,!0,t.rnd.integerInRange(0,500),0,!1).autoDestroy=!0},u.layer(4-e.starType).add(e)},E=0;E<25;E++)x();var T=o.add({reference:"earth",name:"earth",group:"earth",x:this.game.world.centerX,y:this.game.canvas.height+900});T.scale.setTo(3.5,3.5),T.anchor.setTo(.5,.5),T.onUpdate=function(){T.angle+=.01},T.fadeOut=function(){this.game.add.tween(this).to({y:this.y+200,alpha:1},9*Phaser.Timer.SECOND,Phaser.Easing.Linear.Out,!0,0,0,!1).autoDestroy=!0},T.selfDestruct=function(){var e,i,a,r,o,s,h=this;e=this,i=this.tint,a=16711680,r=8*Phaser.Timer.SECOND,o={step:0},(s=n.game().add.tween(o).to({step:100},r)).onUpdateCallback(function(){e.tint=Phaser.Color.interpolateColor(i,a,100,o.step)}),e.tint=i,s.start();for(var d=0;d<100;d++)setTimeout(function(){v(t.rnd.integerInRange(0,h.game.canvas.width),t.rnd.integerInRange(h.game.canvas.height-200,h.game.canvas.height),.25)},100*d)},u.add(2,T);var P=h.add({name:"timeSeconds",group:"timeKeeper",font:"gem",size:65,default:"25",visible:!1});h.alignToTopCenter("timeSeconds",20),P.onUpdate=function(){n.get("elapsedTime");var t=n.get("elapsedTime");t+=.001*n.get("clock").elapsed,n.forceLet("elapsedTime",t);var i,a,r=n.get("roundTime"),s=parseInt((r-t).toFixed(0));s>=0?this.setText(""+s):(i=n.game(),a=n.get("gameData"),n.changeState("ENDLEVEL"),h.getGroup("ui").forEach(function(t){t.hide()}),o.getGroup("ui").forEach(function(t){t.hide()}),h.getGroup("timeKeeper").forEach(function(t){t.hide()}),o.get("player").playEndSequence(function(){var t=a.level++;g("level",++t);for(var r=0;r<20;r++)setTimeout(function(){v(i.rnd.integerInRange(0,i.world.width),i.rnd.integerInRange(0,i.world.height),i.rnd.integerInRange(1,4))},i.rnd.integerInRange(0,50)*r);setTimeout(function(){o.getGroup("aliens").forEach(function(t){setTimeout(function(){t.destroyIt(!1)},i.rnd.integerInRange(0,500))}),o.getGroup("trashes").forEach(function(t){setTimeout(function(){t.destroyIt(!1)},i.rnd.integerInRange(0,500))}),setTimeout(function(){p("NICE JOB STUD",function(){o.getGroup("movingStarField").forEach(function(t){t.fadeOut()}),o.get("earth").fadeOut(),setTimeout(function(){var t=n.get("population"),a=h.add({name:"popLeft",font:"gem",y:i.world.centerY,size:58,default:"Humans saved:",visible:!0});h.alignToCenter("popLeft"),a.game.add.tween(a).to({alpha:0},1e3,Phaser.Easing.Linear.Out,!0,Phaser.Timer.SECOND).onComplete.add(function(){a.alpha=1,a.setText(""+7e5*(t.total-t.killed)),h.alignToCenter("popLeft"),a.game.add.tween(a).to({alpha:0},1e3,Phaser.Easing.Linear.Out,!0,2*Phaser.Timer.SECOND).onComplete.add(function(){o.get("overlay").fadeIn(1.5*Phaser.Timer.SECOND,function(){e.nextLevel()})})})},Phaser.Timer.SECOND)})},1.5*Phaser.Timer.SECOND)},Phaser.Timer.SECOND/3)}))},P.reveal=function(){this.y=-200,this.visible=!0,this.game.add.tween(this).to({y:10},Phaser.Timer.SECOND,Phaser.Easing.Back.InOut,!0,0,0,!1)},P.hide=function(){this.game.add.tween(this).to({y:-200},Phaser.Timer.SECOND,Phaser.Easing.Back.InOut,!0,0,0,!1)};var I=h.add({name:"scoreText",group:"ui",x:10,y:10,font:"gem",size:18,default:"Score: "+n.get("score"),visible:!1});I.onUpdate=function(){},I.updateScore=function(){this.setText("Score: "+n.get("score"))},I.reveal=function(){this.y=-this.height,this.visible=!0,t.add.tween(this).to({y:10},Phaser.Timer.SECOND,Phaser.Easing.Back.InOut,!0,0,0,!1)},I.hide=function(){t.add.tween(this).to({y:-100},Phaser.Timer.SECOND,Phaser.Easing.Back.InOut,!0,0,0,!1)};var R=h.add({name:"roundText",group:"ui",x:t.world.width-100,y:10,font:"gem",size:18,default:"Round: "+i.level,visible:!1});R.onUpdate=function(){},R.reveal=function(){this.y=-this.height,this.visible=!0,this.game.add.tween(this).to({y:10},Phaser.Timer.SECOND,Phaser.Easing.Back.InOut,!0,0,0,!1)},R.hide=function(){this.game.add.tween(this).to({y:-100},Phaser.Timer.SECOND,Phaser.Easing.Back.InOut,!0,0,0,!1)};var A=h.add({name:"healthText",group:"ui",font:"gem",x:15,y:t.canvas.height-23,size:16,default:"",visible:!1});A.onUpdate=function(){var t=n.get("population");this.setText("Population: "+7e6*(t.total-t.killed))},A.reveal=function(){this.x=-this.width,this.visible=!0,this.game.add.tween(this).to({x:15},Phaser.Timer.SECOND,Phaser.Easing.Back.InOut,!0,0,0,!1)},A.hide=function(){this.game.add.tween(this).to({x:-this.width-100},Phaser.Timer.SECOND,Phaser.Easing.Back.InOut,!0,0,0,!1)},u.addMany(9,[I,R,P]);var D=l.addGradient({name:"overlaybmd",start:"#2f2f2f",end:"#2f2f2f",width:5,height:5,render:!1}),w=o.add({x:0,y:0,name:"overlay",reference:D.cacheBitmapData,visible:!0});w.width=t.canvas.width,w.height=t.canvas.height,w.fadeIn=function(e,i){t.add.tween(this).to({alpha:1},e,Phaser.Easing.Linear.In,!0,0,0,!1),setTimeout(function(){i()},e)},w.fadeOut=function(e,i){t.add.tween(this).to({alpha:0},e,Phaser.Easing.Linear.Out,!0,0,0,!1),setTimeout(function(){i()},e)},u.addMany(10,[w]);var C=l.addGradient({name:"bmpHealthbar",group:"ui",start:"#0000FF",end:"#33B5E5",width:t.canvas.width-10,height:20,render:!1}),O=o.add({x:5,y:t.canvas.height-25,name:"healthbar",group:"ui",reference:C.cacheBitmapData,visible:!1});O.scale.setTo(1,1),O.defaultWidth=O.width,O.width=O.width-Math.round(O.width*(i.population.killed/i.population.total)),O.takeDamage=function(t){var i=n.get("population");i.killed+=t;var a,r,s,d,u=t/i.total,c=i.killed/i.total;if(c>=1){if(i={total:i.total,killed:i.total},"GAMEOVER"!==n.getCurrentState()){var y=h.get("healthText");y.setText(""),this.width=0,function(){n.changeState("GAMEOVER");var t=o.get("player"),i=o.get("earth");t.selfDestruct(),i.selfDestruct(),p("DUDE IT WAS THE FIRST LEVEL JEEZE",function(){setTimeout(function(){o.get("overlay").fadeIn(3*Phaser.Timer.SECOND,function(){e.gameOver()})},1.5*Phaser.Timer.SECOND)})}()}}else a={x:this.width-8,y:this.y,width:Math.round(this.defaultWidth*u),height:this.height},r=n.game(),s=l.get("chipDamageBmp"),(d=o.add({x:a.x,y:a.y,name:"chipdamage_"+r.rnd.integer(),group:"chipdamage",reference:s.cacheBitmapData,visible:!0})).width=a.width,d.tweenIt=function(){var t=this;this.game.add.tween(this).to({width:0},250,Phaser.Easing.Linear.Out,!0,100).onComplete.add(function(){o.destroy(t.name)})},d.tweenIt(),this.width=this.defaultWidth-Math.round(this.defaultWidth*c);g("population",{total:i.total,killed:i.killed}),n.forceLet("population",i)},O.onUpdate=function(){},O.reveal=function(){this.y=t.canvas.height+100,this.visible=!0,this.game.add.tween(this).to({y:t.canvas.height-25},1500,Phaser.Easing.Linear.In,!0,0,0,!1)},O.hide=function(){this.game.add.tween(this).to({y:t.canvas.height+100},1500,Phaser.Easing.Elastic.InOut,!0,0,0,!1)},l.addGradient({name:"chipDamageBmp",group:"chipdamage",start:"#2f3640",end:"#e84118",width:1,height:20,render:!1}),u.addMany(9,[O]);var S=o.add({x:-100,y:t.canvas.height-55,name:"specialWeapon",group:"ui",reference:"bomb",visible:!1});S.anchor.setTo(.5,.5),S.scale.setTo(2,2),S.onUpdate=function(){},S.reveal=function(){this.visible=!0,this.game.add.tween(this).to({x:30},Phaser.Timer.SECOND,Phaser.Easing.Back.InOut,!0,0,0,!1)},S.hide=function(){this.visible=!0,this.game.add.tween(this).to({x:-100},Phaser.Timer.SECOND,Phaser.Easing.Back.OutIn,!0,0,0,!1)},S.onPress=function(e){var i=this,n=h.get("specialWeaponText");this.alpha=.25,n.alpha=.5,n.setText("Reloading..."),this.game.add.tween(this).to({alpha:1},e-50,Phaser.Easing.Linear.In,!0,0,0,!1),t.time.events.add(e-50,function(){i.alpha=1,n.alpha=1,n.resetText()},this)};var B=h.add({name:"specialWeaponText",group:"ui",font:"gem",x:-100,y:t.canvas.height-63,size:16,default:"",visible:!1});B.resetText=function(){this.setText("Cluster Bombs")},B.onUpdate=function(){},B.reveal=function(){this.resetText(),this.visible=!0,this.game.add.tween(this).to({x:55},Phaser.Timer.SECOND,Phaser.Easing.Back.InOut,!0,0,0,!1)},B.hide=function(){this.game.add.tween(this).to({x:-100},Phaser.Timer.SECOND,Phaser.Easing.Back.InOut,!0,0,0,!1)},u.addMany(9,[S,B])},update:function(){var t=n.game();n.get("filter").update();var e=n.get("starMomentum"),i=o.get("player"),r=o.get("specialWeapon"),s=n.get("primaryWeapon"),d=n.get("secondaryWeapon");o.get("earth").onUpdate(),o.getGroup("movingStarField").forEach(function(t){t.onUpdate()}),n.checkState("READY")&&(o.getGroup("aliens").length<5&&function(t){var e=n.game(),i=o.add({x:t.x,y:t.y,name:"alien_"+e.rnd.integer(),group:"aliens",reference:"invader",visible:!0});i.anchor.setTo(.5,.5),i.scale.setTo(1.5,1.5),e.physics.enable(i,Phaser.Physics.ARCADE),i.body.velocity.y=t.iy,i.body.velocity.x=t.ix,i.angleMomentum=e.rnd.integerInRange(-5,5),i.body.bounce.setTo(1,1),i.atTarget=!1,i.maxHealth=150,i.health=i.maxHealth,i.fallThreshold=e.rnd.integerInRange(0,75),u.add(3,i),i.damageIt=function(t){if(!this.atTarget){var e=n.get("emitter");e.x=this.x,e.y=this.y,e.start(!0,1500,null,5),this.health-=t,this.tint=16711680,this.game.add.tween(this).to({tint:16777215},100,Phaser.Easing.Linear.Out,!0,0,0,!1),this.health<=0&&this.destroyIt()}},i.removeIt=function(){o.destroy(this.name)},i.destroyIt=function(t){var i=this;void 0===t&&(t=!0);var a=n.get("score");n.forceLet("score",a+=100),g("score",a);var r=h.get("scoreText");r.updateScore();var s={angle:e.rnd.integerInRange(-720,720),x:this.x-e.rnd.integerInRange(-25,25),y:this.y-e.rnd.integerInRange(5,25),alpha:.5};this.game.add.tween(this).to(s,e.rnd.integerInRange(150,500),Phaser.Easing.Linear.Out,!0,0,0,!1),this.body=null,e.time.events.add(Phaser.Timer.SECOND/2,function(){if(v(i.x,i.y,1),t)for(var n=0;n<5;n++)y({x:i.x,y:i.y,ix:e.rnd.integerInRange(-100,100),iy:-e.rnd.integerInRange(-20,20)});o.destroy(i.name)},this).autoDestroy=!0},i.fallToPlanet=function(){var t=this;this.tint=0,this.atTarget=!0,this.body=null,this.game.add.tween(this).to({y:this.y+60},2*Phaser.Timer.SECOND,Phaser.Easing.Linear.In,!0,0).autoDestroy=!0,setTimeout(function(){t.game.add.tween(t.scale).to({x:0,y:0},1*Phaser.Timer.SECOND,Phaser.Easing.Linear.In,!0,e.rnd.integerInRange(0,500)).onComplete.add(function(){t.removeIt(),o.get("healthbar").takeDamage(2),v(t.x,t.y,.25)}).autoDestroy=!0},300)},i.checkLocation=function(){this.angle+=i.angleMomentum,this.angleMomentum>0&&(this.angleMomentum-=.002),this.angleMomentum<0&&(this.angleMomentum+=.002),this.y>this.height&&null!==this.body&&(this.body.collideWorldBounds=!0),this.y>this.game.canvas.height-(75+this.fallThreshold)&&(null===this.body||this.atTarget||(this.body.collideWorldBounds=!1,this.fallToPlanet()))},i.onUpdate=function(){i.atTarget||(null!==this.body&&(this.body.velocity.y+2<100&&(this.body.velocity.y+=2),this.body.velocity.x>0&&(this.body.velocity.x-=.2),this.body.velocity.x<0&&(this.body.velocity.x+=.2)),this.checkLocation())}}({x:t.rnd.integerInRange(0,t.canvas.width),y:t.rnd.integerInRange(-50,-100),ix:t.rnd.integerInRange(-100,100),iy:t.rnd.integerInRange(0,150)}),h.getGroup("ui").forEach(function(t){t.onUpdate()}),h.getGroup("timeKeeper").forEach(function(t){t.onUpdate()}),o.getGroup("bullets").forEach(function(t){t.onUpdate()}),o.getGroup("aliens").forEach(function(t){t.onUpdate()}),o.getGroup("trashes").forEach(function(t){t.onUpdate()}),o.getGroup("bombs").forEach(function(t){t.onUpdate()}),o.getGroup("bomblets").forEach(function(t){t.onUpdate()}),o.getGroup("impactExplosions").forEach(function(t){t.onUpdate()}),a.read("RIGHT").active&&(e.x=-2,i.moveX(5),i.onUpdate()),a.read("LEFT").active&&(e.x=2,i.moveX(-5),i.onUpdate()),a.read("UP").active&&(e.y=5,i.moveY(-5),i.onUpdate()),a.read("DOWN").active&&(e.y=-2,i.moveY(5),i.onUpdate()),a.checkWithDelay({isActive:!0,key:"A",delay:s.cooldown-75*a.read("A").state})&&(m({x:i.x,y:i.y,spread:0,damageMod:1}),s.number>1&&(m({x:i.x+15,y:i.y,spread:-1*s.spread,damageMod:.5}),m({x:i.x-15,y:i.y,spread:1*s.spread,damageMod:.5})),s.number>2&&(m({x:i.x+30,y:i.y,spread:-2*s.spread,damageMod:.5}),m({x:i.x-30,y:i.y,spread:-2*s.spread,damageMod:.5}))),a.checkWithDelay({isActive:!0,key:"B",delay:d.cooldown})&&(r.onPress(4e3),function(t){var e=n.game(),i=(o.getGroup("bombCount").length,o.add({x:t.x,y:t.y,name:"bomb_"+e.rnd.integer(),group:"bombs",reference:"bomb"}));i.anchor.setTo(.5,.5),i.scale.setTo(2,2),e.physics.enable(i,Phaser.Physics.ARCADE),i.body.velocity.y=t.velocity,u.add(2,i),i.destroyIt=function(){v(this.x,this.y,1.25);for(var i=0;i<t.bomblets;i++)f({x:this.x,y:this.y,ix:e.rnd.integerInRange(-400,400),iy:-e.rnd.integerInRange(-50,400),damage:t.damage/4});o.destroy(this.name)},i.onUpdate=function(){var e=this;this.angle+=5,this.y<200&&this.destroyIt(),x().forEach(function(i){i.game.physics.arcade.overlap(e,i,function(e,i){e.destroyIt(),i.damageIt(t.damage)},null,e)})}}({x:i.x,y:i.y,velocity:-400,damage:d.damage,bomblets:d.bomblets})));n.checkState("ENDLEVEL")&&i.onUpdate()}}),resolution:{width:i.width,height:i.height}}),a=new PHASER_CONTROLS,r=new PHASER_MOUSE({showDebugger:!1}),o=new PHASER_SPRITE_MANAGER,s=new PHASER_BITMAPDATA_MANAGER,h=new PHASER_TEXT_MANAGER,d=new PHASER_BUTTON_MANAGER,u=new PHASER_GROUP_MANAGER,l=new PHASER_BITMAPDATA_MANAGER,c=i.store;function g(t,e){var i=n.get("gameData");i[t]=e,c.commit("setGamedata",i)}function p(t,e){var i=n.game(),a=t.split(" ");a.forEach(function(t,e){var n=h.add({name:"splashText_"+i.rnd.integer(),group:"splash",font:"gem",size:18,default:t,visible:!1});n.startSplash=function(){var t=this;this.visible=!0,this.scale.setTo(10,10),h.alignToCenter(this.name),i.add.tween(this.scale).to({x:.5,y:.5},350,Phaser.Easing.Linear.In,!0,0),i.add.tween(this).to({x:this.game.world.centerX,y:this.game.world.centerY,alpha:.75},350,Phaser.Easing.Linear.In,!0,0),setTimeout(function(){h.destroy(t.name)},350)},i.time.events.add(Phaser.Timer.SECOND/2.5*e+100,n.startSplash,n).autoDestroy=!0}),i.time.events.add(Phaser.Timer.SECOND/2.5*a.length,e,this).autoDestroy=!0}function y(t){var e=n.game(),i=o.add({x:t.x,y:t.y,name:"trash_"+e.rnd.integer(),group:"trashes",reference:"invader",visible:!0});i.anchor.setTo(.5,.5),i.scale.setTo(1,1),e.physics.enable(i,Phaser.Physics.ARCADE),i.body.velocity.y=t.iy,i.body.velocity.x=t.ix,i.angleMomentum=e.rnd.integerInRange(-5,5),i.body.bounce.setTo(1,1),i.atTarget=!1,i.maxHealth=50,i.health=i.maxHealth,i.fallThrehold=e.rnd.integerInRange(0,75),u.add(3,i),i.damageIt=function(t){var e=n.get("emitter");e.x=this.x,e.y=this.y,e.start(!0,1500,null,5),this.health-=t,this.tint=16711680,this.game.add.tween(this).to({tint:16777215},100,Phaser.Easing.Linear.Out,!0,0,0,!1),this.health<=0&&this.destroyIt()},i.removeIt=function(){o.destroy(this.name)},i.fallToPlanet=function(){var t=this;this.tint=0,this.atTarget=!0,this.body=null,this.game.add.tween(this).to({y:this.y+60},2*Phaser.Timer.SECOND,Phaser.Easing.Linear.In,!0,0).autoDestroy=!0,setTimeout(function(){t.game.add.tween(t.scale).to({x:0,y:0},1*Phaser.Timer.SECOND,Phaser.Easing.Linear.In,!0,e.rnd.integerInRange(0,500)).onComplete.add(function(){t.removeIt(),o.get("healthbar").takeDamage(1),v(t.x,t.y,.25)}).autoDestroy=!0},300)},i.destroyIt=function(){var t=this,i=n.get("score");n.forceLet("score",i+=25),h.get("scoreText").updateScore();var a={angle:e.rnd.integerInRange(-720,720),x:this.x-e.rnd.integerInRange(-25,25),y:this.y-e.rnd.integerInRange(5,25),alpha:.5};this.game.add.tween(this).to(a,e.rnd.integerInRange(50,200),Phaser.Easing.Linear.Out,!0,0,0,!1),this.body=null,e.time.events.add(Phaser.Timer.SECOND/3,function(){v(t.x,t.y,1),o.destroy(t.name)},this).autoDestroy=!0},i.checkLocation=function(){this.angle+=i.angleMomentum,this.angleMomentum>0&&(this.angleMomentum-=.002),this.angleMomentum<0&&(this.angleMomentum+=.002),this.y>this.height&&null!==this.body&&(this.body.collideWorldBounds=!0),this.y>this.game.canvas.height-(50+this.fallThrehold)&&(null===this.body||this.atTarget||(this.body.collideWorldBounds=!1,this.fallToPlanet())),this.y>this.game.canvas.height+this.height&&this.removeIt()},i.onUpdate=function(){null!==this.body&&(this.body.velocity.y+1<50&&(this.body.velocity.y+=1),this.body.velocity.x>0&&(this.body.velocity.x-=.2),this.body.velocity.x<0&&(this.body.velocity.x+=.2)),this.checkLocation()}}function m(t){var e=n.game(),i=(o.getGroup("bullets").length,n.get("primaryWeapon")),a=o.add({x:t.x,y:t.y,name:"bullet_"+e.rnd.integer(),group:"bullets",reference:"bullet"});e.physics.enable(a,Phaser.Physics.ARCADE),a.body.velocity.y=-100,u.add(2,a),a.accelerate=function(){this.body.velocity.y-=i.velocity,this.body.velocity.x+=t.spread},a.destroyIt=function(){i.secondaryExplosion&&b(this.x,this.y,.25,i.damage*t.damageMod),o.destroy(this.name)},a.onUpdate=function(){var e=this;this.accelerate(),this.y<0&&this.destroyIt(),x().forEach(function(n){n.game.physics.arcade.overlap(e,n,function(e,n){i.pierce||e.destroyIt(),n.damageIt(i.damage*t.damageMod)},null,e)})}}function f(t){var e=n.game(),i=(o.getGroup("bombCount").length,o.add({x:t.x,y:t.y,name:"bomblet_"+e.rnd.integer(),group:"bomblets",reference:"bomb"}));i.anchor.setTo(.5,.5),i.scale.setTo(.5,.5),e.physics.enable(i,Phaser.Physics.ARCADE),i.body.velocity.y=t.iy,i.body.velocity.x=t.ix,i.fuse=e.time.now,i.detonate=e.time.now+e.rnd.integerInRange(1250,1800),u.add(2,i),i.destroyIt=function(){b(this.x,this.y,1,t.damage),o.destroy(this.name)},i.onUpdate=function(){var e=this;this.angle+=10,this.game.time.now>i.detonate&&this.destroyIt(),x().forEach(function(n){n.game.physics.arcade.overlap(e,n,function(e,n){i.destroyIt(),n.damageIt(t.damage)},null,e)})}}function v(t,e,i){var a=n.game(),r=o.add({name:"explosion_"+a.rnd.integer(),group:"explosions",x:t,y:e,reference:"kaboom"});r.scale.setTo(i,i),r.anchor.setTo(.5,.5),r.animations.add("kaboom"),r.play("kaboom",30,!1,!0),u.add(6,r),a.time.events.add(Phaser.Timer.SECOND/2,function(){o.destroy(r.name)}).autoDestroy=!0}function b(t,e,i,a){var r=n.game(),s=o.add({name:"impactExplosion_"+r.rnd.integer(),group:"impactExplosions",x:t,y:e,reference:"kaboom"});s.scale.setTo(i,i),s.anchor.setTo(.5,.5),s.animations.add("kaboom"),s.play("kaboom",30,!1,!0),r.physics.enable(s,Phaser.Physics.ARCADE),u.add(6,s),r.time.events.add(Phaser.Timer.SECOND/2,function(){o.destroy(s.name)}).autoDestroy=!0,s.onUpdate=function(){var t=this;x().forEach(function(e){e.game.physics.arcade.overlap(t,e,function(t,e){e.damageIt(25)},null,t)})}}function x(){return o.getGroup("aliens").concat(o.getGroup("trashes"))}n.let("gameData",c.getters._gameData()),e.game=this,this.game=n.game()},t.prototype.destroy=function(){this.game.destroy()},t}(),__phaser=new PhaserGameObject,PHASER_AUDIO=function(){return function(){}}(),PHASER_BITMAPDATA_MANAGER=function(){function t(){this.game=null,this.bmd={array:[],object:{}}}return t.prototype.assign=function(t){this.game=t},t.prototype.addGradient=function(t){if(0===this.bmd.array.filter(function(e){return e.name===t.name}).length){var e=this.game.make.bitmapData(t.width,t.height),i=e.context.createLinearGradient(0,0,0,t.height);i.addColorStop(0,t.start),i.addColorStop(1,t.end),e.context.fillStyle=i,e.context.fillRect(0,0,t.width,t.height);var n=this.game.cache.addBitmapData(t.name,e),a=this.game.make.bitmapData();return a.load(this.game.cache.getBitmapData(t.name)),t.render&&a.addToWorld(t.x,t.y),a.name=t.name,a.group=t.group,a.cacheBitmapData=n,this.bmd.array.push(a),this.bmd.object[t.name]=a,a}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.addImage=function(t){if(0===this.bmd.array.filter(function(e){return e.name===t.name}).length){var e=this.game.make.bitmapData();return e.load(t.reference),e.addToWorld(t.x,t.y),t.render||e.cls(),e.name=t.name,e.group=t.group,e.cacheBitmapData=t.reference,this.bmd.array.push(e),this.bmd.object[t.name]=e,e}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.addEmpty=function(t){if(0===this.bmd.array.filter(function(e){return e.name===t.name}).length){var e=this.game.make.bitmapData(t.width,t.height);return e.addToWorld(t.x,t.y),t.render||e.cls(),e.name=t.name,e.group=t.group,this.bmd.array.push(e),this.bmd.object[t.name]=e,e}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.destroy=function(t){for(var e=[],i=0,n=this.bmd.array.filter(function(e){return e.name===t});i<n.length;i++){var a=n[i];e.push(a.name),a.destroy()}return delete this.bmd.object[t],this.bmd.array=this.bmd.array.filter(function(e){return e.name!==t}),e},t.prototype.destroyGroup=function(t){for(var e=[],i=0,n=this.bmd.array.filter(function(t){return t.group===name});i<n.length;i++){var a=n[i];e.push(a.name),a.destroy()}return delete this.bmd.object[name],this.bmd.array=this.bmd.array.filter(function(t){return t.group!==name}),e},t.prototype.get=function(t){return this.bmd.object[t]},t.prototype.getGroup=function(t){return this.bmd.array.filter(function(e){return e.group===t})},t.prototype.getAll=function(t){return void 0===t&&(t="BOTH"),"ARRAY"===t?this.bmd.array:"OBJECT"==t?this.bmd.object:{object:this.bmd.object,array:this.bmd.array}},t}(),PHASER_BUTTON_MANAGER=function(){function t(){this.game=null,this.resources={array:[],object:{}}}return t.prototype.assign=function(t){this.game=t.game},t.prototype.add=function(t){if(0===this.resources.array.filter(function(e){return e.name===t.name}).length){var e=this.game.add.button(t.x,t.y,t.reference,t.onclick);return e.name=t.name,e.group=t.group||null,this.resources.array.push(e),this.resources.object[t.name]=e,e}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.destroy=function(t){for(var e=[],i=0,n=this.resources.array.filter(function(e){return e.key===t});i<n.length;i++){var a=n[i];e.push(a.key),a.destroy()}return delete this.resources.object[t],this.resources.array=this.resources.array.filter(function(e){return e.key!==t}),e},t.prototype.destroyGroup=function(t){for(var e=[],i=0,n=this.resources.array.filter(function(e){return e.group===t});i<n.length;i++){var a=n[i];e.push(a.key),a.destroy()}return delete this.resources.object[t],this.resources.array=this.resources.array.filter(function(e){return e.group!==t}),e},t.prototype.get=function(t){return this.resources.object[t]},t.prototype.getGroup=function(t){return this.resources.array.filter(function(e){return e.group===t})},t.prototype.getAll=function(t){return void 0===t&&(t="BOTH"),"ARRAY"===t?this.resources.array:"OBJECT"==t?this.resources.object:{object:this.resources.object,array:this.resources.array}},t}(),PHASER_CONTROLS=function(){function t(){this.IO=null,this.game=null,this.buttonSensitivity={QUICK:1,SHORT:50,LONG:150,SUPERLONG:300},this.properties={isReady:!1,allowDebugger:!0,buttonDelay:50,timingRefreshRate:1},this.directionalButtons=["UP","DOWN","LEFT","RIGHT"],this.actionButtons=["A","B","X","Y"],this.triggerButtons=["L1","L2","R1","R2","L3","R3"],this.systemButtons=["START","BACK"],this.buttonArray=this.directionalButtons.concat(this.actionButtons,this.triggerButtons,this.systemButtons),this.buttonMap={UP:{name:"UP",code:"ArrowUp"},DOWN:{name:"DOWN",code:"ArrowDown"},LEFT:{name:"LEFT",code:"ArrowLeft"},RIGHT:{name:"RIGHT",code:"ArrowRight"},A:{name:"A",code:"KeyA"},B:{name:"S",code:"KeyS"},X:{name:"D",code:"KeyD"},Y:{name:"F",code:"KeyF"},L1:{name:"Q",code:"KeyQ"},L2:{name:"W",code:"KeyW"},R1:{name:"E",code:"KeyE"},R2:{name:"R",code:"KeyR"},L3:{name:"O",code:"KeyO"},R3:{name:"P",code:"KeyP"},START:{name:"ENTER",code:"Enter"},BACK:{name:"BACKSPACE",code:"Backspace"}},this.buttonMapId={UP:1,DOWN:2,LEFT:3,RIGHT:4,A:5,B:6,X:7,Y:8,L1:9,L2:10,R1:11,R2:12,L3:13,R3:14,START:15,BACK:16},this.disabledButtons={ALL:!1,DIRECTIONAL:!1,TRIGGER:!1,ACTION:!1,SYSTEM:!1},this.debugger={enabled:!1,text:{}},this.inputDelay={delay:Array.apply(null,Array(20)).map(function(){return 0})}}return t.prototype.assign=function(t){var e=this;this.game=t;var i={font:"12px Courier New",fill:"#fff",align:"left"};this.buttonArray.forEach(function(n,a){e.debugger.text[n]=null,e.debugger.text[n]=t.add.text(10,10+15*a,"",i),e.disabledButtons[n]=!1});for(var n={buttons:{},sensitivityPress:{},sensitivityBuffer:{},state:{}},a=function(i){n.buttons[i]=t.input.keyboard.addKey(Phaser.Keyboard[r.buttonMap[i].name]),n.sensitivityPress[i]=null,n.sensitivityBuffer[i]=0,n.state[i]=function(){return e.getBtnPressType(e.IO.sensitivityBuffer[i])}},r=this,o=0,s=this.buttonArray;o<s.length;o++){a(s[o])}for(var h=function(t){n.buttons[t].onDown.add(function(i){var a,r;clearInterval(n.sensitivityPress[t]);var o=["DIRECTIONAL","ACTION","TRIGGER","SYSTEM"];Object.keys(e.buttonMap).forEach(function(t,n){if(e.buttonMap[t].code===i.event.code)for(var s=0,h=o;s<h.length;s++){var d=h[s];e[d.toLowerCase()+"Buttons"].indexOf(t)+1&&(a=d,r=t)}});var s=!1;e.disabledButtons.ALL&&(s=!0);for(var h=0,d=o;h<d.length;h++){var u=d[h];e.disabledButtons[u]&&a===u&&(s=!0)}Object.keys(e.buttonMap).forEach(function(t,i){e.disabledButtons[t]&&r===t&&(s=!0)}),s||(n.sensitivityPress[t]=setInterval(function(){n.sensitivityBuffer[t]+=1},e.properties.timingRefreshRate))},d)},d=this,u=0,l=this.buttonArray;u<l.length;u++){h(l[u])}return t.input.keyboard.onUpCallback=function(t){for(var i=0,a=e.buttonArray;i<a.length;i++){var r=a[i];t.code===e.buttonMap[r].code&&(clearInterval(n.sensitivityPress[r]),n.sensitivityBuffer[r]=0)}"Backquote"===t.code&&e.properties.allowDebugger&&(e.setDebugger(!e.debugger.enabled),e.updateDebugger())},this.properties.isReady=!0,this.IO=n,n},t.prototype.mapKeys=function(t){var e=this;this.properties.isReady=!1,this.destroyAll(),setTimeout(function(){e.buttonMap=t,e.properties.isReady=!0,e.assign(e.game)},1)},t.prototype.isReady=function(){return this.properties.isReady},t.prototype.checkWithDelay=function(t){return this.read(t.key).active===t.isActive&&(this.game.time.now>this.inputDelay.delay[this.getKeyId(t.key)]&&(this.inputDelay.delay[this.getKeyId(t.key)]=t.delay+this.game.time.now,!0))},t.prototype.isDebuggerEnabled=function(){return this.debugger.enabled},t.prototype.setDebugger=function(t){void 0===t&&(t=!0),this.debugger.enabled=t},t.prototype.updateDebugger=function(){if(this.properties.isReady)for(var t=0,e=this.buttonArray;t<e.length;t++){var i=e[t];this.debugger.text[i].setText(this.debugger.enabled?this.debuggerString(i):"").bringToTop()}},t.prototype.disableAllInput=function(){this.disabledButtons.ALL=!0},t.prototype.enableAllInput=function(){this.disabledButtons.ALL=!1},t.prototype.disableAllDirectionalButtons=function(){this.disabledButtons.DIRECTIONAL=!0},t.prototype.enableAllDirectionalButtons=function(){this.disabledButtons.DIRECTIONAL=!1},t.prototype.disableAllTriggerButtons=function(){this.disabledButtons.TRIGGER=!0},t.prototype.enableAllTriggerButtons=function(){this.disabledButtons.TRIGGER=!1},t.prototype.disableAllActionButtons=function(){this.disabledButtons.ACTION=!0},t.prototype.enableAllActionButtons=function(){this.disabledButtons.ACTION=!1},t.prototype.disableAllSystemButtons=function(){this.disabledButtons.SYSTEM=!0},t.prototype.enableAllSystemButtons=function(){this.disabledButtons.SYSTEM=!1},t.prototype.setDisableKeyProperty=function(t,e){void 0===e&&(e=!0),this.properties.isReady&&(this.disabledButtons[t.toUpperCase()]=e)},t.prototype.getKeyDisabledValue=function(t){return this.properties.isReady?this.disabledButtons[t.toUpperCase()]:null},t.prototype.clearAllControlIntervals=function(){if(this.properties.isReady)for(var t=0,e=this.buttonArray;t<e.length;t++){var i=e[t];clearInterval(this.IO.sensitivityPress[i])}},t.prototype.getKeyId=function(t){return this.buttonMapId[t.toUpperCase()]},t.prototype.read=function(t){if(this.properties.isReady){return{}[t]={id:this.buttonMapId[t.toUpperCase()],active:this.IO.state[t.toUpperCase()]().val>0,duration:this.IO.state[t.toUpperCase()]().val,state:this.IO.state[t.toUpperCase()]().state,type:this.IO.state[t.toUpperCase()]().type,disabled:this.disabledButtons[t.toUpperCase()]}}return{}},t.prototype.readMulti=function(t,e){if(void 0===e&&(e="OBJECT"),this.properties.isReady){if("OBJECT"===e){for(var i={},n=0,a=t;n<a.length;n++){i[s=a[n]]={id:this.buttonMapId[s.toUpperCase()],active:this.IO.state[s.toUpperCase()]().val>0,duration:this.IO.state[s.toUpperCase()]().val,state:this.IO.state[s.toUpperCase()]().state,type:this.IO.state[s.toUpperCase()]().type,disabled:this.disabledButtons[s.toUpperCase()]}}return i}if("ARRAY"===e){i=[];for(var r=0,o=t;r<o.length;r++){var s=o[r];i.push({id:this.buttonMapId[s.toUpperCase()],key:s,active:this.IO.state[s.toUpperCase()]().val>0,duration:this.IO.state[s.toUpperCase()]().val,state:this.IO.state[s.toUpperCase()]().state,type:this.IO.state[s.toUpperCase()]().type,disabled:this.disabledButtons[s.toUpperCase()]})}return i}}},t.prototype.debuggerString=function(t){return t.toUpperCase()+" ("+this.buttonMap[t.toUpperCase()].name+"/"+this.buttonMap[t.toUpperCase()].code+") | id: "+this.buttonMapId[t.toUpperCase()]+" duration: "+this.IO.state[t.toUpperCase()]().val+" | state: "+this.IO.state[t.toUpperCase()]().state+" | type: "+this.IO.state[t.toUpperCase()]().type+" | disabled: "+this.disabledButtons[t.toUpperCase()]},t.prototype.getBtnPressType=function(t){var e=this,i="NONE",n=0,a=0;return Object.keys(this.buttonSensitivity).forEach(function(r){a++,t>e.buttonSensitivity[r]&&(i=r,n=a)}),{val:t,type:i,state:n}},t.prototype.destroyAll=function(){var t=this;this.clearAllControlIntervals(),Object.keys(this.debugger.text).forEach(function(e){t.debugger.text[e].destroy()})},t}(),PHASER_GROUP_MANAGER=function(){function t(){this.game=null,this.group={array:[],object:{}}}return t.prototype.assign=function(t,e){void 0===e&&(e=10),this.game=t;for(var i=0;i<=e;i++){var n=t.add.group();this.group.object[""+i]=n,this.group.array.push(n)}},t.prototype.layer=function(t){return this.group.object[t]},t.prototype.add=function(t,e){this.group.object[t].add(e)},t.prototype.addMany=function(t,e){var i=this;e.forEach(function(e){i.group.object[t].add(e)})},t}(),PHASER_MASTER=function(){function t(t){this._game=t.game,this.resolution=t.resolution,this.states={BOOT:"BOOT",PRELOAD:"PRELOAD",READY:"READY"},this.currentState=this.states[0],this.variables={}}return t.prototype.let=function(t,e){if(void 0===e&&(e=null),void 0===this.variables[t])return this.variables[t]=e;console.log("Cannot LET duplicate key in PHASER_MASTER: "+t)},t.prototype.forceLet=function(t,e){return void 0===e&&(e=null),this.variables[t]=e},t.prototype.delete=function(t){delete this.variables[t]},t.prototype.get=function(t){return void 0!==this.variables[t]?this.variables[t]:(console.log("Cannot GET a variable that does not exist in PHASER_MASTER."),null)},t.prototype.changeState=function(t){void 0===t&&(t=null);var e=t.toUpperCase(),i=!1;return void 0===this.states[e]&&(this.states[e]=e,i=!0),this.currentState=e,{created:i,state:this.currentState}},t.prototype.getCurrentState=function(){return this.currentState},t.prototype.getStates=function(){return this.states},t.prototype.getResolution=function(){return this.resolution},t.prototype.checkState=function(t){return this.currentState===t.toUpperCase()},t.prototype.game=function(){return this._game},t}(),PHASER_MOUSE=function(){function t(t){this.game=null,this.clickSensitvity={QUICK:1,SHORT:50,LONG:150,SUPERLONG:300},this.mouseMapping=[0,1,2],this.mouseMap={LEFT:0,MIDDLE:1,RIGHT:2},this.metrics={sensitivityPress:{},sensitivityBuffer:{},location:{},state:{}},this.properties={allowDebugger:!0,timingRefreshRate:1},this.inputDelay={delay:Array.apply(null,Array(2)).map(function(){return 0})},this.debugger={enabled:void 0!==t.showDebugger&&t.showDebugger,text:{},pointer:null}}return t.prototype.assign=function(t){var e=this;this.game=t;for(var i=function(t){n.metrics.sensitivityPress[t]=null,n.metrics.sensitivityBuffer[t]=0,n.metrics.location[t]={x:null,y:null},n.metrics.state[t]=function(){return e.getBtnPressType(e.metrics.sensitivityBuffer[t])}},n=this,a=0,r=this.mouseMapping;a<r.length;a++){i(r[a])}this.game.input.onDown.add(function(t){var i=e.checkMouseClick();clearInterval(e.metrics.sensitivityPress[i]),e.metrics.sensitivityPress[i]=setInterval(function(){e.metrics.sensitivityBuffer[i]+=1,e.metrics.location[i]={x:t.x,y:t.y}},e.properties.timingRefreshRate)}),this.game.input.onUp.add(function(t){var i=e.checkMouseClick();e.clearAllControlIntervals(),e.metrics.sensitivityBuffer[i]=0});var o={font:"12px Courier New",fill:"#fff",align:"left"};this.mouseMapping.forEach(function(t,i){e.debugger.text[t]=null,e.debugger.text[t]=e.game.add.text(5,e.game.height-35-15*i,"",o)}),this.debugger.pointer=this.game.add.text(5,this.game.height-20,"",o),t.canvas.oncontextmenu=function(t){t.preventDefault()}},t.prototype.checkMouseClick=function(){var t=0;return this.game.input.activePointer.leftButton.isDown&&(t=0),this.game.input.activePointer.middleButton.isDown&&(t=1),this.game.input.activePointer.rightButton.isDown&&(t=2),t},t.prototype.debuggerString=function(t){return"Button_"+t+" | {x: "+this.metrics.location[t].x+", y: "+this.metrics.location[t].y+"} | active: "+(this.metrics.sensitivityBuffer[t]>0)+" | state: "+this.metrics.state[t]().state+" | duration: "+this.metrics.state[t]().val+" | type: "+this.metrics.state[t]().type},t.prototype.setDebugger=function(t){void 0===t&&(t=!0),this.debugger.enabled=t},t.prototype.updateDebugger=function(){for(var t=0,e=this.mouseMapping;t<e.length;t++){var i=e[t];this.debugger.text[i].setText(this.debugger.enabled?this.debuggerString(i):"").bringToTop()}this.debugger.pointer.setText(this.debugger.enabled?"Pointer: {x: "+this.game.input.mousePointer.x+", y: "+this.game.input.mousePointer.y+"}":"").bringToTop()},t.prototype.clearAllControlIntervals=function(){for(var t=0,e=this.mouseMapping;t<e.length;t++){var i=e[t];this.metrics.sensitivityBuffer[i]=0,clearInterval(this.metrics.sensitivityPress[i])}},t.prototype.checkWithDelay=function(t){if(this.read(t.key).active===t.isActive){var e=this.mouseMap[t.key.toUpperCase()];return this.game.time.now>this.inputDelay.delay[e]&&(this.inputDelay.delay[e]=t.delay+this.game.time.now,!0)}return!1},t.prototype.read=function(t){void 0===t&&(t="LEFT");var e=this.mouseMap[t.toUpperCase()];return{id:e,x:this.metrics.location[e].x,y:this.metrics.location[e].y,active:this.metrics.sensitivityBuffer[e]>0,duration:this.metrics.sensitivityBuffer[e],state:this.metrics.state[e]().state,type:this.metrics.state[e]().type}},t.prototype.getBtnPressType=function(t){var e=this,i="NONE",n=0,a=0;return Object.keys(this.clickSensitvity).forEach(function(r){a++,t>e.clickSensitvity[r]&&(i=r,n=a)}),{val:t,type:i,state:n}},t}(),PHASER_PRELOADER=function(){function t(t){this.game=t.game,this.init(t.delayInSeconds,t.done)}return t.prototype.init=function(t,e){var i,n,a=this;this.game.load.onLoadStart.add(function(){(i=a.game.add.text(a.game.world.centerX,a.game.world.centerY/2,"",{font:"18px Impact",fill:"#fff",align:"center"})).anchor.set(.5),(n=a.game.add.text(a.game.world.centerX,a.game.world.centerY,"",{font:"32px Impact",fill:"#fff",align:"center"})).anchor.set(.5)},this),this.game.load.onFileComplete.add(function(t,e,a,r,o){i.setText("Please wait..."),n.setText(t+"%")},this),this.game.load.onLoadComplete.add(function(){i.setText("File loaded!"),n.setText(""),a.game.time.events.add(Phaser.Timer.SECOND*t,function(){i.destroy(),n.destroy(),e()},a).autoDestroy=!0},this)},t}(),PHASER_SPRITE_MANAGER=function(){function t(){this.game=null,this.sprites={array:[],object:{}},this.spriteCount=0}return t.prototype.assign=function(t){this.game=t},t.prototype.add=function(t){if(0===this.sprites.array.filter(function(e){return e.name===t.name}).length){t.x=void 0!==t.x?t.x:0,t.y=void 0!==t.y?t.y:0,t.group=void 0!==t.group?t.group:null,t.visible=void 0===t.visible||t.visible;var e=this.game.add.sprite(t.x,t.y,t.reference);return e.name=t.name,e.group=t.group,e.defaultPosition={x:t.x,y:t.y},e.visible=t.visible,e.setDefaultPositions=function(t,e){this.defaultPosition.x=t,this.defaultPosition.y=e},e.getDefaultPositions=function(){return this.defaultPosition},this.sprites.array.push(e),this.sprites.object[t.name]=e,e}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.destroy=function(t){if(void 0!==this.sprites.object[t]){for(var e=[],i=0,n=this.sprites.array.filter(function(e){return e.name===t});i<n.length;i++){var a=n[i];e.push(a.name),a.destroy()}return delete this.sprites.object[t],this.sprites.array=this.sprites.array.filter(function(e){return e.name!==t}),e}return console.log("Cannot delete "+t+" because it does not exist."),null},t.prototype.destroyGroup=function(t){for(var e=[],i=0,n=this.sprites.array.filter(function(e){return e.group===t});i<n.length;i++){var a=n[i];e.push(a.name),a.destroy()}return delete this.sprites.object[t],this.sprites.array=this.sprites.array.filter(function(e){return e.group!==t}),e},t.prototype.get=function(t){return this.sprites.object[t]},t.prototype.getGroup=function(t){return this.sprites.array.filter(function(e){return e.group===t})},t.prototype.getAll=function(t){return void 0===t&&(t="BOTH"),"ARRAY"===t?this.sprites.array:"OBJECT"==t?this.sprites.object:{object:this.sprites.object,array:this.sprites.array}},t.prototype.count=function(){return this.spriteCount++,{total:this.sprites.array.length,unique:this.spriteCount}},t.prototype.centerWorld=function(t){if(void 0===this.sprites.object[t])return console.log("Error centering sprite:  key does not exists."),null;var e=this.sprites.object[t];return e.alignIn(this.game.world.bounds,Phaser.CENTER),e},t.prototype.centerOnPoint=function(t,e,i){if(void 0===this.sprites.object[t])return console.log("Error centering sprite:  key does not exists."),null;var n=this.sprites.object[t];return n.x=e-n.width/2,n.y=i-n.height/2,n},t}(),PHASER_TEXT_MANAGER=function(){function t(){this.game=null,this.texts={array:[],object:{}}}return t.prototype.assign=function(t){this.game=t},t.prototype.add=function(t){var e=this.texts.array.filter(function(e){return e.name===t.name});if(t.x=void 0!==t.x?t.x:0,t.y=void 0!==t.y?t.y:0,t.group=void 0!==t.group?t.group:null,t.size=void 0!==t.size?t.size:12,t.default=void 0!==t.default?t.default:"",t.visible=void 0===t.visible||t.visible,0===e.length){var i=this.game.add.bitmapText(t.x,t.y,t.font,t.default,t.size);return i.name=t.name,i.group=t.group,i.visible=t.visible,this.texts.array.push(i),this.texts.object[t.name]=i,i}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.destroy=function(t){for(var e=[],i=0,n=this.texts.array.filter(function(e){return e.name===t});i<n.length;i++){var a=n[i];e.push(a.name),a.destroy()}return delete this.texts.object[t],this.texts.array=this.texts.array.filter(function(e){return e.name!==t}),e},t.prototype.destroyGroup=function(t){for(var e=[],i=0,n=this.texts.array.filter(function(e){return e.group===t});i<n.length;i++){var a=n[i];e.push(a.key),a.destroy()}return delete this.texts.object[t],this.texts.array=this.texts.array.filter(function(e){return e.group!==t}),e},t.prototype.get=function(t){return this.texts.object[t]},t.prototype.getGroup=function(t){return this.texts.array.filter(function(e){return e.group===t})},t.prototype.getAll=function(t){return void 0===t&&(t="BOTH"),"ARRAY"===t?this.texts.array:"OBJECT"==t?this.texts.object:{object:this.texts.object,array:this.texts.array}},t.prototype.alignToBottomLeftCorner=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],n=this.game;return i.x=e,i.y=n.canvas.height-i.height-e,i},t.prototype.alignToBottomCenter=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],n=this.game;return i.x=n.canvas.width/2-i.width/2,i.y=n.canvas.height-i.height-e,i},t.prototype.alignToBottomRightCorner=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],n=this.game;return i.x=n.canvas.width-i.width-e,i.y=n.canvas.height-i.height-e,i},t.prototype.alignToCenterRight=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],n=this.game;return i.x=n.canvas.width-i.width-e,i.y=n.canvas.height/2-i.height/2,i},t.prototype.alignToTopRightCorner=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],n=this.game;return i.x=n.canvas.width-i.width-e,i.y=e,i},t.prototype.alignToTopCenter=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],n=this.game;return i.x=n.canvas.width/2-i.width/2-e,i.y=e,i},t.prototype.alignToTopLeftCorner=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t];this.game;return i.x=e,i.y=e,i},t.prototype.alignToCenterLeft=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],n=this.game;return i.x=e,i.y=n.canvas.height/2-i.height/2,i},t.prototype.alignToCenter=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],n=this.game;return i.x=n.canvas.width/2-i.width/2,i.y=n.canvas.height/2-i.height/2,i},t.prototype.center=function(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var n=this.texts.object[t],a=this.game;return n.x=a.canvas.width/2-n.width/2+e,n.y=a.canvas.height/2-n.height/2+i,n},t}(),BULLET_CLASS=function(){function t(t,e,i,n,a,r,o){this.game=e.game();n.getGroup("bullets").length,e.get("primaryWeapon");this.bullet=n.add({x:o.x,y:o.y,name:"bullet_"+this.game.rnd.integer(),group:"bullets",reference:"bullet"}),this.game.physics.enable(this.bullet,t.Physics.ARCADE),this.bullet.body.velocity.y=-100,i.add(2,this.bullet),this.COLLIDABLES=r,this.bullet.onUpdate=this.onUpdate()}return t.prototype.accelerate=function(){},t.prototype.destroyIt=function(){},t.prototype.onUpdate=function(){var t=this;this.accelerate(),this.y<0&&this.destroyIt(),this.COLLIDABLES.forEach(function(e){e.game.physics.arcade.overlap(t,e,function(e,i){t.WEAPON_DATA.pierce||e.destroyIt(),i.damageIt(t.WEAPON_DATA.damage*t.options.damageMod)},null,t)})},t}();