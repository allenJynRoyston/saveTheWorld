var PhaserGameObject=function(){function e(){this.game=null,this.global={pause:!1}}return e.prototype.init=function(e,t,a){var i=new Phaser.Game(a.width,a.height,Phaser.WEBGL,e,{preload:function(){var e=n.game();e.load.enableParallel=!0,e.stage.backgroundColor="#2f2f2f";var t="src/phaser/saveTheWorld/resources";e.load.atlas("atlas",t+"/spritesheets/heroSelect/heroSelectAtlas.png",t+"/spritesheets/heroSelect/heroSelectAtlas.json",Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),e.load.atlas("atlas_main",t+"/spritesheets/main/main.png",t+"/spritesheets/main/main.json",Phaser.Loader.TEXTURE_atlas_main_JSON_HASH),e.load.atlas("atlas_weapons",t+"/spritesheets/weapons/weaponsAtlas.png",t+"/spritesheets/weapons/weaponsAtlas.json",Phaser.Loader.TEXTURE_atlas_main_JSON_HASH),e.load.atlas("atlas_ships",t+"/spritesheets/ships/ships.png",t+"/spritesheets/ships/ships.json",Phaser.Loader.TEXTURE_atlas_main_JSON_HASH),e.load.bitmapFont("gem",t+"/fonts/gem.png",t+"/fonts/gem.xml"),e.load.json("weaponData",t+"/json/weaponData.json"),e.load.json("pilotData",t+"/json/pilotData.json"),n.changeState("PRELOAD"),new PHASER_PRELOADER({game:e,delayInSeconds:0,done:function(){!function(){n.game();var e=s.getOnly(["pointer"]).pointer,t=n.getOnly(["currentSelection","pilotSelection"]),a=t.currentSelection,i=t.pilotSelection;e.updateLocation(a),w(i),_(),b("WIPEOUT",function(){g.overlayBGControls({transition:"FADEOUT",delay:0,speed:250},function(){n.changeState("MAINMENU")})})}()}})},create:function(){var e=n.game();o.assign(e),r.assign(e),s.assign(e),l.assign(e),h.assign(e),p.assign(e),c.assign(e,20),d.assign(e),y.assign(e,n,s,c,"atlas_weapons"),u.assign(e,n,s,h,c,o,y,"atlas_ships","atlas_weapons"),g.assign(e,s,d,c,"atlas_main");n.let("currentSelection",0);var t=n.let("pilotSelection",0),a=(n.let("loadoutSelection",0),n.let("primaryWeaponSelection",0),n.let("subWeaponSelection",0),n.let("perkSelection",0),n.let("weaponData",e.cache.getJSON("weaponData")),n.let("pilotData",e.cache.getJSON("pilotData"))),i=this.game.world.width-240,m=this.game.world.height/2,f=s.addFromAtlas({x:i,y:0,height:e.world.height,name:"verticleFrame",group:"ui_frame",filename:"ui_frame_v.png",atlas:"atlas"}),v=s.addFromAtlas({x:0,y:m,width:f.x,name:"dividerFrame1",group:"ui_frame",filename:"ui_frame_h.png",atlas:"atlas"}),b=d.addGradient({name:"overlayFadeout",start:"#ffffff",end:"#ffffff",width:1,height:1,render:!1}),x=s.add({x:0,y:0,name:"container_1",width:i,height:m,reference:b.cacheBitmapData,visible:!1}),A=s.add({x:0,y:325,name:"container_2",width:i,height:m,reference:b.cacheBitmapData,visible:!1}),_=s.add({x:i,y:0,name:"container_3",width:e.world.width-i,height:e.world.height,reference:b.cacheBitmapData,visible:!1}),T=s.addBasicMaskToSprite(x);g.buildOverlayBackground("#ffffff","#ffffff",19,!0),g.buildOverlayGrid(240,132,20,"logo_small.png");var S=s.addTilespriteFromAtlas({name:"bg_clouds",group:"ui_bg",x:x.x,y:x.y,width:x.width,height:x.height,atlas:"atlas",filename:"bg_clouds.png"});S.mask=T,S.onUpdate=function(){0===n.get("currentSelection")&&(this.tilePosition.x-=3)};var E=s.addTilespriteFromAtlas({name:"bg_cityscape",group:"ui_bg",x:A.x,y:A.y,width:A.width,height:A.height,atlas:"atlas",filename:"bg_cityscape.png"});E.onUpdate=function(){1===n.get("currentSelection")&&(this.tilePosition.x-=.25)};var I=s.addTilespriteFromAtlas({name:"bg_cityscape_1",group:"ui_bg",x:A.x,y:A.y+50,width:A.width,height:A.height,atlas:"atlas",filename:"bg_cityscape_1.png"});I.onUpdate=function(){1===n.get("currentSelection")&&(this.tilePosition.x-=.5)};var P=s.addTilespriteFromAtlas({name:"bg_cityscape_2",group:"ui_bg",x:A.x,y:A.y+115,width:A.width,height:A.height,atlas:"atlas",filename:"bg_cityscape_2.png"});P.onUpdate=function(){1===n.get("currentSelection")&&(this.tilePosition.x-=1)};var R=s.addTilespriteFromAtlas({name:"bg_cityscape_3",group:"ui_bg",x:A.x,y:A.y+200,width:A.width,height:A.height,atlas:"atlas",filename:"bg_cityscape_3.png"});R.onUpdate=function(){1===n.get("currentSelection")&&(this.tilePosition.x-=2)};var D=s.addTilespriteFromAtlas({name:"bg_space",group:"ui_bg",x:_.x,y:_.y,width:_.width,height:_.height,atlas:"atlas",filename:"bg_space.png"});D.onUpdate=function(){2===n.get("currentSelection")?this.tilePosition.y+=2:this.tilePosition.y+=.1};var L=s.addFromAtlas({name:"pointer",group:"ui",atlas:"atlas",filename:"ui_pointer.png"});L.anchor.setTo(.5,.5),L.hide=function(){this.visible=!1},L.show=function(){this.visible=!0},L.updateLocation=function(e){n.forceLet("currentSelection",e);var t=s.get("textbox"+e),a=t.x,i=t.y;this.x=a-90,this.y=i};var O=s.addFromAtlas({name:"downarrow",group:"ui",atlas:"atlas",filename:"ui_downarrow.png",visible:!1});O.anchor.setTo(.5,.5),O.hide=function(){this.visible=!1},O.show=function(){this.visible=!0},O.updateLocation=function(e,t){this.x=e,this.y=t};var C=s.addFromAtlas({name:"textbox0",group:"ui_textholders",atlas:"atlas",filename:"ui_textbox.png",alpha:1});C.anchor.setTo(.5,.5),s.centerOnPoint("textbox0",x.width/2+C.width/2,x.y+40);var k=h.add({name:"text0",group:"ui_text",x:C.x,y:C.y,font:"gem",size:12,default:"SELECT PILOT"});k.anchor.setTo(.5,.5);var M=s.addFromAtlas({name:"textbox1",group:"ui_textholders",atlas:"atlas",filename:"ui_textbox.png",alpha:1});M.anchor.setTo(.5,.5),s.centerOnPoint("textbox1",A.width/2+M.width/2,A.y+50);var B=h.add({name:"text1",group:"ui_text",x:M.x,y:M.y,font:"gem",size:12,default:"LOADOUT"});B.anchor.setTo(.5,.5);var W=s.addFromAtlas({name:"textbox2",group:"ui_textholders",atlas:"atlas",filename:"ui_textbox.png",alpha:1});W.anchor.setTo(.5,.5),s.centerOnPoint("textbox2",_.x+_.width/2+W.width/2,_.y+40);var U=h.add({name:"text2",group:"ui_text",x:W.x,y:W.y,font:"gem",size:12,default:"START"});U.anchor.setTo(.5,.5);var N=s.addFromAtlas({name:"pilotDescriptionBox",group:"ui_textholders",atlas:"atlas",filename:"ui_descriptionbox.png",alpha:1});N.anchor.setTo(.5,.5),s.centerOnPoint("pilotDescriptionBox",x.width/2+N.width/2,x.y+295);var G=h.add({name:"pilotDescriptionText",group:"ui_text",x:N.x-N.width/2+20,y:N.y-N.height/2,font:"gem",size:14,default:""});G.maxWidth=N.width-40,G.updateThisText=function(e){this.setText("\nNAME:               "+F[e].name+"\n\nFIRING RATE:        "+F[e].firerate+"\nSUBWEAPON RECHARGE: "+F[e].subweaponRecharge+"\nHEALTH:             "+F[e].health+"\nMOVEMENT:           "+F[e].movement+"\n              ")},c.addMany(17,[C,M,W,N]),c.addMany(18,[k,B,U,G]);for(var F=a.pilots,j=0;j<F.length;j++){var H=s.addFromAtlas({name:"profile"+j,group:"ui_profiles",y:x.y+110,atlas:"atlas",filename:""+F[j].image,alpha:0});H.anchor.setTo(.5,.5);var K=H.width/2*(F.length-1);H.x=x.x+j*H.width+x.width/2-K,H.alpha=1,c.add(18,H)}var Y=s.addFromAtlas({name:"profileSelector",group:"ui_profiles",atlas:"atlas",filename:"ui_pictureframe.png",alpha:0});Y.anchor.setTo(.5,.5),Y.updateLocation=function(e){n.forceLet("pilotSelection",e),s.getGroup("ui_profiles").map(function(e){e.alpha=.85});var t=s.get("profile"+e);t.alpha=1;var a=t.x,i=t.y;this.x=a,this.y=i,O.updateLocation(a,i-t.height/2-8)},Y.inc=function(){(t+=1)>F.length-1&&(t=0),w(t)},Y.dec=function(){(t-=1)<0&&(t=F.length-1),w(t)},c.add(18,Y),c.addMany(1,[D]),c.addMany(6,[S,E,I,P,R]),c.addMany(10,[f,v]),c.addMany(14,[L,O])},update:function(){n.game();var e=n.getAll(),a=e.currentSelection,i=(e.pilotSelection,e.loadoutSelection),r=e.primaryWeaponList,l=e.primaryWeaponSelection,p=(e.secondaryWeaponList,e.subWeaponSelection,s.getAll()),c=p.profileSelector,d=p.loadoutCatagorySelector,u=p.pointer,y=p.downarrow,f=p.loadoutDescription,x=o.getOnly(["DOWN","UP","LEFT","RIGHT","A","START"]),_=(x.DOWN,x.UP,x.LEFT,x.RIGHT,h.getAll("OBJECT").loadoutDescriptionText);s.getManyGroups(["ui_bg","playership","ship_wpn_preview"]).map(function(e){e.onUpdate()}),o.checkWithDelay({isActive:!0,key:"BACK",delay:250})&&2===a&&u.updateLocation(0);o.checkWithDelay({isActive:!0,key:"START",delay:250})&&(2!==a&&(n.forceLet("loadoutSelection",0),u.show(),y.hide(),f.hide(),_.hide(),d.hide(),n.changeState("MAINMENU"),u.updateLocation(2)),2===a&&(u.hide(),n.forceLet("currentSelection",null),g.overlayBGControls({transition:"FADEIN",delay:0,speed:250},function(){b("WIPEIN",function(){setTimeout(function(){!function(){n.game();var e=n.getAll(),a=e.primaryWeaponList,i=e.primaryWeaponSelection,o=(e.loadoutSelection,e.secondaryWeaponList),r=e.subWeaponSelection,s=e.perkList,l=e.perkSelection;v("pilot",e.pilotSelection),v("primaryWeapon",a[i].reference),v("secondaryWeapon",o[r].reference),v("perk",s[l].reference),h=n.get("gameData"),m.commit("setGamedata",h),t.startGame();var h}()},1e3)})})));n.checkState("MAINMENU")&&(o.checkWithDelay({isActive:!0,key:"UP",delay:250})&&2!==a&&u.updateLocation(0),o.checkWithDelay({isActive:!0,key:"DOWN",delay:250})&&(1===a&&(u.hide(),y.show(),f.show(),_.show(),d.show(),d.updateLocation(i),S(i),n.changeState("LOADOUTSELECT")),2!==a&&u.updateLocation(1)),o.checkWithDelay({isActive:!0,key:"RIGHT",delay:250})&&0===a&&c.inc(),o.checkWithDelay({isActive:!0,key:"LEFT",delay:250})&&0===a&&c.dec(),o.checkWithDelay({isActive:!0,key:"A",delay:250})&&2===a&&(u.hide(),n.forceLet("currentSelection",null),b("FADEIN")));n.checkState("PILOTSELECT")&&(o.checkWithDelay({isActive:!0,key:"LEFT",delay:250})&&c.dec(),o.checkWithDelay({isActive:!0,key:"RIGHT",delay:250})&&c.inc(),o.checkWithDelay({isActive:!0,key:"A",delay:250})&&(y.hide(),u.show(),n.changeState("MAINMENU")));n.checkState("LOADOUTSELECT")&&(0===i&&o.checkWithDelay({isActive:!1,key:"R3",delay:r[l].cooldown})&&A("PRIMARY"),1===i&&o.checkWithDelay({isActive:!1,key:"R3",delay:2e3})&&A("SECONDARY"),o.checkWithDelay({isActive:!0,key:"DOWN",delay:250})&&T(1),o.checkWithDelay({isActive:!0,key:"UP",delay:250})&&(0===i?(n.forceLet("loadoutSelection",0),u.show(),y.hide(),f.hide(),_.hide(),d.hide(),n.changeState("MAINMENU")):T(-1)),o.checkWithDelay({isActive:!0,key:"RIGHT",delay:250})&&S(1),o.checkWithDelay({isActive:!0,key:"LEFT",delay:250})&&S(-1),o.checkWithDelay({isActive:!0,key:"BACK",delay:250})&&(n.forceLet("loadoutSelection",0),u.show(),y.hide(),f.hide(),_.hide(),d.hide(),n.changeState("MAINMENU")))}});i.preserveDrawingBuffer=!0;var n=new PHASER_MASTER({game:i,resolution:{width:a.width,height:a.height}}),o=new PHASER_CONTROLS,r=new PHASER_MOUSE({showDebugger:!1}),s=new PHASER_SPRITE_MANAGER,l=new PHASER_BITMAPDATA_MANAGER,h=new PHASER_TEXT_MANAGER,p=new PHASER_BUTTON_MANAGER,c=new PHASER_GROUP_MANAGER,d=new PHASER_BITMAPDATA_MANAGER,u=new PLAYER_MANAGER,y=new WEAPON_MANAGER,g=new UTILITY_MANAGER,m=a.store,f=JSON.stringify(m.getters._gameData());function v(e,t){n.get("gameData")[e]=t}function b(e,t){void 0===t&&(t=function(){}),g.overlayControls({transition:e,delay:1,speed:250,tileDelay:10},t)}function x(e){y.createBomblet(e,function(t){var a,i,n,o;a=t.x,i=t.y,n=.5,o=e.layer+1,y.createExplosion(a,i,n,o)})}function A(e){n.game();var t=n.getAll(),a=t.primaryWeaponList,i=t.primaryWeaponSelection,o=(t.loadoutSelection,t.secondaryWeaponList),r=t.subWeaponSelection;t.perkSelection,s.getAll("OBJECT").ship;if("PRIMARY"===e)switch(a[i].reference){case"BULLET":!function(){var e=n.game(),t=s.getOnly(["ship"]).ship,a=10,i=2,o=5;t.fireWeapon();for(var r=function(i){setTimeout(function(){y.createBullet({name:"bullet_"+e.rnd.integer(),group:"ship_wpn_preview",x:t.x+i*a-o,y:t.y,spread:0,layer:7})},25)},l=0;l<i;l++)r(l)}();break;case"LASER":!function(){var e=n.game(),t=s.getOnly(["ship"]).ship,a=30,i=1,o=0;t.fireWeapon();for(var r=0;r<i;r++)y.createLaser({name:"laser_"+e.rnd.integer(),group:"ship_wpn_preview",x:t.x+r*a-o,y:t.y-t.height/2,spread:0,layer:7})}();break;case"MISSLE":!function(){var e=n.game(),t=s.getOnly(["ship"]).ship,a=30,i=2,o=15;t.fireWeapon();for(var r=0;r<i;r++)y.createMissle({name:"missle_"+e.rnd.integer(),group:"ship_wpn_preview",x:t.x+r*a-o,y:t.y-t.height/2,spread:r%2==0?-.5:.5,layer:7})}()}if("SECONDARY"===e)switch(s.getGroup("ship_wpn_preview").map(function(e){e.destroyIt()}),o[r].reference){case"CLUSTERBOMB":!function(){var e=n.game(),t=s.getOnly(["ship"]).ship;t.fireSubweapon(),y.createClusterbomb({name:"clusterbomb_"+e.rnd.integer(),group:"ship_wpn_preview",x:t.x-22,y:t.y,layer:2},function(t){for(var a=0;a<t.bomblets;a++)x({x:t.x,y:t.y,ix:e.rnd.integerInRange(-400,400),iy:e.rnd.integerInRange(-400,100),damage:t.damageAmount/4,group:"ship_wpn_preview",layer:2})})}();break;case"TRIPLEBOMB":!function(){for(var e=n.game(),t=s.getOnly(["ship"]).ship,a=0;a<3;a++)setTimeout(function(){t.fireSubweapon(),y.createTriplebomb({name:"triplebomb_"+e.rnd.integer(),group:"ship_wpn_preview",x:t.x+20,y:t.y,layer:2})},300*a)}();break;case"TURRET":!function(){var e=n.game(),t=s.getOnly(["ship"]).ship,a=function(t){var a=10,i=3,n=10;t.fireInterval=setInterval(function(){for(var o=0;o<i;o++)y.createBullet({name:"bullet_"+e.rnd.integer(),group:"ship_wpn_preview",x:t.x+o*a-n,y:t.y,spread:0,layer:2})},200),t.fireInterval},i=function(e){e.x=t.x-e.offset,e.y=t.y},o=function(e){};y.createTurret({name:"turret_"+e.rnd.integer(),group:"ship_wpn_preview",x:t.x,y:t.y,offset:50,layer:3},a,o,i),y.createTurret({name:"turret_"+e.rnd.integer(),group:"ship_wpn_preview",x:t.x,y:t.y,offset:-50,layer:3},a,o,i)}()}}function _(){var e=n.getAll(),t=e.primaryWeaponSelection,a=e.subWeaponSelection,i=e.perkSelection;s.getGroup("ui_box_selected").map(function(e){e.alpha=0}),s.get("sbox_pw_"+t).alpha=1,s.get("sbox_sw_"+a).alpha=1,s.get("sbox_sp_"+i).alpha=1}function w(e){var t=s.getOnly(["profileSelector","loadoutCatagorySelector","container_3"]),a=t.profileSelector,i=(t.loadoutCatagorySelector,t.container_3),o=h.getOnly(["pilotDescriptionText"]).pilotDescriptionText;n.forceLet("primaryWeaponSelection",0),n.forceLet("subWeaponSelection",0),n.forceLet("perkSelection",0),void 0!==s.get("ship")&&u.destroyShip("ship"),function(e){var t=n.getOnly(["weaponData","pilotData"]),a=t.weaponData,i=t.pilotData,o=s.getOnly(["container_2","downarrow"]),r=o.container_2,l=o.downarrow;s.getManyGroups(["ui_loadout","ui_box_selected"]).map(function(e){s.destroy(e.name)}),h.getManyGroups(["ui_loadout"]).map(function(e){h.destroy(e.name)});for(var p=[],d=[],u=[],y=0,g=Object.keys(a.primaryWeapons);y<g.length;y++){var m=g[y];p.push(a.primaryWeapons[m])}for(var f=0,v=Object.keys(a.secondaryWeapons);f<v.length;f++)m=v[f],d.push(a.secondaryWeapons[m]);for(var b=0,x=Object.keys(a.perks);b<x.length;b++)m=x[b],u.push(a.perks[m]);var A=p.filter(function(t){for(var a=0;a<i.pilots[e].weapons.length;a++)if(t.reference===i.pilots[e].weapons[a])return t}),_=d.filter(function(t){for(var a=0;a<i.pilots[e].subweapons.length;a++)if(t.reference===i.pilots[e].subweapons[a])return t}),w=u.filter(function(t){for(var a=0;a<i.pilots[e].perks.length;a++)if(t.reference===i.pilots[e].perks[a])return t});n.forceLet("primaryWeaponList",A),n.forceLet("secondaryWeaponList",_),n.forceLet("perkList",w),A.map(function(e,t){var a=s.addFromAtlas({name:"box_pw_"+t,group:"ui_loadout",y:r.y+90,atlas:"atlas",filename:"ui_box_unselected.png",alpha:0});a.anchor.setTo(.5,.5);var i=(a.width+5)/2*(A.length-1);a.x=r.x+t*a.width+r.width/2-i+5*t,a.alpha=1;var n=s.addFromAtlas({name:"sbox_pw_"+t,group:"ui_box_selected",y:r.y+90,atlas:"atlas",filename:"ui_box_selected.png",alpha:0});n.anchor.setTo(.5,.5),n.x=r.x+t*n.width+r.width/2-i+5*t,n.alpha=0;var o=s.addFromAtlas({name:"icon_pw_"+t,group:"ui_loadout",y:r.y+90,atlas:"atlas_weapons",filename:""+e.spriteIcon,alpha:1});o.anchor.setTo(.5,.5),o.x=r.x+t*n.width+r.width/2-i+5*t,c.addMany(13,[a,n,o])}),_.map(function(e,t){var a=s.addFromAtlas({name:"box_sw_"+t,group:"ui_loadout",y:r.y+140,atlas:"atlas",filename:"ui_box_unselected.png",alpha:0});a.anchor.setTo(.5,.5);var i=(a.width+5)/2*(_.length-1);a.x=r.x+t*a.width+r.width/2-i+5*t,a.alpha=1;var n=s.addFromAtlas({name:"sbox_sw_"+t,group:"ui_box_selected",y:r.y+140,atlas:"atlas",filename:"ui_box_selected.png",alpha:0});n.anchor.setTo(.5,.5),n.x=r.x+t*n.width+r.width/2-i+5*t,n.alpha=0;var o=s.addFromAtlas({name:"icon_sw_"+t,group:"ui_loadout",y:r.y+140,atlas:"atlas_weapons",filename:""+e.spriteIcon,alpha:1});o.anchor.setTo(.5,.5),o.x=r.x+t*n.width+r.width/2-i+5*t,c.addMany(13,[a,n,o])}),w.map(function(e,t){var a=s.addFromAtlas({name:"box_sp_"+t,group:"ui_loadout",y:r.y+190,atlas:"atlas",filename:"ui_box_unselected.png",alpha:0});a.anchor.setTo(.5,.5);var i=(a.width+5)/2*(w.length-1);a.x=r.x+t*a.width+r.width/2-i+5*t,a.alpha=1;var n=s.addFromAtlas({name:"sbox_sp_"+t,group:"ui_box_selected",y:r.y+190,atlas:"atlas",filename:"ui_box_selected.png",alpha:0});n.anchor.setTo(.5,.5),n.x=r.x+t*n.width+r.width/2-i+5*t,n.alpha=0;var o=s.addFromAtlas({name:"icon_sp_"+t,group:"ui_loadout",y:r.y+190,atlas:"atlas_weapons",filename:""+e.spriteIcon,alpha:1});o.anchor.setTo(.5,.5),o.x=r.x+t*n.width+r.width/2-i+5*t,c.addMany(13,[a,n,o])});var T=s.addFromAtlas({name:"loadoutCatagorySelector",group:"ui_loadout",atlas:"atlas",filename:"ui_pointer.png",visible:!1,alpha:0});T.anchor.setTo(.5,.5),T.show=function(){this.visible=!0},T.hide=function(){this.visible=!1},T.updateLocation=function(e){var t,a=n.getAll(),i=a.primaryWeaponSelection,o=a.subWeaponSelection,r=a.perkSelection;if(0===e){var h=(t=s.get("box_pw_"+i)).x,p=t.y;l.updateLocation(h,p-30)}if(1===e){var c=(t=s.get("box_sw_"+o)).x,d=t.y;l.updateLocation(c,d-30)}if(2===e){var u=(t=s.get("box_sp_"+r)).x,y=t.y;l.updateLocation(u,y-30)}t.x;var g=t.y;this.x=40,this.y=g,this.visible};var S=s.addFromAtlas({name:"loadoutDescription",group:"ui_loadout",atlas:"atlas",filename:"ui_descriptionbox_small.png",visible:!1});S.anchor.setTo(.5,.5),s.centerOnPoint("loadoutDescription",r.width/2+S.width/2,r.y+310);var E=h.add({name:"loadoutDescriptionText",group:"ui_loadout",x:S.x,y:S.y,font:"gem",size:14,default:""});E.anchor.setTo(.5,.5),E.maxWidth=S.width-40,c.add(17,S),c.add(18,E)}(e),a.updateLocation(e),o.updateThisText(e),_();var r=n.getOnly(["primaryWeaponSelection","primaryWeaponList","secondaryWeaponList","subWeaponSelection","perkSelection","perkList"]),l=r.primaryWeaponSelection,p=r.primaryWeaponList,d=r.secondaryWeaponList,y=r.subWeaponSelection,g=r.perkSelection,m=r.perkList,f=u.createShip({name:"ship",group:"playership",shipId:e,layer:5});f.attachPerk(m[g].reference),f.attachWeapon(p[l].reference),f.attachSubweapon(d[y].reference),f.visible=!0,s.centerOnPoint("ship",i.x+i.width/2+f.width/2,i.height-100)}function T(e){var t=n.getAll().loadoutSelection,a=s.getAll("OBJECT"),i=(a.downarrow,a.loadoutCatagorySelector);t+=e,e>0&&t>2&&(t=2),e<0&&t<0&&(t=0),n.forceLet("loadoutSelection",t),S(null),i.updateLocation(t)}function S(e){var t,a=n.getOnly(["weaponData","loadoutSelection","primaryWeaponSelection","subWeaponSelection","perkSelection","primaryWeaponList","secondaryWeaponList","perkList"]),i=(a.weaponData,a.loadoutSelection),o=a.primaryWeaponSelection,r=a.subWeaponSelection,l=a.perkSelection,p=a.primaryWeaponList,c=a.secondaryWeaponList,d=a.perkList,u=s.getOnly(["downarrow","loadoutCatagorySelector","ship"]),y=u.downarrow,g=u.loadoutCatagorySelector,m=u.ship,f=h.getOnly(["loadoutDescriptionText"]).loadoutDescriptionText;switch(i){case 0:o+=e,e>0&&(o>=p.length&&(o=0),n.forceLet("primaryWeaponSelection",o)),e<0&&(o<0&&(o=p.length-1),n.forceLet("primaryWeaponSelection",o)),f.setText(p[o].name+": "+p[o].description);break;case 1:r+=e,e>0&&(r>=c.length&&(r=0),n.forceLet("subWeaponSelection",r)),e<0&&(r<0&&(r=c.length-1),n.forceLet("subWeaponSelection",r)),f.setText(c[r].name+": "+c[r].description);break;case 2:l+=e,e>0&&(l>=d.length&&(l=0),n.forceLet("perkSelection",l)),e<0&&(l<0&&(l=d.length-1),n.forceLet("perkSelection",l)),f.setText(d[l].name+": "+d[l].description)}if(m.attachPerk(d[l].reference),m.attachWeapon(p[o].reference),m.attachSubweapon(c[r].reference),0===i){var v=(t=s.get("box_pw_"+o)).x,b=t.y;y.updateLocation(v,b-30)}if(1===i){v=(t=s.get("box_sw_"+r)).x,b=t.y;y.updateLocation(v,b-30)}if(2===i){v=(t=s.get("box_sp_"+l)).x,b=t.y;y.updateLocation(v,b-30)}_(),g.updateLocation(i)}n.let("gameData",JSON.parse(f)),t.game=this,this.game=n.game()},e.prototype.destroy=function(){this.game.destroy()},e}(),__phaser=new PhaserGameObject,PHASER_AUDIO=function(){return function(){}}(),PHASER_BITMAPDATA_MANAGER=function(){function e(){this.game=null,this.bmd={array:[],object:{}}}return e.prototype.assign=function(e){this.game=e},e.prototype.addGradient=function(e){if(0===this.bmd.array.filter(function(t){return t.name===e.name}).length){var t=this.game.make.bitmapData(e.width,e.height),a=t.context.createLinearGradient(0,0,0,e.height);a.addColorStop(0,e.start),a.addColorStop(1,e.end),t.context.fillStyle=a,t.context.fillRect(0,0,e.width,e.height);var i=this.game.cache.addBitmapData(e.name,t),n=this.game.make.bitmapData();return n.load(this.game.cache.getBitmapData(e.name)),e.render&&n.addToWorld(e.x,e.y),n.name=e.name,n.group=e.group,n.cacheBitmapData=i,this.bmd.array.push(n),this.bmd.object[e.name]=n,n}console.log("Duplicate key name not allowed: "+e.name)},e.prototype.addImage=function(e){if(0===this.bmd.array.filter(function(t){return t.name===e.name}).length){var t=this.game.make.bitmapData();return t.load(e.reference),t.addToWorld(e.x,e.y),e.render||t.cls(),t.name=e.name,t.group=e.group,t.cacheBitmapData=e.reference,this.bmd.array.push(t),this.bmd.object[e.name]=t,t}console.log("Duplicate key name not allowed: "+e.name)},e.prototype.addEmpty=function(e){if(0===this.bmd.array.filter(function(t){return t.name===e.name}).length){var t=this.game.make.bitmapData(e.width,e.height);return t.addToWorld(e.x,e.y),e.render||t.cls(),t.name=e.name,t.group=e.group,this.bmd.array.push(t),this.bmd.object[e.name]=t,t}console.log("Duplicate key name not allowed: "+e.name)},e.prototype.destroy=function(e){for(var t=[],a=0,i=this.bmd.array.filter(function(t){return t.name===e});a<i.length;a++){var n=i[a];t.push(n.name),n.destroy()}return delete this.bmd.object[e],this.bmd.array=this.bmd.array.filter(function(t){return t.name!==e}),t},e.prototype.destroyGroup=function(e){for(var t=[],a=0,i=this.bmd.array.filter(function(e){return e.group===name});a<i.length;a++){var n=i[a];t.push(n.name),n.destroy()}return delete this.bmd.object[name],this.bmd.array=this.bmd.array.filter(function(e){return e.group!==name}),t},e.prototype.get=function(e){return this.bmd.object[e]},e.prototype.getGroup=function(e){return this.bmd.array.filter(function(t){return t.group===e})},e.prototype.getAll=function(e){return void 0===e&&(e="BOTH"),"ARRAY"===e?this.bmd.array:"OBJECT"==e?this.bmd.object:{object:this.bmd.object,array:this.bmd.array}},e.prototype.takeSnapshot=function(){return this.game.canvas.toDataURL()},e}(),PHASER_BUTTON_MANAGER=function(){function e(){this.game=null,this.resources={array:[],object:{}}}return e.prototype.assign=function(e){this.game=e.game},e.prototype.add=function(e){if(0===this.resources.array.filter(function(t){return t.name===e.name}).length){var t=this.game.add.button(e.x,e.y,e.reference,e.onclick);return t.name=e.name,t.group=e.group||null,this.resources.array.push(t),this.resources.object[e.name]=t,t}console.log("Duplicate key name not allowed: "+e.name)},e.prototype.destroy=function(e){for(var t=[],a=0,i=this.resources.array.filter(function(t){return t.key===e});a<i.length;a++){var n=i[a];t.push(n.key),n.destroy()}return delete this.resources.object[e],this.resources.array=this.resources.array.filter(function(t){return t.key!==e}),t},e.prototype.destroyGroup=function(e){for(var t=[],a=0,i=this.resources.array.filter(function(t){return t.group===e});a<i.length;a++){var n=i[a];t.push(n.key),n.destroy()}return delete this.resources.object[e],this.resources.array=this.resources.array.filter(function(t){return t.group!==e}),t},e.prototype.get=function(e){return this.resources.object[e]},e.prototype.getGroup=function(e){return this.resources.array.filter(function(t){return t.group===e})},e.prototype.getAll=function(e){return void 0===e&&(e="BOTH"),"ARRAY"===e?this.resources.array:"OBJECT"==e?this.resources.object:{object:this.resources.object,array:this.resources.array}},e}(),PHASER_CONTROLS=function(){function e(){this.IO=null,this.game=null,this.buttonSensitivity={QUICK:1,SHORT:50,LONG:150,SUPERLONG:300},this.releasedKeys=[],this.properties={isReady:!1,allowDebugger:!0,buttonDelay:50,timingRefreshRate:1},this.directionalButtons=["UP","DOWN","LEFT","RIGHT"],this.actionButtons=["A","B","X","Y"],this.triggerButtons=["L1","L2","R1","R2","L3","R3"],this.systemButtons=["START","BACK"],this.buttonArray=this.directionalButtons.concat(this.actionButtons,this.triggerButtons,this.systemButtons),this.buttonMap={UP:{name:"UP",code:"ArrowUp"},DOWN:{name:"DOWN",code:"ArrowDown"},LEFT:{name:"LEFT",code:"ArrowLeft"},RIGHT:{name:"RIGHT",code:"ArrowRight"},A:{name:"A",code:"KeyA"},B:{name:"S",code:"KeyS"},X:{name:"D",code:"KeyD"},Y:{name:"F",code:"KeyF"},L1:{name:"Q",code:"KeyQ"},L2:{name:"W",code:"KeyW"},R1:{name:"E",code:"KeyE"},R2:{name:"R",code:"KeyR"},L3:{name:"O",code:"KeyO"},R3:{name:"P",code:"KeyP"},START:{name:"ENTER",code:"Enter"},BACK:{name:"BACKSPACE",code:"Backspace"}},this.buttonMapId={UP:1,DOWN:2,LEFT:3,RIGHT:4,A:5,B:6,X:7,Y:8,L1:9,L2:10,R1:11,R2:12,L3:13,R3:14,START:15,BACK:16},this.disabledButtons={ALL:!1,DIRECTIONAL:!1,TRIGGER:!1,ACTION:!1,SYSTEM:!1},this.debugger={enabled:!1,text:{}},this.inputDelay={delay:Array.apply(null,Array(20)).map(function(){return 0})}}return e.prototype.assign=function(e){var t=this;this.game=e;var a={font:"12px Courier New",fill:"#fff",align:"left"};this.buttonArray.forEach(function(i,n){t.debugger.text[i]=null,t.debugger.text[i]=e.add.text(10,10+15*n,"",a),t.disabledButtons[i]=!1});for(var i={buttons:{},sensitivityPress:{},sensitivityBuffer:{},state:{}},n=function(a){i.buttons[a]=e.input.keyboard.addKey(Phaser.Keyboard[o.buttonMap[a].name]),i.sensitivityPress[a]=null,i.sensitivityBuffer[a]=0,i.state[a]=function(){return t.getBtnPressType(t.IO.sensitivityBuffer[a])}},o=this,r=0,s=this.buttonArray;r<s.length;r++){n(s[r])}for(var l=function(e){i.buttons[e].onDown.add(function(a){var n,o;clearInterval(i.sensitivityPress[e]);var r=["DIRECTIONAL","ACTION","TRIGGER","SYSTEM"];Object.keys(t.buttonMap).forEach(function(e,i){if(t.buttonMap[e].code===a.event.code)for(var s=0,l=r;s<l.length;s++){var h=l[s];t[h.toLowerCase()+"Buttons"].indexOf(e)+1&&(n=h,o=e)}});var s=!1;t.disabledButtons.ALL&&(s=!0);for(var l=0,h=r;l<h.length;l++){var p=h[l];t.disabledButtons[p]&&n===p&&(s=!0)}Object.keys(t.buttonMap).forEach(function(e,a){t.disabledButtons[e]&&o===e&&(s=!0)}),s||(i.sensitivityPress[e]=setInterval(function(){i.sensitivityBuffer[e]+=1},t.properties.timingRefreshRate))},h)},h=this,p=0,c=this.buttonArray;p<c.length;p++){l(c[p])}return e.input.keyboard.onUpCallback=function(e){for(var a=0,n=t.buttonArray;a<n.length;a++){var o=n[a];e.code===t.buttonMap[o].code&&(t.releasedKeys.push(t.buttonMap[o].code),setTimeout(function(){t.releasedKeys.shift()},1500),clearInterval(i.sensitivityPress[o]),i.sensitivityBuffer[o]=0)}"Backquote"===e.code&&t.properties.allowDebugger&&(t.setDebugger(!t.debugger.enabled),t.updateDebugger())},this.properties.isReady=!0,this.IO=i,i},e.prototype.mapKeys=function(e){var t=this;this.properties.isReady=!1,this.destroyAll(),setTimeout(function(){t.buttonMap=e,t.properties.isReady=!0,t.assign(t.game)},1)},e.prototype.isReady=function(){return this.properties.isReady},e.prototype.checkWithDelay=function(e){return this.read(e.key).active===e.isActive&&(this.game.time.now>this.inputDelay.delay[this.getKeyId(e.key)]&&(this.inputDelay.delay[this.getKeyId(e.key)]=e.delay+this.game.time.now,!0))},e.prototype.isDebuggerEnabled=function(){return this.debugger.enabled},e.prototype.setDebugger=function(e){void 0===e&&(e=!0),this.debugger.enabled=e},e.prototype.updateDebugger=function(){if(this.properties.isReady)for(var e=0,t=this.buttonArray;e<t.length;e++){var a=t[e];this.debugger.text[a].setText(this.debugger.enabled?this.debuggerString(a):"").bringToTop()}},e.prototype.disableAllInput=function(){this.disabledButtons.ALL=!0},e.prototype.enableAllInput=function(){this.disabledButtons.ALL=!1},e.prototype.disableAllDirectionalButtons=function(){this.disabledButtons.DIRECTIONAL=!0},e.prototype.enableAllDirectionalButtons=function(){this.disabledButtons.DIRECTIONAL=!1},e.prototype.disableAllTriggerButtons=function(){this.disabledButtons.TRIGGER=!0},e.prototype.enableAllTriggerButtons=function(){this.disabledButtons.TRIGGER=!1},e.prototype.disableAllActionButtons=function(){this.disabledButtons.ACTION=!0},e.prototype.enableAllActionButtons=function(){this.disabledButtons.ACTION=!1},e.prototype.disableAllSystemButtons=function(){this.disabledButtons.SYSTEM=!0},e.prototype.enableAllSystemButtons=function(){this.disabledButtons.SYSTEM=!1},e.prototype.setDisableKeyProperty=function(e,t){void 0===t&&(t=!0),this.properties.isReady&&(this.disabledButtons[e.toUpperCase()]=t)},e.prototype.getKeyDisabledValue=function(e){return this.properties.isReady?this.disabledButtons[e.toUpperCase()]:null},e.prototype.clearAllControlIntervals=function(){if(this.properties.isReady)for(var e=0,t=this.buttonArray;e<t.length;e++){var a=t[e];clearInterval(this.IO.sensitivityPress[a])}},e.prototype.getKeyId=function(e){return this.buttonMapId[e.toUpperCase()]},e.prototype.read=function(e){if(this.properties.isReady){return{}[e]={id:this.buttonMapId[e.toUpperCase()],active:this.IO.state[e.toUpperCase()]().val>0,duration:this.IO.state[e.toUpperCase()]().val,state:this.IO.state[e.toUpperCase()]().state,type:this.IO.state[e.toUpperCase()]().type,disabled:this.disabledButtons[e.toUpperCase()]}}return{}},e.prototype.readMulti=function(e,t){if(void 0===t&&(t="OBJECT"),this.properties.isReady){if("OBJECT"===t){for(var a={},i=0,n=e;i<n.length;i++){a[s=n[i]]={id:this.buttonMapId[s.toUpperCase()],active:this.IO.state[s.toUpperCase()]().val>0,duration:this.IO.state[s.toUpperCase()]().val,state:this.IO.state[s.toUpperCase()]().state,type:this.IO.state[s.toUpperCase()]().type,disabled:this.disabledButtons[s.toUpperCase()]}}return a}if("ARRAY"===t){a=[];for(var o=0,r=e;o<r.length;o++){var s=r[o];a.push({id:this.buttonMapId[s.toUpperCase()],key:s,active:this.IO.state[s.toUpperCase()]().val>0,duration:this.IO.state[s.toUpperCase()]().val,state:this.IO.state[s.toUpperCase()]().state,type:this.IO.state[s.toUpperCase()]().type,disabled:this.disabledButtons[s.toUpperCase()]})}return a}}},e.prototype.getReleasedKeys=function(){return this.releasedKeys},e.prototype.getOnly=function(e){for(var t=this,a={},i=function(i){e.map(function(e){i===e&&(a[i]={id:t.buttonMapId[i.toUpperCase()],active:t.IO.state[i.toUpperCase()]().val>0,duration:t.IO.state[i.toUpperCase()]().val,state:t.IO.state[i.toUpperCase()]().state,type:t.IO.state[i.toUpperCase()]().type,disabled:t.disabledButtons[i.toUpperCase()]})})},n=0,o=this.buttonArray;n<o.length;n++){i(o[n])}return a},e.prototype.getAll=function(){for(var e={},t=0,a=this.buttonArray;t<a.length;t++){var i=a[t];e[i]={id:this.buttonMapId[i.toUpperCase()],active:this.IO.state[i.toUpperCase()]().val>0,duration:this.IO.state[i.toUpperCase()]().val,state:this.IO.state[i.toUpperCase()]().state,type:this.IO.state[i.toUpperCase()]().type,disabled:this.disabledButtons[i.toUpperCase()]}}return e},e.prototype.debuggerString=function(e){return e.toUpperCase()+" ("+this.buttonMap[e.toUpperCase()].name+"/"+this.buttonMap[e.toUpperCase()].code+") | id: "+this.buttonMapId[e.toUpperCase()]+" duration: "+this.IO.state[e.toUpperCase()]().val+" | state: "+this.IO.state[e.toUpperCase()]().state+" | type: "+this.IO.state[e.toUpperCase()]().type+" | disabled: "+this.disabledButtons[e.toUpperCase()]},e.prototype.getBtnPressType=function(e){var t=this,a="NONE",i=0,n=0;return Object.keys(this.buttonSensitivity).forEach(function(o){n++,e>t.buttonSensitivity[o]&&(a=o,i=n)}),{val:e,type:a,state:i}},e.prototype.destroyAll=function(){var e=this;this.clearAllControlIntervals(),Object.keys(this.debugger.text).forEach(function(t){e.debugger.text[t].destroy()})},e}(),PHASER_GROUP_MANAGER=function(){function e(){this.game=null,this.group={array:[],object:{}}}return e.prototype.assign=function(e,t){void 0===t&&(t=10),this.game=e;for(var a=0;a<=t;a++){var i=e.add.group();this.group.object[""+a]=i,this.group.array.push(i)}},e.prototype.layer=function(e){return this.group.object[e]},e.prototype.add=function(e,t){this.group.object[e].add(t)},e.prototype.addMany=function(e,t){var a=this;t.forEach(function(t){a.group.object[e].add(t)})},e}(),PHASER_MASTER=function(){function e(e){this._game=e.game,this.resolution=e.resolution,this.states={BOOT:"BOOT",PRELOAD:"PRELOAD",READY:"READY"},this.currentState=this.states[0],this.variables={}}return e.prototype.let=function(e,t){if(void 0===t&&(t=null),void 0===this.variables[e])return this.variables[e]=t;console.log("Cannot LET duplicate key in PHASER_MASTER: "+e)},e.prototype.forceLet=function(e,t){return void 0===t&&(t=null),this.variables[e]=t},e.prototype.delete=function(e){delete this.variables[e]},e.prototype.get=function(e){return void 0!==this.variables[e]?this.variables[e]:(console.log("Cannot GET a variable that does not exist in PHASER_MASTER."),null)},e.prototype.getAll=function(){return this.variables},e.prototype.getOnly=function(e){var t={},a=[];for(var i in this.variables)a.push({key:i,data:this.variables[i]});for(var n=function(i){a.filter(function(t){return t.key===e[i]}).map(function(e){t[e.key]=e.data})},o=0;o<e.length;o++)n(o);return t},e.prototype.changeState=function(e){void 0===e&&(e=null);var t=e.toUpperCase(),a=!1;return void 0===this.states[t]&&(this.states[t]=t,a=!0),this.currentState=t,{created:a,state:this.currentState}},e.prototype.getCurrentState=function(){return this.currentState},e.prototype.getStates=function(){return this.states},e.prototype.getResolution=function(){return this.resolution},e.prototype.checkState=function(e){return this.currentState===e.toUpperCase()},e.prototype.getState=function(){return{currentState:this.currentState}},e.prototype.game=function(){return this._game},e}(),PHASER_MOUSE=function(){function e(e){this.game=null,this.clickSensitvity={QUICK:1,SHORT:50,LONG:150,SUPERLONG:300},this.mouseMapping=[0,1,2],this.mouseMap={LEFT:0,MIDDLE:1,RIGHT:2},this.metrics={sensitivityPress:{},sensitivityBuffer:{},location:{},state:{}},this.properties={allowDebugger:!0,timingRefreshRate:1},this.inputDelay={delay:Array.apply(null,Array(2)).map(function(){return 0})},this.debugger={enabled:void 0!==e.showDebugger&&e.showDebugger,text:{},pointer:null}}return e.prototype.assign=function(e){var t=this;this.game=e;for(var a=function(e){i.metrics.sensitivityPress[e]=null,i.metrics.sensitivityBuffer[e]=0,i.metrics.location[e]={x:null,y:null},i.metrics.state[e]=function(){return t.getBtnPressType(t.metrics.sensitivityBuffer[e])}},i=this,n=0,o=this.mouseMapping;n<o.length;n++){a(o[n])}this.game.input.onDown.add(function(e){var a=t.checkMouseClick();clearInterval(t.metrics.sensitivityPress[a]),t.metrics.sensitivityPress[a]=setInterval(function(){t.metrics.sensitivityBuffer[a]+=1,t.metrics.location[a]={x:e.x,y:e.y}},t.properties.timingRefreshRate)}),this.game.input.onUp.add(function(e){var a=t.checkMouseClick();t.clearAllControlIntervals(),t.metrics.sensitivityBuffer[a]=0});var r={font:"12px Courier New",fill:"#fff",align:"left"};this.mouseMapping.forEach(function(e,a){t.debugger.text[e]=null,t.debugger.text[e]=t.game.add.text(5,t.game.height-35-15*a,"",r)}),this.debugger.pointer=this.game.add.text(5,this.game.height-20,"",r),e.canvas.oncontextmenu=function(e){e.preventDefault()}},e.prototype.checkMouseClick=function(){var e=0;return this.game.input.activePointer.leftButton.isDown&&(e=0),this.game.input.activePointer.middleButton.isDown&&(e=1),this.game.input.activePointer.rightButton.isDown&&(e=2),e},e.prototype.debuggerString=function(e){return"Button_"+e+" | {x: "+this.metrics.location[e].x+", y: "+this.metrics.location[e].y+"} | active: "+(this.metrics.sensitivityBuffer[e]>0)+" | state: "+this.metrics.state[e]().state+" | duration: "+this.metrics.state[e]().val+" | type: "+this.metrics.state[e]().type},e.prototype.setDebugger=function(e){void 0===e&&(e=!0),this.debugger.enabled=e},e.prototype.updateDebugger=function(){for(var e=0,t=this.mouseMapping;e<t.length;e++){var a=t[e];this.debugger.text[a].setText(this.debugger.enabled?this.debuggerString(a):"").bringToTop()}this.debugger.pointer.setText(this.debugger.enabled?"Pointer: {x: "+this.game.input.mousePointer.x+", y: "+this.game.input.mousePointer.y+"}":"").bringToTop()},e.prototype.clearAllControlIntervals=function(){for(var e=0,t=this.mouseMapping;e<t.length;e++){var a=t[e];this.metrics.sensitivityBuffer[a]=0,clearInterval(this.metrics.sensitivityPress[a])}},e.prototype.checkWithDelay=function(e){if(this.read(e.key).active===e.isActive){var t=this.mouseMap[e.key.toUpperCase()];return this.game.time.now>this.inputDelay.delay[t]&&(this.inputDelay.delay[t]=e.delay+this.game.time.now,!0)}return!1},e.prototype.read=function(e){void 0===e&&(e="LEFT");var t=this.mouseMap[e.toUpperCase()];return{id:t,x:this.metrics.location[t].x,y:this.metrics.location[t].y,active:this.metrics.sensitivityBuffer[t]>0,duration:this.metrics.sensitivityBuffer[t],state:this.metrics.state[t]().state,type:this.metrics.state[t]().type}},e.prototype.getBtnPressType=function(e){var t=this,a="NONE",i=0,n=0;return Object.keys(this.clickSensitvity).forEach(function(o){n++,e>t.clickSensitvity[o]&&(a=o,i=n)}),{val:e,type:a,state:i}},e}(),PHASER_PRELOADER=function(){function e(e){this.game=e.game,this.init(e.delayInSeconds,e.done)}return e.prototype.init=function(e,t){var a,i,n=this;this.game.load.onLoadStart.add(function(){(a=n.game.add.text(n.game.world.centerX,n.game.world.centerY/2,"",{font:"18px Impact",fill:"#fff",align:"center"})).anchor.set(.5),(i=n.game.add.text(n.game.world.centerX,n.game.world.centerY,"",{font:"32px Impact",fill:"#fff",align:"center"})).anchor.set(.5)},this),this.game.load.onFileComplete.add(function(e,t,n,o,r){a.setText("Please wait..."),i.setText(e+"%")},this),this.game.load.onLoadComplete.add(function(){a.setText("File loaded!"),i.setText(""),n.game.time.events.add(Phaser.Timer.SECOND*e,function(){a.destroy(),i.destroy(),t()},n).autoDestroy=!0},this)},e}(),PHASER_SPRITE_MANAGER=function(){function e(){this.game=null,this.sprites={array:[],object:{}},this.spriteCount=0}return e.prototype.assign=function(e){this.game=e},e.prototype.add=function(e){if(0===this.sprites.array.filter(function(t){return t.name===e.name}).length){e.x=void 0!==e.x?e.x:0,e.y=void 0!==e.y?e.y:0,e.group=void 0!==e.group?e.group:null,e.visible=void 0===e.visible||e.visible,e.alpha=void 0!==e.alpha?e.alpha:1,e.width=void 0!==e.width?e.width:null,e.height=void 0!==e.height?e.height:null;var t=this.game.add.sprite(e.x,e.y,e.reference);return t.name=e.name,t.group=e.group,t.defaultPosition={x:e.x,y:e.y},t.visible=e.visible,t.alpha=e.alpha,null!==e.width&&(t.width=e.width),null!==e.height&&(t.height=e.height),t.setDefaultPositions=function(e,t){this.defaultPosition.x=e,this.defaultPosition.y=t},t.getDefaultPositions=function(){return this.defaultPosition},t.init=function(){},t.onUpdate=function(){},t.reveal=function(){},t.show=function(){this.visible=!0},t.hide=function(){this.visible=!1},this.sprites.array.push(t),this.sprites.object[e.name]=t,t}console.log("Duplicate key name not allowed: "+e.name)},e.prototype.addFromAtlas=function(e){if(0===this.sprites.array.filter(function(t){return t.name===e.name}).length){e.x=void 0!==e.x?e.x:0,e.y=void 0!==e.y?e.y:0,e.group=void 0!==e.group?e.group:null,e.visible=void 0===e.visible||e.visible,e.alpha=void 0!==e.alpha?e.alpha:1,e.width=void 0!==e.width?e.width:null,e.height=void 0!==e.height?e.height:null;var t=this.game.add.sprite(e.x,e.y,e.atlas,e.filename);return t.name=e.name,t.group=e.group,t.defaultPosition={x:e.x,y:e.y},t.visible=e.visible,t.alpha=e.alpha,null!==e.width&&(t.width=e.width),null!==e.height&&(t.height=e.height),t.setDefaultPositions=function(e,t){this.defaultPosition.x=e,this.defaultPosition.y=t},t.getDefaultPositions=function(){return this.defaultPosition},t.init=function(){},t.onUpdate=function(){},t.reveal=function(){},t.show=function(){this.visible=!0},t.hide=function(){this.visible=!1},this.sprites.array.push(t),this.sprites.object[e.name]=t,t}console.log("Duplicate key name not allowed: "+e.name)},e.prototype.addTilespriteFromAtlas=function(e){if(0===this.sprites.array.filter(function(t){return t.name===e.name}).length){e.x=void 0!==e.x?e.x:0,e.y=void 0!==e.y?e.y:0,e.group=void 0!==e.group?e.group:null,e.visible=void 0===e.visible||e.visible,e.alpha=void 0!==e.alpha?e.alpha:1,e.width=void 0!==e.width?e.width:null,e.height=void 0!==e.height?e.height:null;var t=this.game.add.tileSprite(e.x,e.y,e.width,e.height,e.atlas,e.filename);return t.name=e.name,t.group=e.group,t.defaultPosition={x:e.x,y:e.y},t.visible=e.visible,t.alpha=e.alpha,null!==e.width&&(t.width=e.width),null!==e.height&&(t.height=e.height),t.setDefaultPositions=function(e,t){this.defaultPosition.x=e,this.defaultPosition.y=t},t.getDefaultPositions=function(){return this.defaultPosition},t.init=function(){},t.onUpdate=function(){},t.reveal=function(){},t.show=function(){this.visible=!0},t.hide=function(){this.visible=!1},this.sprites.array.push(t),this.sprites.object[e.name]=t,t}console.log("Duplicate key name not allowed: "+e.name)},e.prototype.addEmptySprite=function(e){if(0===this.sprites.array.filter(function(t){return t.name===e.name}).length){e.x=void 0!==e.x?e.x:0,e.y=void 0!==e.y?e.y:0,e.group=void 0!==e.group?e.group:null,e.visible=void 0===e.visible||e.visible,e.alpha=void 0!==e.alpha?e.alpha:1,e.width=void 0!==e.width?e.width:null,e.height=void 0!==e.height?e.height:null;var t=this.game.add.sprite(e.x,e.y);return t.name=e.name,t.group=e.group,t.defaultPosition={x:e.x,y:e.y},t.visible=e.visible,t.alpha=e.alpha,null!==e.width&&(t.width=e.width),null!==e.height&&(t.height=e.height),t.setDefaultPositions=function(e,t){this.defaultPosition.x=e,this.defaultPosition.y=t},t.getDefaultPositions=function(){return this.defaultPosition},t.init=function(){},t.onUpdate=function(){},t.reveal=function(){},t.show=function(){this.visible=!0},t.hide=function(){this.visible=!1},this.sprites.array.push(t),this.sprites.object[e.name]=t,t}console.log("Duplicate key name not allowed: "+e.name)},e.prototype.createBasicMask=function(e,t,a,i){var n=this.game.add.graphics(0,0);return n.beginFill(16777215),n.drawRect(e,t,a,i),n},e.prototype.addBasicMaskToSprite=function(e){var t=this.game.add.graphics(0,0);return t.beginFill(16777215),t.drawRect(e.x,e.y,e.width,e.height),e.mask=t,t},e.prototype.destroy=function(e){if(void 0!==this.sprites.object[e]){for(var t=[],a=0,i=this.sprites.array.filter(function(t){return t.name===e});a<i.length;a++){var n=i[a];t.push(n.name),n.destroy()}return delete this.sprites.object[e],this.sprites.array=this.sprites.array.filter(function(t){return t.name!==e}),t}return console.log("Cannot delete "+e+" because it does not exist."),null},e.prototype.destroyGroup=function(e){for(var t=[],a=0,i=this.sprites.array.filter(function(t){return t.group===e});a<i.length;a++){var n=i[a];t.push(n.name),n.destroy()}return delete this.sprites.object[e],this.sprites.array=this.sprites.array.filter(function(t){return t.group!==e}),t},e.prototype.get=function(e){return this.sprites.object[e]},e.prototype.getGroup=function(e){return this.sprites.array.filter(function(t){return t.group===e})},e.prototype.getManyGroups=function(e){for(var t=[],a=function(a){var n=i.sprites.array.filter(function(t){return t.group===e[a]});t=t.concat(n)},i=this,n=0;n<e.length;n++)a(n);return t},e.prototype.getOnly=function(e){for(var t={},a=function(a){i.sprites.array.filter(function(t){return t.group===e[a]||t.name===e[a]}).map(function(e){t[e.name]=e})},i=this,n=0;n<e.length;n++)a(n);return t},e.prototype.getAll=function(e){return void 0===e&&(e="OBJECT"),"ARRAY"===e?this.sprites.array:"OBJECT"==e?this.sprites.object:{object:this.sprites.object,array:this.sprites.array}},e.prototype.count=function(){return this.spriteCount++,{total:this.sprites.array.length,unique:this.spriteCount}},e.prototype.centerWorld=function(e){if(void 0===this.sprites.object[e])return console.log("Error centering sprite:  key does not exists."),null;var t=this.sprites.object[e];return t.alignIn(this.game.world.bounds,Phaser.CENTER),t},e.prototype.centerOnPoint=function(e,t,a){if(void 0===this.sprites.object[e])return console.log("Error centering sprite:  key does not exists."),null;var i=this.sprites.object[e];return i.x=t-i.width/2,i.y=a-i.height/2,i},e}(),PHASER_TEXT_MANAGER=function(){function e(){this.game=null,this.texts={array:[],object:{}}}return e.prototype.assign=function(e){this.game=e},e.prototype.add=function(e){var t=this.texts.array.filter(function(t){return t.name===e.name});if(e.x=void 0!==e.x?e.x:0,e.y=void 0!==e.y?e.y:0,e.group=void 0!==e.group?e.group:null,e.size=void 0!==e.size?e.size:12,e.default=void 0!==e.default?e.default:"",e.visible=void 0===e.visible||e.visible,e.alpha=void 0!==e.alpha?e.alpha:1,0===t.length){var a=this.game.add.bitmapText(e.x,e.y,e.font,e.default,e.size);return a.name=e.name,a.group=e.group,a.visible=e.visible,a.alpha=e.alpha,a.show=function(){this.visible=!0},a.hide=function(){this.visible=!1},this.texts.array.push(a),this.texts.object[e.name]=a,a}console.log("Duplicate key name not allowed: "+e.name)},e.prototype.destroy=function(e){for(var t=[],a=0,i=this.texts.array.filter(function(t){return t.name===e});a<i.length;a++){var n=i[a];t.push(n.name),n.destroy()}return delete this.texts.object[e],this.texts.array=this.texts.array.filter(function(t){return t.name!==e}),t},e.prototype.destroyGroup=function(e){for(var t=[],a=0,i=this.texts.array.filter(function(t){return t.group===e});a<i.length;a++){var n=i[a];t.push(n.key),n.destroy()}return delete this.texts.object[e],this.texts.array=this.texts.array.filter(function(t){return t.group!==e}),t},e.prototype.get=function(e){return this.texts.object[e]},e.prototype.getGroup=function(e){return this.texts.array.filter(function(t){return t.group===e})},e.prototype.getManyGroups=function(e){for(var t=[],a=function(a){var n=i.texts.array.filter(function(t){return t.group===e[a]});t=t.concat(n)},i=this,n=0;n<e.length;n++)a(n);return t},e.prototype.getAll=function(e){return void 0===e&&(e="OBJECT"),"ARRAY"===e?this.texts.array:"OBJECT"==e?this.texts.object:{object:this.texts.object,array:this.texts.array}},e.prototype.getOnly=function(e){for(var t={},a=function(a){i.texts.array.filter(function(t){return t.group===e[a]||t.name===e[a]}).map(function(e){t[e.name]=e})},i=this,n=0;n<e.length;n++)a(n);return t},e.prototype.alignToBottomLeftCorner=function(e,t){if(void 0===t&&(t=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[e],i=this.game;return a.x=t,a.y=i.canvas.height-a.height-t,a},e.prototype.alignToBottomCenter=function(e,t){if(void 0===t&&(t=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[e],i=this.game;return a.x=i.canvas.width/2-a.width/2,a.y=i.canvas.height-a.height-t,a},e.prototype.alignToBottomRightCorner=function(e,t){if(void 0===t&&(t=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[e],i=this.game;return a.x=i.canvas.width-a.width-t,a.y=i.canvas.height-a.height-t,a},e.prototype.alignToCenterRight=function(e,t){if(void 0===t&&(t=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[e],i=this.game;return a.x=i.canvas.width-a.width-t,a.y=i.canvas.height/2-a.height/2,a},e.prototype.alignToTopRightCorner=function(e,t){if(void 0===t&&(t=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[e],i=this.game;return a.x=i.canvas.width-a.width-t,a.y=t,a},e.prototype.alignToTopCenter=function(e,t){if(void 0===t&&(t=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[e],i=this.game;return a.x=i.canvas.width/2-a.width/2-t,a.y=t,a},e.prototype.alignToTopLeftCorner=function(e,t){if(void 0===t&&(t=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[e];this.game;return a.x=t,a.y=t,a},e.prototype.alignToCenterLeft=function(e,t){if(void 0===t&&(t=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[e],i=this.game;return a.x=t,a.y=i.canvas.height/2-a.height/2,a},e.prototype.alignToCenter=function(e,t){if(void 0===t&&(t=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[e],i=this.game;return a.x=i.canvas.width/2-a.width/2,a.y=i.canvas.height/2-a.height/2,a},e.prototype.center=function(e,t,a){if(void 0===t&&(t=0),void 0===a&&(a=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[e],n=this.game;return i.x=n.canvas.width/2-i.width/2+t,i.y=n.canvas.height/2-i.height/2+a,i},e}(),ENEMY_MANAGER=function(){function e(e){this.showHitbox=e.showHitbox}return e.prototype.assign=function(e,t,a,i,n,o,r,s){this.game=e,this.phaserSprites=a,this.phaserMaster=t,this.phaserTexts=i,this.phaserGroup=n,this.weaponManager=o,this.atlas=r,this.atlas_weapons=s},e.prototype.collisionCheck=function(e,t){this.phaserSprites.getManyGroups(["playership"]).map(function(a){a.game.physics.arcade.overlap(e,a,function(e,a){a.takeDamage(t),e.destroyIt()},null,e)})},e.prototype.fireBullet=function(e,t){var a=this;void 0===t&&(t=!1);Phaser.Animation.generateFrameNames("e_bullet",1,1,".png").slice();this.weaponManager.createBullet({name:"enemy_bullet_"+this.game.rnd.integer(),group:"enemy_bullets",x:e.x,y:e.y,spread:0,layer:e.onLayer+1},function(){},function(e){a.collisionCheck(e,2)}).body.velocity.y=300},e.prototype.createSmallEnemy1=function(e,t,a,i,n){var o=this;void 0===t&&(t=function(){}),void 0===a&&(a=function(){}),void 0===i&&(i=function(){}),void 0===n&&(n=function(){});var r=this.game,s=(this.phaserMaster,this.phaserSprites),l=this.phaserGroup,h=this.atlas,p=s.addFromAtlas({x:e.x,name:"enemy_"+r.rnd.integer(),group:"enemies",atlas:h,filename:"small_1.png",visible:!0});p.anchor.setTo(.5,.5),p.scale.setTo(1,1),r.physics.enable(p,Phaser.Physics.ARCADE),p.atTarget=!1,p.maxHealth=100,p.health=p.maxHealth,p.pierceResistence=1,p.fallThreshold=r.rnd.integerInRange(0,75),p.cosWave={data:r.math.sinCosGenerator(400,.8*r.world.height,0,1).cos,count:0},p.sinWave={data:r.math.sinCosGenerator(400,200,1,10).sin,count:0},p.fireDelay=0,p.fireTimer=500,p.inPlace=!1,p.isDestroyed=!1,p.onLayer=e.layer,l.add(e.layer,p),console.log(p.sinWave);return["small_1_hitbox_1.png"].map(function(e){var t=s.addFromAtlas({name:"enemy_hitbox_"+r.rnd.integer(),group:"enemy_hitboxes",atlas:h,filename:e,alpha:o.showHitbox?.75:0});t.anchor.setTo(.5,.5),r.physics.enable(t,Phaser.Physics.ARCADE),p.addChild(t)}),p.damageIt=function(e){t(p),p.atTarget||(p.health-=e,p.tint=16711680,p.game.add.tween(p).to({tint:16777215},100,Phaser.Easing.Linear.Out,!0,0,0,!1),p.health<=0&&p.destroyIt())},p.removeIt=function(){s.destroy(p.name)},p.destroyIt=function(){p.children.map(function(e){o.phaserSprites.destroy(e.name)}),p.isDestroyed||(p.isDestroyed=!0,p.tint=16711680,p.explodeInterval=setInterval(function(){o.weaponManager.createExplosion(p.x+r.rnd.integerInRange(-p.width/2,p.width/2),p.y+r.rnd.integerInRange(-p.height/2,p.height/2),1,p.onLayer+1)},100),p.game.add.tween(p).to({y:p.y-15,alpha:.5},750,Phaser.Easing.Linear.Out,!0,100,0,!1).onComplete.add(function(){clearInterval(p.explodeInterval),a(p),o.weaponManager.createExplosion(p.x,p.y,1,e.layer+1),s.destroy(p.name)}))},p.onUpdate=function(){n(p),r.time.now>p.fireDelay&&p.inPlace&&(p.fireDelay=r.time.now+p.fireTimer,o.fireBullet(p,!0)),p.isDestroyed?p.inPlace=!0:(p.y=-p.cosWave.data[p.cosWave.count]-p.height,p.x=p.sinWave.data[p.sinWave.count]+100,p.cosWave.count++,p.sinWave.count++,p.cosWave.count>=p.cosWave.data.length&&p.removeIt())},p.removeIt=function(){s.destroy(p.name)},p},e.prototype.createBigEnemy1=function(e,t,a,i,n){var o=this;void 0===t&&(t=function(){}),void 0===a&&(a=function(){}),void 0===i&&(i=function(){}),void 0===n&&(n=function(){});var r=this.game,s=(this.phaserMaster,this.phaserSprites),l=this.phaserGroup,h=this.atlas,p=s.addFromAtlas({x:e.x,name:"enemy_"+r.rnd.integer(),group:"enemies",atlas:h,filename:"big_1.png",visible:!0});p.anchor.setTo(.5,.5),p.scale.setTo(1,1),r.physics.enable(p,Phaser.Physics.ARCADE),p.atTarget=!1,p.maxHealth=1500,p.health=p.maxHealth,p.pierceResistence=4,p.fallThreshold=r.rnd.integerInRange(0,75),p.sinWave=r.math.sinCosGenerator(400+e.y,r.world.height/2,1,1),p.count=0,p.fireDelay=0,p.fireTimer=500,p.inPlace=!1,p.isDestroyed=!1,p.onLayer=e.layer,l.add(e.layer,p);return["big_1_hitbox_1.png","big_1_hitbox_2.png"].map(function(e){var t=s.addFromAtlas({name:"enemy_hitbox_"+r.rnd.integer(),group:"enemy_hitboxes",atlas:h,filename:e,alpha:o.showHitbox?.75:0});t.anchor.setTo(.5,.5),r.physics.enable(t,Phaser.Physics.ARCADE),p.addChild(t)}),p.damageIt=function(e){t(p),p.atTarget||(p.health-=e,p.tint=16711680,p.game.add.tween(p).to({tint:16777215},100,Phaser.Easing.Linear.Out,!0,0,0,!1),p.health<=0&&p.destroyIt())},p.removeIt=function(){s.destroy(p.name)},p.destroyIt=function(){p.children.map(function(e){o.phaserSprites.destroy(e.name)}),p.isDestroyed||(p.isDestroyed=!0,p.tint=16711680,p.explodeInterval=setInterval(function(){o.weaponManager.createExplosion(p.x+r.rnd.integerInRange(-p.width/2,p.width/2),p.y+r.rnd.integerInRange(-p.height/2,p.height/2),1,p.onLayer+1)},100),p.game.add.tween(p).to({y:p.y-15,alpha:.5},750,Phaser.Easing.Linear.Out,!0,100,0,!1).onComplete.add(function(){clearInterval(p.explodeInterval),a(p),o.weaponManager.createExplosion(p.x,p.y,1,e.layer+1),s.destroy(p.name)}))},p.onUpdate=function(){n(p),r.time.now>p.fireDelay&&p.inPlace&&(p.fireDelay=r.time.now+p.fireTimer,o.fireBullet(p,!0)),!p.isDestroyed&&p.count<p.sinWave.cos.length/2?(p.y=-p.sinWave.cos[p.count]-p.height,p.count++):p.inPlace=!0},p.removeIt=function(){s.destroy(p.name)},p},e.prototype.createAsteroid=function(e,t,a,i,n){var o=this;void 0===t&&(t=function(){}),void 0===a&&(a=function(){}),void 0===i&&(i=function(){}),void 0===n&&(n=function(){});var r=this.game,s=(this.phaserMaster,this.phaserSprites),l=this.phaserGroup,h=this.atlas,p=s.addFromAtlas({x:e.x,y:e.y,name:"enemy_"+r.rnd.integer(),group:"enemies",atlas:h,filename:"asteroid_mid_layer_"+r.rnd.integerInRange(1,3)+".png",visible:!0});p.anchor.setTo(.5,.5),p.scale.setTo(1.5,1.5),r.physics.enable(p,Phaser.Physics.ARCADE),p.body.velocity.y=e.iy,p.body.velocity.x=e.ix,p.angleMomentum=r.rnd.integerInRange(-5,5),p.body.bounce.setTo(1,1),p.atTarget=!1,p.maxHealth=150,p.health=p.maxHealth,p.pierceResistence=4,p.fallThreshold=r.rnd.integerInRange(0,75),l.add(e.layer,p);return["1_hitbox_1.png","1_hitbox_2.png"].map(function(e){var t=s.addFromAtlas({name:"enemy_hitbox_"+r.rnd.integer(),group:"enemy_hitboxes",atlas:h,filename:e,alpha:o.showHitbox?.75:0});t.anchor.setTo(.5,.5),t.destroyIt=function(e){e.body=null,o.phaserSprites.destroy(e.name)},r.physics.enable(t,Phaser.Physics.ARCADE),p.addChild(t)}),p.damageIt=function(e,a){void 0===a&&(a=null),t(p),p.atTarget||(p.health-=e,p.tint=16711680,p.game.add.tween(p).to({tint:16777215},100,Phaser.Easing.Linear.Out,!0,0,0,!1),p.health<=0&&p.destroyIt())},p.destroyIt=function(){var t={angle:r.rnd.integerInRange(-720,720),x:p.x-r.rnd.integerInRange(-25,25),y:p.y-r.rnd.integerInRange(5,25),alpha:.5};p.game.add.tween(p).to(t,r.rnd.integerInRange(150,500),Phaser.Easing.Linear.Out,!0,0,0,!1),p.body=null,r.time.events.add(Phaser.Timer.SECOND/2,function(){a(p),o.weaponManager.createExplosion(p.x,p.y,1,e.layer+1),s.destroy(p.name)},p).autoDestroy=!0},p.fallToPlanet=function(){p.tint=0,p.atTarget=!0,p.body=null,p.game.add.tween(p).to({y:p.y+60},2*Phaser.Timer.SECOND,Phaser.Easing.Linear.In,!0,0).autoDestroy=!0,setTimeout(function(){o.game.add.tween(p.scale).to({x:0,y:0},1*Phaser.Timer.SECOND,Phaser.Easing.Linear.In,!0,r.rnd.integerInRange(0,500)).onComplete.add(function(){i(p),p.removeIt(),o.weaponManager.createExplosion(p.x,p.y,.25,6)}).autoDestroy=!0},300)},p.checkLocation=function(){p.angle+=p.angleMomentum,p.angleMomentum>0&&(p.angleMomentum-=.002),p.angleMomentum<0&&(p.angleMomentum+=.002),p.y>p.height&&null!==p.body&&(p.body.collideWorldBounds=!0),p.y>o.game.canvas.height-(75+p.fallThreshold)&&(null===p.body||p.atTarget||(p.body.collideWorldBounds=!1,p.fallToPlanet()))},p.onUpdate=function(){n(p),r.physics.arcade.collide([s.get("leftBoundry"),s.get("rightBoundry")],p),p.rotate+=2,p.atTarget||(null!==p.body&&(p.body.velocity.y+2<100&&(p.body.velocity.y+=2),p.body.velocity.x>0&&(p.body.velocity.x-=.2),p.body.velocity.x<0&&(p.body.velocity.x+=.2)),p.checkLocation())},p.removeIt=function(){s.destroy(p.name)},p},e.prototype.createDebris=function(e,t,a,i,n){var o=this;void 0===t&&(t=function(e){}),void 0===a&&(a=function(e){}),void 0===i&&(i=function(e){}),void 0===n&&(n=function(e){});var r=this.game,s=(this.phaserMaster,this.phaserSprites),l=this.phaserGroup,h=this.atlas,p=s.addFromAtlas({x:e.x,y:e.y,name:"enemy_"+r.rnd.integer(),group:"enemies",atlas:h,filename:"asteroid_mid_layer_"+r.rnd.integerInRange(1,3)+".png",visible:!0});p.anchor.setTo(.5,.5),p.scale.setTo(1,1),r.physics.enable(p,Phaser.Physics.ARCADE),p.body.velocity.y=e.iy,p.body.velocity.x=e.ix,p.angleMomentum=r.rnd.integerInRange(-5,5),p.body.bounce.setTo(1,1),p.atTarget=!1,p.maxHealth=50,p.health=p.maxHealth,p.pierceResistence=1,p.fallThrehold=r.rnd.integerInRange(0,75),l.add(e.layer,p),p.damageIt=function(e,t){void 0===t&&(t=null),p.health-=e,p.tint=16711680,p.game.add.tween(p).to({tint:16777215},100,Phaser.Easing.Linear.Out,!0,0,0,!1),p.health<=0&&p.destroyIt(p)},p.removeIt=function(){s.destroy(p.name)},p.fallToPlanet=function(){p.tint=0,p.atTarget=!0,p.body=null,p.game.add.tween(p).to({y:p.y+60},2*Phaser.Timer.SECOND,Phaser.Easing.Linear.In,!0,0).autoDestroy=!0,setTimeout(function(){o.game.add.tween(p.scale).to({x:0,y:0},1*Phaser.Timer.SECOND,Phaser.Easing.Linear.In,!0,r.rnd.integerInRange(0,500)).onComplete.add(function(){i(p),p.removeIt(),o.weaponManager.createExplosion(p.x,p.y,.25,6)}).autoDestroy=!0},300)},p.destroyIt=function(){var e={angle:r.rnd.integerInRange(-720,720),x:p.x-r.rnd.integerInRange(-25,25),y:p.y-r.rnd.integerInRange(5,25),alpha:.5};p.game.add.tween(p).to(e,r.rnd.integerInRange(50,200),Phaser.Easing.Linear.Out,!0,0,0,!1),p.body=null,r.time.events.add(Phaser.Timer.SECOND/3,function(){a(p),o.weaponManager.createExplosion(p.x,p.y,.5,6),s.destroy(p.name)},p).autoDestroy=!0},p.checkLocation=function(){p.angle+=p.angleMomentum,p.angleMomentum>0&&(p.angleMomentum-=.002),p.angleMomentum<0&&(p.angleMomentum+=.002),p.y>p.height&&null!==p.body&&(p.body.collideWorldBounds=!0),p.y>o.game.canvas.height-(50+p.fallThrehold)&&(null===p.body||p.atTarget||(p.body.collideWorldBounds=!1,p.fallToPlanet())),p.y>o.game.canvas.height+p.height&&p.removeIt()},p.onUpdate=function(){r.physics.arcade.collide([s.get("leftBoundry"),s.get("rightBoundry")],p),p.rotate+=4,null!==p.body&&(p.body.velocity.y+1<50&&(p.body.velocity.y+=1),p.body.velocity.x>0&&(p.body.velocity.x-=.2),p.body.velocity.x<0&&(p.body.velocity.x+=.2)),p.checkLocation()}},e.prototype.createGiantAsteroid=function(e,t,a,i,n){var o=this;void 0===t&&(t=function(){}),void 0===a&&(a=function(){}),void 0===i&&(i=function(){}),void 0===n&&(n=function(){});var r=this.game,s=(this.phaserMaster,this.phaserSprites),l=this.phaserGroup,h=this.atlas,p=s.addFromAtlas({x:e.x,y:e.y,name:"enemy_"+r.rnd.integer(),group:"boss",atlas:h,filename:"asteroid_large_layer_"+r.rnd.integerInRange(1,3)+".png",visible:!0});return p.anchor.setTo(.5,.5),r.physics.enable(p,Phaser.Physics.ARCADE),p.body.velocity.y=e.iy,p.body.velocity.x=e.ix,p.angleMomentum=r.rnd.integerInRange(-5,5),p.body.bounce.setTo(1,1),p.atTarget=!1,p.maxHealth=5e3,p.health=p.maxHealth,p.pierceResistence=50,l.add(e.layer,p),p.damageIt=function(e,a){void 0===a&&(a=null),t(p),p.atTarget||(p.health-=e,p.tint=16711680,p.game.add.tween(p).to({tint:16777215},100,Phaser.Easing.Linear.Out,!0,0,0,!1),p.health<=0&&p.destroyIt())},p.destroyIt=function(t){void 0===t&&(t=!0);var i={angle:720,x:p.x-r.rnd.integerInRange(-10,10),y:p.y-r.rnd.integerInRange(10,10),alpha:.15};p.game.add.tween(p).to(i,2*Phaser.Timer.SECOND,Phaser.Easing.Linear.Out,!0,0,0,!1),p.game.add.tween(p.scale).to({x:.5,y:.5},2*Phaser.Timer.SECOND,Phaser.Easing.Linear.Out,!0,0,0,!1),p.body=null,r.time.events.add(Phaser.Timer.SECOND/2,function(){a(p),o.weaponManager.createImpactExplosion(p.x,p.y,2.5,e.layer+1),s.destroy(p.name)},p).autoDestroy=!0},p.fallToPlanet=function(){p.tint=0,p.atTarget=!0,p.body=null,p.game.add.tween(p).to({y:p.y+60},2*Phaser.Timer.SECOND,Phaser.Easing.Linear.In,!0,0).autoDestroy=!0,setTimeout(function(){o.game.add.tween(p.scale).to({x:0,y:0},1*Phaser.Timer.SECOND,Phaser.Easing.Linear.In,!0,r.rnd.integerInRange(0,500)).onComplete.add(function(){i(p),p.removeIt(),o.weaponManager.createExplosion(p.x,p.y,.25,6)}).autoDestroy=!0},300)},p.checkLocation=function(){p.angle+=p.angleMomentum,p.angleMomentum>0&&(p.angleMomentum-=.002),p.angleMomentum<0&&(p.angleMomentum+=.002),p.y>p.height&&null!==p.body&&(p.body.collideWorldBounds=!0),p.y>p.game.canvas.height-p.height&&(null===p.body||p.atTarget||(p.body.collideWorldBounds=!1,p.fallToPlanet()))},p.onUpdate=function(){n(p),r.physics.arcade.collide([s.get("leftBoundry"),s.get("rightBoundry")],p),p.rotate+=2,p.atTarget||(null!==p.body&&(p.body.velocity.y+1<25&&(p.body.velocity.y+=1),p.body.velocity.x>0&&(p.body.velocity.x-=.2),p.body.velocity.x<0&&(p.body.velocity.x+=.2)),p.checkLocation())},p.removeIt=function(){s.destroy(p.name)},p},e}(),PLAYER_MANAGER=function(){function e(){}return e.prototype.assign=function(e,t,a,i,n,o,r,s,l){this.game=e,this.phaserSprites=a,this.phaserMaster=t,this.phaserTexts=i,this.phaserGroup=n,this.phaserControls=o,this.weaponManager=r,this.atlas=s,this.weaponAtlas=l,this.player=null},e.prototype.createShip=function(e,t,a,i){var n=this;void 0===t&&(t=function(){}),void 0===a&&(a=function(){}),void 0===i&&(i=function(){});var o=this.game,r=e.shipId+1,s=(Phaser.Animation.generateFrameNames("ship_"+r+"_shield_",1,6,".png").concat(Phaser.Animation.generateFrameNames("ship_"+r+"_shield_",1,6,".png").reverse()),Phaser.Animation.generateFrameNames("ship_"+r+"_heal_",1,6,".png").concat(Phaser.Animation.generateFrameNames("ship_"+r+"_heal_",1,6,".png").reverse()),this.phaserSprites.addFromAtlas({name:e.name,group:e.group,atlas:this.atlas,filename:"ship_"+r+".png",visible:!1}));return s.anchor.setTo(.5,.5),s.scale.setTo(1,1),s.isInvincible=!1,s.isDead=!1,s.onLayer=e.layer,s.exhaustPoints={center:40,top:25,bottom:50},o.physics.enable(s,Phaser.Physics.ARCADE),this.phaserGroup.add(e.layer,s),this.createShipExhaust(s,e),s.onUpdate=function(){i(s),s.visible&&!s.isDead&&s.createTrail()},s.takeDamage=function(e){var i=n.phaserMaster.getOnly(["gameData"]).gameData.player.health-e;t(i),i>0?(s.tint=16711680,s.alpha=.75,s.game.add.tween(s).to({tint:16777215,alpha:1},100,Phaser.Easing.Linear.Out,!0,100,0,!1).onComplete.add(function(){setTimeout(function(){s.isInvincible=!1},500)})):a(s)},s.isDestroyed=function(){s.isDead=!0,n.weaponManager.createExplosion(s.x,s.y,1,6),o.add.tween(n).to({angle:o.rnd.integerInRange(-90,90),alpha:0},1e3,Phaser.Easing.Linear.In,!0,0).onComplete.add(function(){n.weaponManager.createExplosion(s.x,s.y,1,6),s.visible=!1,setTimeout(function(){t(100),s.moveToStart()},1e3)})},s.createTrail=function(){var t=n.phaserMaster.getState().currentState;if(n.phaserSprites.getGroup(e.name+"_trails").length<("ENDLEVEL"===t)||10){var a=n.phaserSprites.addFromAtlas({name:e.name+"_trail_"+o.rnd.integer(),group:e.name+"_trails",x:s.x,y:s.y,filename:"ship_body.png",atlas:"atlas_main",visible:!0});a.anchor.setTo(.5,.5),a.scale.setTo(s.scale.x-.2,s.scale.y-.2),a.alpha=.4,a.angle=s.angle,a.tint=255,n.phaserGroup.add(e.layer-1,a),a.destroySelf=function(){a.game.add.tween(a).to({alpha:0},"ENDLEVEL"===t?600:250,Phaser.Easing.Linear.In,!0,0).onComplete.add(function(){n.phaserSprites.destroy(a.name)},a)},a.destroySelf()}},s.selfDestruct=function(){s.isInvincible=!0,n.phaserSprites.get("exhaust").destroyIt(),o.add.tween(s).to({angle:720},3400,Phaser.Easing.Linear.In,!0,0).onComplete.add(function(){n.phaserSprites.destroy(s.name),n.weaponManager.createExplosion(s.x,s.y,.5,6)},n)},s.moveToStart=function(){s.isDead=!1,s.angle=0,s.alpha=1,s.visible=!0,s.isInvincible=!0,s.x=n.game.world.centerX,s.y=n.game.world.centerY+550,o.add.tween(s).to({y:o.world.centerY+200},1e3,Phaser.Easing.Exponential.InOut,!0,0,0,!1).onComplete.add(function(){n.phaserControls.enableAllInput(),setTimeout(function(){s.isInvincible=!1},1e3)})},s.fireWeapon=function(){n.phaserSprites.get(e.name+"_ship_weapon").fireWeapon()},s.fireSubweapon=function(){n.phaserSprites.get(e.name+"_ship_subweapon").fireWeapon()},s.regenerateHealth=function(e){void 0===e&&(e=!1)},s.moveX=function(e){s.x+=e,s.checkLimits()},s.moveY=function(e){s.y+=e,s.checkLimits()},s.checkLimits=function(){this.y-this.height<0&&(this.y=this.height),this.y+this.height>this.game.canvas.height&&(this.y=this.game.canvas.height-this.height),this.x<0&&(this.x=this.game.canvas.width+this.width),this.x>this.game.canvas.width+this.width&&(this.x=0)},s.playEndSequence=function(e){s.isInvincible=!0,s.game.add.tween(s.scale).to({x:2,y:2},750,Phaser.Easing.Exponential.InOut,!0,0,0,!1),s.game.add.tween(s).to({x:o.world.centerX,y:o.world.centerY+50},750,Phaser.Easing.Exponential.InOut,!0,0,0,!1).onComplete.add(function(){s.game.add.tween(s).to({y:o.world.height+200},750,Phaser.Easing.Exponential.InOut,!0,100,0,!1).onComplete.add(function(){s.game.add.tween(s).to({y:-200},1e3,Phaser.Easing.Exponential.InOut,!0,0,0,!1).onComplete.add(function(){e()},s)},s)},s)},s.attachPerk=function(t){n.attachPerk(s,e,t)},s.attachWeapon=function(t){n.attachWeaponSprite(s,e,t)},s.attachSubweapon=function(t){n.attachSubWeaponSprite(s,e,t)},this.player=s,s},e.prototype.attachPerk=function(e,t,a){var i,n,o,r=this;switch(a){case"FIREPOWER":i=Phaser.Animation.generateFrameNames("firepower_",1,8,".png").concat(Phaser.Animation.generateFrameNames("firepower_",1,8,".png").reverse()),n=30;break;case"ARMORPLATING":i=["armor_plating.png"],n=30;break;case"REGEN":i=Phaser.Animation.generateFrameNames("shield_layer_",1,8,".png").slice(),n=30}void 0!==this.phaserSprites.get(t.name+"_ship_perk")&&this.phaserSprites.destroy(t.name+"_ship_perk"),"REGEN"===a?((o=this.phaserSprites.addFromAtlas({name:t.name+"_ship_perk",group:t.group,atlas:this.atlas,filename:i[0],alpha:.5})).anchor.setTo(.5,.5),o.scale.set(1.25,1.25),o.tweenFadeIn=function(){r.game.add.tween(o).to({alpha:.8},1e3,Phaser.Easing.Linear.In,!0,8e3).onComplete.add(function(){e.regenerateHealth(!0),o.tweenFadeOut()})},o.tweenFadeOut=function(){r.game.add.tween(o).to({alpha:0},1e3,Phaser.Easing.Linear.In,!0,1e3).onComplete.add(function(){e.regenerateHealth(!1),o.tweenFadeIn()})},setTimeout(function(){void 0!==o&&o.tweenFadeOut()},500),o.animations.add("animate",i,1,!0),o.animations.play("animate",n,!0),e.addChild(o)):((o=this.phaserSprites.addFromAtlas({name:t.name+"_ship_perk",group:t.group,atlas:this.atlas,filename:i[0],visible:!0})).anchor.setTo(.5,.5),o.animations.add("animate",i,1,!0),o.animations.play("animate",n,!0),e.addChild(o))},e.prototype.attachSubWeaponSprite=function(e,t,a){var i,n;switch(a){case"CLUSTERBOMB":i=Phaser.Animation.generateFrameNames("cannon_fire_",1,8,".png").slice(),n=20;break;case"TRIPLEBOMB":i=Phaser.Animation.generateFrameNames("cannon2_fire_",1,7,".png").concat(["cannon2_fire_1.png"]),n=60;break;case"TURRET":i=["turret_base.png"],n=30}void 0!==this.phaserSprites.get(t.name+"_ship_subweapon")&&this.phaserSprites.destroy(t.name+"_ship_subweapon");var o=this.phaserSprites.addFromAtlas({name:t.name+"_ship_subweapon",group:t.group,atlas:this.weaponAtlas,filename:i[0],visible:!0});o.anchor.setTo(.5,.5),o.animations.add("fireWeapon",i,1,!0),o.fireWeapon=function(){o.animations.play("fireWeapon",n,!1)},e.addChild(o)},e.prototype.attachWeaponSprite=function(e,t,a){var i,n;switch(a){case"BULLET":i=Phaser.Animation.generateFrameNames("bullet_fire_",1,4,".png").slice(),n=60;break;case"LASER":i=Phaser.Animation.generateFrameNames("laser_fire_",1,6,".png").slice(),n=60;break;case"MISSLE":i=Phaser.Animation.generateFrameNames("missle_fire_",1,6,".png").slice(),n=30}void 0!==this.phaserSprites.get(t.name+"_ship_weapon")&&this.phaserSprites.destroy(t.name+"_ship_weapon");var o=this.phaserSprites.addFromAtlas({name:t.name+"_ship_weapon",group:t.group,atlas:this.weaponAtlas,filename:i[0],visible:!0});o.anchor.setTo(.5,.5),o.animations.add("fireWeapon",i,1,!0),o.fireWeapon=function(){o.animations.play("fireWeapon",n,!1)},e.addChild(o)},e.prototype.createShipExhaust=function(e,t){var a=this,i=this.phaserSprites.addFromAtlas({name:t.name+"_exhaust",group:t.group,x:e.x,y:e.y+e.height/2+10,atlas:this.atlas,filename:"exhaust_red_1.png",visible:!0});i.animations.add("exhaust_animation",Phaser.Animation.generateFrameNames("exhaust_red_",1,8,".png"),1,!0),i.animations.play("exhaust_animation",30,!0),i.anchor.setTo(.5,.5),e.addChild(i),i.onUpdate=function(){},i.updateCords=function(e,t){},i.destroyIt=function(){a.phaserSprites.destroy(i.name)}},e.prototype.destroyShip=function(e){this.phaserSprites.destroy(e),this.phaserSprites.destroy(e+"_exhaust"),this.phaserSprites.getGroup(e+"_trails").map(function(e){e.destroySelf()})},e}(),UTILITY_MANAGER=function(){function e(){}return e.prototype.assign=function(e,t,a,i,n){this.game=e,this.phaserSprites=t,this.phaserBitmapdata=a,this.phaserGroup=i,this.atlas=n},e.prototype.buildOverlayBackground=function(e,t,a,i){void 0===i&&(i=!1);var n=this.game,o=this.phaserBitmapdata.addGradient({name:"um_overlay__bmd",start:e,end:t,width:5,height:5,render:!1}),r=this.phaserSprites.add({x:0,y:0,name:"um_overlay__bg",width:n.world.width,height:n.world.height,reference:o.cacheBitmapData,visible:i});r.fadeIn=function(e,t){void 0===e&&(e=500),void 0===t&&(t=function(){}),r.visible=!0,r.alpha=0,n.add.tween(r).to({alpha:1},e,Phaser.Easing.Linear.In,!0,0,0,!1).onComplete.add(function(){t()})},r.fadeOut=function(e,t){void 0===e&&(e=500),void 0===t&&(t=function(){}),r.visible=!0,r.alpha=1,n.add.tween(r).to({alpha:0},e,Phaser.Easing.Linear.In,!0,0,0,!1).onComplete.add(function(){t()})},this.phaserGroup.add(a,r)},e.prototype.buildOverlayGrid=function(e,t,a,i){void 0===e&&(e=80),void 0===t&&(t=80);for(var n=this.game,o=0,r=0;r<Math.ceil(n.world.height/t)+1;r++)for(var s=function(s){var h=l.phaserSprites.addFromAtlas({x:s*e,y:r*t,name:"grid"+o,group:"um_grid__bg",width:e,height:t,atlas:l.atlas,filename:i,visible:!0});h.anchor.setTo(.5,.5),h.scale.setTo(1,1),h.fadeOut=function(e){h.scale.setTo(1,1),n.add.tween(h).to({height:0},e,Phaser.Easing.Linear.Out,!0,0,0,!1)},h.fadeIn=function(e){n.add.tween(h).to({height:t},e,Phaser.Easing.Linear.In,!0,0,0,!1)},h.scaleOut=function(e){n.add.tween(h.scale).to({x:0,y:0},e,Phaser.Easing.Linear.In,!0,0,0,!1)},h.scaleIn=function(e){n.add.tween(h.scale).to({x:1,y:1},e,Phaser.Easing.Linear.Out,!0,0,0,!1)},o++,l.phaserGroup.add(a,h)},l=this,h=0;h<Math.ceil(n.world.width/e)+1;h++)s(h)},e.prototype.overlayBGControls=function(e,t){var a=e.transition,i=e.delay,n=e.speed,o=this.phaserSprites.getOnly(["um_overlay__bg"]).um_overlay__bg;setTimeout(function(){switch(a){case"FADEIN":o.fadeIn(n,t);break;case"FADEOUT":o.fadeOut(n,t)}},i)},e.prototype.overlayControls=function(e,t){var a=e.transition,i=e.delay,n=e.speed,o=e.tileDelay,r=this.phaserSprites.getGroup("um_grid__bg"),s=[],l=[],h=o*r.length*.75,p=h+o*r.length;setTimeout(function(){switch(a){case"WIPEIN":r.map(function(e,t){t%2==0?l.push(e):s.push(e)}),l.map(function(e,t){setTimeout(function(){e.scaleIn(n)},o*t)}),setTimeout(function(){s.slice(0).reverse().map(function(e,t){setTimeout(function(){e.scaleIn(n)},o*t)})},h),setTimeout(function(){t()},p);break;case"WIPEOUT":r.map(function(e,t){t%2==0?l.push(e):s.push(e)}),l.map(function(e,t){setTimeout(function(){e.scaleOut(n)},o*t)}),setTimeout(function(){s.slice(0).reverse().map(function(e,t){setTimeout(function(){e.scaleOut(n)},o*t)})},h),setTimeout(function(){t()},p);break;case"FADEOUT":r.map(function(e,t){setTimeout(function(){e.fadeOut(n)},o*t)}),setTimeout(function(){t()},r.length*o+n);break;case"FADEIN":r.map(function(e,t){setTimeout(function(){e.fadeIn(n)},o*t)}),setTimeout(function(){t()},r.length*o+n)}},i)},e}(),WEAPON_MANAGER=function(){function e(){}return e.prototype.assign=function(e,t,a,i,n){this.game=e,this.phaserSprites=a,this.phaserMaster=t,this.phaserGroup=i,this.atlas=n},e.prototype.createBullet=function(e,t,a){var i=this;void 0===t&&(t=function(){}),void 0===a&&(a=function(){});var n=this.game,o=this.phaserMaster,r=this.phaserSprites,s=this.phaserGroup,l=this.atlas,h=o.getAll().weaponData.primaryWeapons.BULLET,p=r.addFromAtlas({x:e.x,y:e.y,name:e.name,group:e.group,atlas:l,filename:h.spriteAnimation[0]});return h.spriteAnimation.length>1&&(p.animations.add("animate",h.spriteAnimation,1,!0),p.animations.play("animate",30,!0)),p.anchor.setTo(.5,.5),n.physics.enable(p,Phaser.Physics.ARCADE),p.body.velocity.y=h.initialVelocity,p.pierceStrength=h.pierceStrength,p.damageAmount=h.damage,p.destroyIt=function(){i.orangeImpact(p.x+i.game.rnd.integerInRange(-5,5),p.y+i.game.rnd.integerInRange(-5,15),1,e.layer+1),t(p),r.destroy(p.name)},p.onUpdate=function(){(this.y<-this.height||this.y>this.game.canvas.height)&&this.destroyIt(),a(p)},void 0!==e.layer&&s.add(e.layer,p),p},e.prototype.createMissle=function(e,t,a){void 0===t&&(t=function(){}),void 0===a&&(a=function(){});var i=this.game,n=this.phaserMaster,o=this.phaserSprites,r=this.phaserGroup,s=this.atlas,l=n.getAll().weaponData.primaryWeapons.MISSLE,h=o.addFromAtlas({x:e.x,y:e.y,name:e.name,group:e.group,atlas:s,filename:l.spriteAnimation[0]});return l.spriteAnimation.length>1&&(h.animations.add("animate",l.spriteAnimation,1,!0),h.animations.play("animate",30,!0)),h.anchor.setTo(.5,.5),i.physics.enable(h,Phaser.Physics.ARCADE),h.body.velocity.y=l.initialVelocity,h.isActive=!0,h.pierceStrength=l.pierceStrength,h.damageAmount=l.damage,h.accelerate=function(){null!==h.body&&(h.body.velocity.y-=l.velocity,h.body.velocity.x+=e.spread)},h.removeIt=function(){h.isActive=!1,o.destroy(h.name)},h.destroyIt=function(){t(h),h.isActive=!1,o.destroy(h.name)},h.onUpdate=function(){h.accelerate(),h.y<-h.height&&h.removeIt(),a(h)},void 0!==e.layer&&r.add(e.layer,h),h},e.prototype.createLaser=function(e,t,a){var i=this;void 0===t&&(t=function(){}),void 0===a&&(a=function(){});var n=this.game,o=this.phaserMaster,r=this.phaserSprites,s=this.phaserGroup,l=this.atlas,h=o.getAll().weaponData.primaryWeapons.LASER,p=r.addFromAtlas({x:e.x,y:e.y,name:e.name,group:e.group,atlas:l,filename:h.spriteAnimation[0]});return h.spriteAnimation.length>1&&(p.animations.add("animate",h.spriteAnimation,1,!0),p.animations.play("animate",30,!0)),p.anchor.setTo(.5,.5),n.physics.enable(p,Phaser.Physics.ARCADE),p.body.velocity.y=h.initialVelocity,p.pierceStrength=h.pierceStrength,p.damageAmount=h.damage,p.accelerate=function(){null!==p.body&&(p.body.velocity.y-=h.velocity,p.body.velocity.x+=e.spread)},p.destroyIt=function(){i.electricDischarge(p.x+i.game.rnd.integerInRange(-5,5),p.y+i.game.rnd.integerInRange(-5,15),1,e.layer+1),t(p),r.destroy(p.name)},p.onUpdate=function(){p.accelerate(),p.y<-p.height&&p.destroyIt(),a(p)},void 0!==e.layer&&s.add(e.layer,p),p},e.prototype.createClusterbomb=function(e,t,a){var i=this;void 0===t&&(t=function(){}),void 0===a&&(a=function(){});var n=this.game,o=this.phaserMaster,r=this.phaserSprites,s=this.phaserGroup,l=this.atlas,h=o.getAll().weaponData.secondaryWeapons.CLUSTERBOMB,p=r.addFromAtlas({x:e.x,y:e.y,name:e.name,group:e.group,atlas:l,filename:h.spriteAnimation[0]});return h.spriteAnimation.length>1&&(p.animations.add("animate",h.spriteAnimation,1,!0),p.animations.play("animate",30,!0)),n.physics.enable(p,Phaser.Physics.ARCADE),p.anchor.setTo(.5,.5),p.body.velocity.y=h.initialVelocity,p.angle=90,p.hasDetonated=!1,p.bomblets=h.bomblets,p.pierceStrength=h.pierceStrength,p.damageAmount=h.damage,setTimeout(function(){p.hasDetonated||(p.hasDetonated=!0,p.destroyIt())},800),p.accelerate=function(){null!==p.body&&(p.body.velocity.y>-400&&(p.body.velocity.y-=h.velocity),p.body.velocity.x+=e.spread)},p.destroyIt=function(){t(p),i.createExplosion(p.x,p.y,1.25,e.layer),r.destroy(p.name)},p.onUpdate=function(){a(p),p.angle+=5,p.accelerate(),p.y<-p.height&&p.destroyIt()},void 0!==e.layer&&s.add(e.layer,p),p},e.prototype.createTriplebomb=function(e,t,a){var i=this;void 0===t&&(t=function(){}),void 0===a&&(a=function(){});var n=this.game,o=this.phaserMaster,r=this.phaserSprites,s=this.phaserGroup,l=this.atlas,h=o.getAll().weaponData.secondaryWeapons.TRIPLEBOMB,p=r.addFromAtlas({x:e.x,y:e.y,name:e.name,group:e.group,atlas:l,filename:h.spriteAnimation[0]});return h.spriteAnimation.length>1&&(p.animations.add("animate",h.spriteAnimation,1,!0),p.animations.play("animate",30,!0)),n.physics.enable(p,Phaser.Physics.ARCADE),p.anchor.setTo(.5,.5),p.body.velocity.y=h.initialVelocity,p.angle=90,p.hasDetonated=!1,p.damageAmount=h.damage,p.pierceStrength=h.pierceStrength,p.accelerate=function(){null!==p.body&&(p.body.velocity.y>-500&&(p.body.velocity.y-=h.velocity),p.body.velocity.x+=e.spread)},p.removeIt=function(){t(p),r.destroy(p.name)},p.destroyIt=function(){t(p),i.createExplosion(p.x,p.y,1.25,e.layer),r.destroy(p.name)},p.onUpdate=function(){a(p),p.angle+=15,p.accelerate(),p.y<-p.height&&p.removeIt()},void 0!==e.layer&&s.add(e.layer,p),p},e.prototype.createTurret=function(e,t,a,i){var n=this;void 0===t&&(t=function(){}),void 0===a&&(a=function(){}),void 0===i&&(i=function(){});var o=this.game,r=this.phaserMaster,s=this.phaserSprites,l=this.phaserGroup,h=this.atlas,p=r.getAll().weaponData.secondaryWeapons.TURRET,c=s.addFromAtlas({x:e.x,y:e.y,name:e.name,group:e.group,atlas:h,filename:p.spriteAnimation[0]});p.spriteAnimation.length>1&&(c.animations.add("animate",p.spriteAnimation,1,!0),c.animations.play("animate",30,!0)),c.anchor.setTo(.5,.5),o.physics.enable(c,Phaser.Physics.ARCADE),l.add(2,c),c.offset=e.offset,setTimeout(function(){void 0!==c&&c.destroyIt()},p.lifespan),t(c),c.destroyIt=function(){void 0!==c&&(a(c),n.createExplosion(c.x,c.y,.5,e.layer),clearInterval(c.fireInterval),s.destroy(c.name))},c.onUpdate=function(){i(c)},void 0!==e.layer&&l.add(e.layer,c)},e.prototype.createBlastradius=function(e){var t=this.game,a=this.phaserMaster,i=this.phaserSprites,n=this.phaserGroup,o=this.atlas,r=a.getAll().weaponData.secondaryWeapons.BLASTRADIUS,s=i.addFromAtlas({x:e.x,y:e.y,name:e.name,group:e.group,atlas:o,filename:r.spriteAnimation[0]});if(s.anchor.setTo(.5,.5),s.scale.setTo(1,1),r.spriteAnimation.length>1){var l=s.animations.add("animate",r.spriteAnimation,30,!1);l.onStart.add(function(){},s),l.onComplete.add(function(){i.destroy(s.name)},s),l.play("animate")}t.physics.enable(s,Phaser.Physics.ARCADE),void 0!==e.layer&&n.add(e.layer,s)},e.prototype.createBomblet=function(e,t,a){var i=this;void 0===t&&(t=function(){}),void 0===a&&(a=function(){});var n=this.game,o=(this.phaserMaster,this.phaserSprites),r=this.phaserGroup,s=this.atlas,l=o.addFromAtlas({x:e.x,y:e.y,name:"bomblet_"+n.rnd.integer(),group:e.group,atlas:s,filename:"clusterBomb.png"});return l.anchor.setTo(.5,.5),l.scale.setTo(.5,.5),n.physics.enable(l,Phaser.Physics.ARCADE),l.body.velocity.y=e.iy,l.body.velocity.x=e.ix,l.detonate=n.time.now+n.rnd.integerInRange(1250,1800),l.pierceStrength=1,l.damageAmount=100,l.destroyIt=function(){t(l),i.createExplosion(l.x,l.y,1,e.layer),o.destroy(l.name)},l.onUpdate=function(){a(l),l.angle+=5,n.time.now>l.detonate&&l.destroyIt()},void 0!==e.layer&&r.add(e.layer,l,e.layer),l},e.prototype.createExplosion=function(e,t,a,i,n,o){void 0===n&&(n=function(){}),void 0===o&&(o=function(){});var r=this.game,s=(this.phaserMaster,this.phaserSprites),l=this.phaserGroup,h=this.atlas,p=s.addFromAtlas({name:"explosion_"+r.rnd.integer(),group:"explosions",x:e,y:t,atlas:h,filename:"explosion2_layer_1.png"});return p.scale.setTo(a,a),p.anchor.setTo(.5,.5),p.animations.add("explosion",Phaser.Animation.generateFrameNames("explosion2_layer_",1,12,".png"),1,!0),p.animations.play("explosion",30,!0),r.time.events.add(Phaser.Timer.SECOND/2,function(){s.destroy(p.name)}).autoDestroy=!0,p.onDestroy=function(){},p.onUpdate=function(){o(p)},void 0!==i&&l.add(i,p),p},e.prototype.createImpactExplosion=function(e,t,a,i,n,o,r){void 0===o&&(o=function(){}),void 0===r&&(r=function(){});var s=this.game,l=(this.phaserMaster,this.phaserSprites),h=this.phaserGroup,p=this.atlas,c=l.addFromAtlas({name:"impact_"+s.rnd.integer(),group:"impactExplosions",x:e,y:t,atlas:p,filename:"explosions_Layer_1.png"});return c.scale.setTo(a,a),c.anchor.setTo(.5,.5),s.physics.enable(c,Phaser.Physics.ARCADE),c.animations.add("explosion",Phaser.Animation.generateFrameNames("explosions_Layer_",1,16,".png"),1,!0),c.animations.play("explosion",30,!0),c.damageAmount=n,s.time.events.add(Phaser.Timer.SECOND/2,function(){l.destroy(c.name)}).autoDestroy=!0,c.onDestroy=function(){},c.onUpdate=function(){r(c)},void 0!==i&&h.add(i,c),c},e.prototype.blueImpact=function(e,t,a,i){var n=this.game,o=(this.phaserMaster,this.phaserSprites),r=this.phaserGroup,s=this.atlas,l=Phaser.Animation.generateFrameNames("blue_explosion_small_layer_",1,7,".png"),h=o.addFromAtlas({name:"impact_"+n.rnd.integer(),group:"impactExplosions",x:e,y:t,atlas:s,filename:l[0]});h.scale.setTo(a,a),h.anchor.setTo(.5,.5),n.physics.enable(h,Phaser.Physics.ARCADE);var p=h.animations.add("animate",l,60,!1);return p.onStart.add(function(){},h),p.onComplete.add(function(){o.destroy(h.name)},h),p.play("animate"),h.onUpdate=function(){h.y--},void 0!==i&&r.add(i,h),h},e.prototype.orangeImpact=function(e,t,a,i){var n=this.game,o=(this.phaserMaster,this.phaserSprites),r=this.phaserGroup,s=this.atlas,l=Phaser.Animation.generateFrameNames("orange_ring_explosion_layer_",1,7,".png"),h=o.addFromAtlas({name:"impact_"+n.rnd.integer(),group:"impactExplosions",x:e,y:t,atlas:s,filename:l[0]});h.scale.setTo(a,a),h.anchor.setTo(.5,.5),n.physics.enable(h,Phaser.Physics.ARCADE);var p=h.animations.add("animate",l,60,!1);return p.onStart.add(function(){},h),p.onComplete.add(function(){o.destroy(h.name)},h),p.play("animate"),h.onUpdate=function(){h.y--},void 0!==i&&r.add(i,h),h},e.prototype.electricDischarge=function(e,t,a,i){var n=this.game,o=(this.phaserMaster,this.phaserSprites),r=this.phaserGroup,s=this.atlas,l=Phaser.Animation.generateFrameNames("disintegrate",1,10,".png"),h=o.addFromAtlas({name:"impact_"+n.rnd.integer(),group:"impactExplosions",x:e,y:t,atlas:s,filename:l[0]});h.scale.setTo(a,a),h.anchor.setTo(.5,.5),n.physics.enable(h,Phaser.Physics.ARCADE);var p=h.animations.add("animate",l,60,!1);return p.onStart.add(function(){},h),p.onComplete.add(function(){o.destroy(h.name)},h),p.play("animate"),h.onUpdate=function(){h.y--},void 0!==i&&r.add(i,h),h},e}();