var PhaserGameObject=function(){function t(){this.game=null,this.global={pause:!1}}return t.prototype.init=function(t,e,i){var a=new PHASER_MASTER({game:new Phaser.Game(i.width,i.height,Phaser.WEBGL,t,{preload:function(){var t=a.game();t.load.enableParallel=!0,t.stage.backgroundColor="#2f2f2f";var e="src/phaser/saveTheWorld/resources";t.load.atlas("atlas",e+"/spritesheets/heroSelect/heroSelectAtlas.png",e+"/spritesheets/heroSelect/heroSelectAtlas.json",Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),t.load.atlas("atlas_main",e+"/spritesheets/main/main.png",e+"/spritesheets/main/main.json",Phaser.Loader.TEXTURE_atlas_main_JSON_HASH),t.load.atlas("atlas_weapons",e+"/spritesheets/weapons/weaponsAtlas.png",e+"/spritesheets/weapons/weaponsAtlas.json",Phaser.Loader.TEXTURE_atlas_main_JSON_HASH),t.load.bitmapFont("gem",e+"/fonts/gem.png",e+"/fonts/gem.xml"),t.load.json("weaponData",e+"/json/weaponData.json"),t.load.json("pilotData",e+"/json/pilotData.json"),a.changeState("PRELOAD"),new PHASER_PRELOADER({game:t,delayInSeconds:0,done:function(){!function(){a.game();var t=r.getAll("OBJECT").pointer,e=a.getAll().currentSelection;t.updateLocation(e),m(),v(0),g("FADEOUT",function(){a.changeState("MAINMENU")})}()}})},create:function(){var t=this,e=a.game();o.assign(e),n.assign(e),r.assign(e),s.assign(e),l.assign(e),p.assign(e),h.assign(e,20),u.assign(e),c.assign(e,a,r,h,"atlas_weapons");a.let("currentSelection",0);for(var i=a.let("pilotSelection",0),d=(a.let("loadoutSelection",0),a.let("primaryWeaponSelection",0),a.let("subWeaponSelection",0),a.let("perkSelection",0),a.let("weaponData",e.cache.getJSON("weaponData"))),y=a.let("pilotData",e.cache.getJSON("pilotData")),g=this.game.world.width-240,f=this.game.world.height/2,m=r.addFromAtlas({x:g,y:0,height:e.world.height,name:"verticleFrame",group:"ui_frame",filename:"ui_frame_v.png",atlas:"atlas"}),b=r.addFromAtlas({x:0,y:f,width:m.x,name:"dividerFrame1",group:"ui_frame",filename:"ui_frame_h.png",atlas:"atlas"}),x=u.addGradient({name:"overlayFadeout",start:"#ffffff",end:"#ffffff",width:1,height:1,render:!1}),w=r.add({x:0,y:0,name:"container_1",width:g,height:f,reference:x.cacheBitmapData,visible:!1}),T=r.add({x:0,y:325,name:"container_2",width:g,height:f,reference:x.cacheBitmapData,visible:!1}),_=r.add({x:g,y:0,name:"container_3",width:e.world.width-g,height:e.world.height,reference:x.cacheBitmapData,visible:!1}),E=r.addBasicMaskToSprite(w),S=0,R=0;R<Math.ceil(e.world.height/80);R++)for(var D=function(e){var i=r.addFromAtlas({x:80*R,y:80*e,name:"grid"+S,group:"grids",width:80,height:80,atlas:"atlas",filename:"ui_textbox.png",visible:!0});i.anchor.setTo(.5,.5),i.x=i.x+=i.width/2,i.y=i.y+=i.height/2,i.fadeOut=function(e){t.game.add.tween(i).to({height:0},e,Phaser.Easing.Linear.Out,!0,0,0,!1)},i.fadeIn=function(e){t.game.add.tween(i).to({height:80},e,Phaser.Easing.Linear.In,!0,0,0,!1)},S++,h.add(20,i)},B=0;B<Math.ceil(e.world.width/80);B++)D(B);var P=r.addTilespriteFromAtlas({name:"bg_clouds",group:"ui_bg",x:w.x,y:w.y,width:w.width,height:w.height,atlas:"atlas",filename:"bg_clouds.png"});P.mask=E,P.onUpdate=function(){0===a.get("currentSelection")&&(this.tilePosition.x-=3)};var L=r.addTilespriteFromAtlas({name:"bg_cityscape",group:"ui_bg",x:T.x,y:T.y,width:T.width,height:T.height,atlas:"atlas",filename:"bg_cityscape.png"});L.onUpdate=function(){1===a.get("currentSelection")&&(this.tilePosition.x-=.25)};var I=r.addTilespriteFromAtlas({name:"bg_cityscape_1",group:"ui_bg",x:T.x,y:T.y+50,width:T.width,height:T.height,atlas:"atlas",filename:"bg_cityscape_1.png"});I.onUpdate=function(){1===a.get("currentSelection")&&(this.tilePosition.x-=.5)};var O=r.addTilespriteFromAtlas({name:"bg_cityscape_2",group:"ui_bg",x:T.x,y:T.y+115,width:T.width,height:T.height,atlas:"atlas",filename:"bg_cityscape_2.png"});O.onUpdate=function(){1===a.get("currentSelection")&&(this.tilePosition.x-=1)};var C=r.addTilespriteFromAtlas({name:"bg_cityscape_3",group:"ui_bg",x:T.x,y:T.y+200,width:T.width,height:T.height,atlas:"atlas",filename:"bg_cityscape_3.png"});C.onUpdate=function(){1===a.get("currentSelection")&&(this.tilePosition.x-=2)};var k=r.addTilespriteFromAtlas({name:"bg_space",group:"ui_bg",x:_.x,y:_.y,width:_.width,height:_.height,atlas:"atlas",filename:"bg_space.png"});k.onUpdate=function(){2===a.get("currentSelection")?this.tilePosition.y+=2:this.tilePosition.y+=.1};var M=r.addFromAtlas({name:"pointer",group:"ui",atlas:"atlas",filename:"ui_pointer.png"});M.anchor.setTo(.5,.5),M.hide=function(){this.visible=!1},M.show=function(){this.visible=!0},M.updateLocation=function(t){a.forceLet("currentSelection",t);var e=r.get("textbox"+t),i=e.x,o=e.y;this.x=i-90,this.y=o};var U=r.addFromAtlas({name:"downarrow",group:"ui",atlas:"atlas",filename:"ui_downarrow.png",visible:!1});U.anchor.setTo(.5,.5),U.hide=function(){this.visible=!1},U.show=function(){this.visible=!0},U.updateLocation=function(t,e){this.x=t,this.y=e};var j=r.addFromAtlas({name:"textbox0",group:"ui_textholders",atlas:"atlas",filename:"ui_textbox.png",alpha:1});j.anchor.setTo(.5,.5),r.centerOnPoint("textbox0",w.width/2+j.width/2,w.y+40);var W=l.add({name:"text0",group:"ui_text",x:j.x,y:j.y,font:"gem",size:12,default:"SELECT PILOT"});W.anchor.setTo(.5,.5);var N=r.addFromAtlas({name:"textbox1",group:"ui_textholders",atlas:"atlas",filename:"ui_textbox.png",alpha:1});N.anchor.setTo(.5,.5),r.centerOnPoint("textbox1",T.width/2+N.width/2,T.y+50);var G=l.add({name:"text1",group:"ui_text",x:N.x,y:N.y,font:"gem",size:12,default:"LOADOUT"});G.anchor.setTo(.5,.5);var F=r.addFromAtlas({name:"textbox2",group:"ui_textholders",atlas:"atlas",filename:"ui_textbox.png",alpha:1});F.anchor.setTo(.5,.5),r.centerOnPoint("textbox2",_.x+_.width/2+F.width/2,_.y+40);var H=l.add({name:"text2",group:"ui_text",x:F.x,y:F.y,font:"gem",size:12,default:"START"});H.anchor.setTo(.5,.5);var K=r.addFromAtlas({name:"pilotDescriptionBox",group:"ui_textholders",atlas:"atlas",filename:"ui_descriptionbox.png",alpha:1});K.anchor.setTo(.5,.5),r.centerOnPoint("pilotDescriptionBox",w.width/2+K.width/2,w.y+295);var J=l.add({name:"pilotDescriptionText",group:"ui_text",x:K.x-K.width/2+20,y:K.y-K.height/2,font:"gem",size:14,default:""});J.maxWidth=K.width-40,J.updateThisText=function(t){this.setText("\nNAME:               "+Y[t].name+"\n\nFIRING RATE:        "+Y[t].firerate+"\nSUBWEAPON RECHARGE: "+Y[t].subweaponRecharge+"\nHEALTH:             "+Y[t].health+"\nMOVEMENT:           "+Y[t].movement+"\n              ")},h.addMany(18,[j,N,F,K]),h.addMany(19,[W,G,H,J]);for(var Y=y.pilots,X=0;X<Y.length;X++){var z=r.addFromAtlas({name:"profile"+X,group:"ui_profiles",y:w.y+110,atlas:"atlas",filename:""+Y[X].image,alpha:0});z.anchor.setTo(.5,.5);var V=z.width/2*(Y.length-1);z.x=w.x+X*z.width+w.width/2-V,z.alpha=1,h.add(18,z)}var Q,q=r.addFromAtlas({name:"profileSelector",group:"ui_profiles",atlas:"atlas",filename:"ui_pictureframe.png",alpha:0});q.anchor.setTo(.5,.5),q.updateLocation=function(t){a.forceLet("pilotSelection",t),r.getGroup("ui_profiles").forEach(function(t){t.alpha=.85});var e=r.get("profile"+t);e.alpha=1;var i=e.x,o=e.y;this.x=i,this.y=o,U.updateLocation(i,o-e.height/2-8)},q.inc=function(){(i+=1)>Y.length-1&&(i=0),v(i)},q.dec=function(){(i-=1)<0&&(i=Y.length-1),v(i)},h.add(19,q);var Z=[],$=[],tt=[];Q=0;for(var et=0,it=Object.keys(d.primaryWeapons);et<it.length;et++){var at=it[et],ot=5,nt=d.primaryWeapons[at],rt=r.addFromAtlas({name:"box_pw_"+Q,group:"ui_loadout",y:T.y+90,atlas:"atlas",filename:"ui_box_unselected.png",alpha:0});rt.anchor.setTo(.5,.5);var V=(rt.width+ot)/2*(A(d.primaryWeapons)-1);rt.x=T.x+Q*rt.width+T.width/2-V+Q*ot,rt.alpha=1;var st=r.addFromAtlas({name:"sbox_pw_"+Q,group:"ui_box_selected",y:T.y+90,atlas:"atlas",filename:"ui_box_selected.png",alpha:0});st.anchor.setTo(.5,.5),st.x=T.x+Q*st.width+T.width/2-V+Q*ot,st.alpha=0;var lt=r.addFromAtlas({name:"icon_pw_"+Q,group:"ui_loadout",y:T.y+90,atlas:"atlas_weapons",filename:""+nt.spriteIcon,alpha:1});lt.anchor.setTo(.5,.5),lt.x=T.x+Q*st.width+T.width/2-V+Q*ot,Z.push(nt),Q++,h.addMany(18,[rt,st]),h.add(19,lt)}Q=0;for(var pt=0,ht=Object.keys(d.secondaryWeapons);pt<ht.length;pt++){var at=ht[pt],ot=5,nt=d.secondaryWeapons[at],rt=r.addFromAtlas({name:"box_sw_"+Q,group:"ui_loadout",y:T.y+140,atlas:"atlas",filename:"ui_box_unselected.png",alpha:0});rt.anchor.setTo(.5,.5);var V=(rt.width+ot)/2*(A(d.secondaryWeapons)-1);rt.x=T.x+Q*rt.width+T.width/2-V+Q*ot,rt.alpha=1;var st=r.addFromAtlas({name:"sbox_sw_"+Q,group:"ui_box_selected",y:T.y+140,atlas:"atlas",filename:"ui_box_selected.png",alpha:0});st.anchor.setTo(.5,.5),st.x=T.x+Q*st.width+T.width/2-V+Q*ot,st.alpha=0;var lt=r.addFromAtlas({name:"icon_sw_"+Q,group:"ui_loadout",y:T.y+140,atlas:"atlas_weapons",filename:""+nt.spriteIcon,alpha:1});lt.anchor.setTo(.5,.5),lt.x=T.x+Q*st.width+T.width/2-V+Q*ot,$.push(nt),Q++,h.addMany(18,[rt,st]),h.add(19,lt)}Q=0;for(var ut=0,ct=Object.keys(d.perks);ut<ct.length;ut++){var at=ct[ut],ot=5,nt=d.perks[at],rt=r.addFromAtlas({name:"box_sp_"+Q,group:"ui_loadout",y:T.y+190,atlas:"atlas",filename:"ui_box_unselected.png",alpha:0});rt.anchor.setTo(.5,.5);var V=(rt.width+ot)/2*(A(d.perks)-1);rt.x=T.x+Q*rt.width+T.width/2-V+Q*ot,rt.alpha=1;var st=r.addFromAtlas({name:"sbox_sp_"+Q,group:"ui_box_selected",y:T.y+190,atlas:"atlas",filename:"ui_box_selected.png",alpha:0});st.anchor.setTo(.5,.5),st.x=T.x+Q*st.width+T.width/2-V+Q*ot,st.alpha=0;var lt=r.addFromAtlas({name:"icon_sp_"+Q,group:"ui_loadout",y:T.y+190,atlas:"atlas_weapons",filename:""+nt.spriteIcon,alpha:1});lt.anchor.setTo(.5,.5),lt.x=T.x+Q*st.width+T.width/2-V+Q*ot,tt.push(nt),Q++,h.addMany(18,[rt,st]),h.add(19,lt)}a.let("primaryWeaponList",Z),a.let("secondaryWeaponList",$),a.let("perkList",tt);var dt=r.addFromAtlas({name:"loadoutCatagorySelector",group:"ui_loadout",atlas:"atlas",filename:"ui_pointer.png",visible:!1,alpha:0});dt.anchor.setTo(.5,.5),dt.show=function(){this.visible=!0},dt.hide=function(){this.visible=!1},dt.updateLocation=function(t){var e,i=a.getAll(),o=i.primaryWeaponSelection,n=i.subWeaponSelection,s=i.perkSelection;if(0===t){var l=(e=r.get("box_pw_"+o)).x,p=e.y;U.updateLocation(l,p-30)}if(1===t){var h=(e=r.get("box_sw_"+n)).x,u=e.y;U.updateLocation(h,u-30)}if(2===t){var c=(e=r.get("box_sp_"+s)).x,d=e.y;U.updateLocation(c,d-30)}e.x;var y=e.y;this.x=40,this.y=y,this.visible};var yt=r.addFromAtlas({name:"loadoutDescription",group:"ui_textholders",atlas:"atlas",filename:"ui_descriptionbox_small.png",visible:!1});yt.anchor.setTo(.5,.5),r.centerOnPoint("loadoutDescription",T.width/2+yt.width/2,T.y+310);var gt=l.add({name:"loadoutDescriptionText",group:"ui_text",x:yt.x,y:yt.y,font:"gem",size:14,default:""});gt.anchor.setTo(.5,.5),gt.maxWidth=yt.width-40,h.add(18,yt),h.add(19,gt);var ft=r.addFromAtlas({name:"ship",group:"ship_preview",atlas:"atlas_main",filename:"ship_body.png",visible:!0});ft.anchor.setTo(.5,.5),r.centerOnPoint("ship",_.x+_.width/2+ft.width/2,_.height-100);var mt=r.addFromAtlas({name:"exhaust",group:"ship_preview",atlas:"atlas_main",filename:"exhaust_red_1.png",visible:!0});mt.animations.add("exhaust_animation",Phaser.Animation.generateFrameNames("exhaust_red_",1,8,".png"),1,!0),mt.animations.play("exhaust_animation",30,!0),mt.anchor.setTo(.5,.5),mt.onUpdate=function(){var t=ft.x,e=ft.y;this.visible=!0,this.x=t,2===a.get("currentSelection")?(this.y=e+40,this.scale.setTo(1,1)):(this.y=e+25,this.scale.setTo(1,.25))},h.addMany(1,[k]),h.addMany(5,[ft,mt]),h.addMany(6,[P,L,I,O,C]),h.addMany(10,[m,b]),h.addMany(15,[M,U])},update:function(){a.game();var t=a.getAll(),i=t.currentSelection,n=(t.pilotSelection,t.loadoutSelection),s=t.primaryWeaponList,p=t.primaryWeaponSelection,h=t.secondaryWeaponList,u=t.subWeaponSelection,c=r.getAll("OBJECT"),m=c.profileSelector,v=c.loadoutCatagorySelector,A=c.pointer,w=c.downarrow,T=c.loadoutDescription,_=l.getAll("OBJECT").loadoutDescriptionText;r.getManyGroups(["ui_bg","ship_preview","ship_wpn_preview"]).forEach(function(t){t.onUpdate()}),o.checkWithDelay({isActive:!0,key:"BACK",delay:250})&&2===i&&A.updateLocation(0);o.checkWithDelay({isActive:!0,key:"START",delay:250})&&(2!==i&&(a.forceLet("loadoutSelection",0),A.show(),w.hide(),T.hide(),_.hide(),v.hide(),a.changeState("MAINMENU"),A.updateLocation(2)),2===i&&(A.hide(),a.forceLet("currentSelection",null),g("FADEIN",function(){var t,i,o,n,r,s,l,p;t=a.getAll(),i=t.primaryWeaponList,o=t.primaryWeaponSelection,t.loadoutSelection,n=t.secondaryWeaponList,r=t.subWeaponSelection,s=t.perkList,l=t.perkSelection,y("pilot",t.pilotSelection),y("primaryWeapon",i[o].reference),y("secondaryWeapon",n[r].reference),y("perk",s[l].reference),p=a.get("gameData"),d.commit("setGamedata",p),e.startGame()})));a.checkState("MAINMENU")&&(o.checkWithDelay({isActive:!0,key:"UP",delay:250})&&2!==i&&A.updateLocation(0),o.checkWithDelay({isActive:!0,key:"DOWN",delay:250})&&(1===i&&(A.hide(),w.show(),T.show(),_.show(),v.show(),v.updateLocation(n),x(n),a.changeState("LOADOUTSELECT")),2!==i&&A.updateLocation(1)),o.checkWithDelay({isActive:!0,key:"RIGHT",delay:250})&&0===i&&m.inc(),o.checkWithDelay({isActive:!0,key:"LEFT",delay:250})&&0===i&&m.dec(),o.checkWithDelay({isActive:!0,key:"A",delay:250})&&2===i&&(A.hide(),a.forceLet("currentSelection",null),g("FADEIN")));a.checkState("PILOTSELECT")&&(o.checkWithDelay({isActive:!0,key:"LEFT",delay:250})&&m.dec(),o.checkWithDelay({isActive:!0,key:"RIGHT",delay:250})&&m.inc(),o.checkWithDelay({isActive:!0,key:"A",delay:250})&&(w.hide(),A.show(),a.changeState("MAINMENU")));a.checkState("LOADOUTSELECT")&&(o.checkWithDelay({isActive:!0,key:"A",delay:s[p].cooldown})&&f("PRIMARY"),o.checkWithDelay({isActive:!0,key:"B",delay:h[u].cooldown})&&f("SECONDARY"),o.checkWithDelay({isActive:!0,key:"DOWN",delay:250})&&b(1),o.checkWithDelay({isActive:!0,key:"UP",delay:250})&&(0===n?(a.forceLet("loadoutSelection",0),A.show(),w.hide(),T.hide(),_.hide(),v.hide(),a.changeState("MAINMENU")):b(-1)),o.checkWithDelay({isActive:!0,key:"RIGHT",delay:250})&&x(1),o.checkWithDelay({isActive:!0,key:"LEFT",delay:250})&&x(-1),o.checkWithDelay({isActive:!0,key:"BACK",delay:250})&&(a.forceLet("loadoutSelection",0),A.show(),w.hide(),T.hide(),_.hide(),v.hide(),a.changeState("MAINMENU")))}}),resolution:{width:i.width,height:i.height}}),o=new PHASER_CONTROLS,n=new PHASER_MOUSE({showDebugger:!1}),r=new PHASER_SPRITE_MANAGER,s=new PHASER_BITMAPDATA_MANAGER,l=new PHASER_TEXT_MANAGER,p=new PHASER_BUTTON_MANAGER,h=new PHASER_GROUP_MANAGER,u=new PHASER_BITMAPDATA_MANAGER,c=new WEAPON_MANAGER,d=i.store;function y(t,e){a.get("gameData")[t]=e}function g(t,e){void 0===e&&(e=function(){});setTimeout(function(){"FADEOUT"===t&&(r.getGroup("grids").forEach(function(t,e){setTimeout(function(){t.fadeOut(500)},10*e)}),setTimeout(function(){e()},10*r.getGroup("grids").length+500)),"FADEIN"===t&&(r.getGroup("grids").forEach(function(t,e){setTimeout(function(){t.fadeIn(500)},10*e)}),setTimeout(function(){e()},10*r.getGroup("grids").length+500))},500)}function f(t){var e=a.game(),i=a.getAll(),o=i.primaryWeaponList,n=i.primaryWeaponSelection,s=(i.loadoutSelection,i.secondaryWeaponList),l=i.subWeaponSelection,p=(i.perkSelection,r.getAll("OBJECT").ship);"PRIMARY"===t&&("BULLET"===o[n].reference&&(c.createBullet({name:"B"+e.rnd.integer(),group:"ship_wpn_preview",x:p.x-25,offset:0,y:p.y,spread:0,layer:3}),c.createBullet({name:"B"+e.rnd.integer(),group:"ship_wpn_preview",x:p.x+25,offset:0,y:p.y,spread:0,layer:3})),"MISSLES"===o[n].reference&&(c.createMissle({name:"B"+e.rnd.integer(),group:"ship_wpn_preview",x:p.x-25,offset:0,y:p.y-p.height/2,spread:-.25,layer:3}),c.createMissle({name:"B"+e.rnd.integer(),group:"ship_wpn_preview",x:p.x+25,offset:0,y:p.y-p.height/2,spread:.25,layer:3})),"LASER"===o[n].reference&&(c.createLaser({name:"B"+e.rnd.integer(),group:"ship_wpn_preview",x:p.x-25,offset:0,y:p.y-p.height/2,spread:0,layer:3}),c.createLaser({name:"B"+e.rnd.integer(),group:"ship_wpn_preview",x:p.x+25,offset:0,y:p.y-p.height/2,spread:0,layer:3}))),"SECONDARY"===t&&("CLUSTERBOMB"===s[l].reference&&c.createClusterbomb({name:"B"+e.rnd.integer(),group:"ship_wpn_preview",x:p.x,y:p.y,layer:3}),"TRIPLEBOMB"===s[l].reference&&(c.createTriplebomb({name:"B"+e.rnd.integer(),group:"ship_wpn_preview",x:p.x,y:p.y,layer:3}),setTimeout(function(){c.createTriplebomb({name:"B"+e.rnd.integer(),group:"ship_wpn_preview",x:p.x+e.rnd.integerInRange(0,20),y:p.y,layer:3,spread:e.rnd.integerInRange(0,2)})},100),setTimeout(function(){c.createTriplebomb({name:"B"+e.rnd.integer(),group:"ship_wpn_preview",x:p.x-e.rnd.integerInRange(0,20),y:p.y,layer:3,spread:e.rnd.integerInRange(-2,0)})},200)),"TURRET"===s[l].reference&&c.createTurret({name:"B"+e.rnd.integer(),group:"ship_wpn_preview",x:p.x,y:p.y+50,layer:4}),"BLASTRADIUS"===s[l].reference&&c.createBlastradius({name:"B"+e.rnd.integer(),group:"ship_wpn_preview",x:p.x,y:p.y,layer:2}))}function m(){var t=a.getAll(),e=t.primaryWeaponSelection,i=t.subWeaponSelection,o=t.perkSelection;r.getGroup("ui_box_selected").forEach(function(t){t.alpha=0}),r.get("sbox_pw_"+e).alpha=1,r.get("sbox_sw_"+i).alpha=1,r.get("sbox_sp_"+o).alpha=1}function v(t){var e=r.getAll("OBJECT"),i=e.profileSelector,a=(e.loadoutCatagorySelector,l.getAll("OBJECT").pilotDescriptionText);i.updateLocation(t),a.updateThisText(t)}function b(t){var e=a.getAll().loadoutSelection,i=r.getAll("OBJECT"),o=(i.downarrow,i.loadoutCatagorySelector);e+=t,t>0&&e>2&&(e=2),t<0&&e<0&&(e=0),a.forceLet("loadoutSelection",e),x(null),o.updateLocation(e)}function x(t){var e,i=a.getAll(),o=i.weaponData,n=i.loadoutSelection,s=i.primaryWeaponSelection,p=i.subWeaponSelection,h=i.perkSelection,u=i.primaryWeaponList,c=i.secondaryWeaponList,d=i.perkList,y=r.getAll("OBJECT"),g=y.downarrow,f=y.loadoutCatagorySelector,v=l.getAll("OBJECT").loadoutDescriptionText;if(0===n&&(s+=t,t>0&&(s>=A(o.primaryWeapons)&&(s=0),a.forceLet("primaryWeaponSelection",s)),t<0&&(s<0&&(s=A(o.primaryWeapons)-1),a.forceLet("primaryWeaponSelection",s)),v.setText(u[s].name+": "+u[s].description)),1===n&&(p+=t,t>0&&(p>=A(o.secondaryWeapons)&&(p=0),a.forceLet("subWeaponSelection",p)),t<0&&(p<0&&(p=A(o.secondaryWeapons)-1),a.forceLet("subWeaponSelection",p)),v.setText(c[p].name+": "+c[p].description)),2===n&&(h+=t,t>0&&(h>=A(o.perks)&&(h=0),a.forceLet("perkSelection",h)),t<0&&(h<0&&(h=A(o.perks)-1),a.forceLet("perkSelection",h)),v.setText(d[h].name+": "+d[h].description)),0===n){var b=(e=r.get("box_pw_"+s)).x,x=e.y;g.updateLocation(b,x-30)}if(1===n){b=(e=r.get("box_sw_"+p)).x,x=e.y;g.updateLocation(b,x-30)}if(2===n){b=(e=r.get("box_sp_"+h)).x,x=e.y;g.updateLocation(b,x-30)}m(),f.updateLocation(n)}function A(t){for(var e=0,i=0,a=Object.keys(t);i<a.length;i++){a[i];e++}return e}a.let("gameData",d.getters._gameData()),e.game=this,this.game=a.game()},t.prototype.destroy=function(){this.game.destroy()},t}(),__phaser=new PhaserGameObject,PHASER_AUDIO=function(){return function(){}}(),PHASER_BITMAPDATA_MANAGER=function(){function t(){this.game=null,this.bmd={array:[],object:{}}}return t.prototype.assign=function(t){this.game=t},t.prototype.addGradient=function(t){if(0===this.bmd.array.filter(function(e){return e.name===t.name}).length){var e=this.game.make.bitmapData(t.width,t.height),i=e.context.createLinearGradient(0,0,0,t.height);i.addColorStop(0,t.start),i.addColorStop(1,t.end),e.context.fillStyle=i,e.context.fillRect(0,0,t.width,t.height);var a=this.game.cache.addBitmapData(t.name,e),o=this.game.make.bitmapData();return o.load(this.game.cache.getBitmapData(t.name)),t.render&&o.addToWorld(t.x,t.y),o.name=t.name,o.group=t.group,o.cacheBitmapData=a,this.bmd.array.push(o),this.bmd.object[t.name]=o,o}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.addImage=function(t){if(0===this.bmd.array.filter(function(e){return e.name===t.name}).length){var e=this.game.make.bitmapData();return e.load(t.reference),e.addToWorld(t.x,t.y),t.render||e.cls(),e.name=t.name,e.group=t.group,e.cacheBitmapData=t.reference,this.bmd.array.push(e),this.bmd.object[t.name]=e,e}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.addEmpty=function(t){if(0===this.bmd.array.filter(function(e){return e.name===t.name}).length){var e=this.game.make.bitmapData(t.width,t.height);return e.addToWorld(t.x,t.y),t.render||e.cls(),e.name=t.name,e.group=t.group,this.bmd.array.push(e),this.bmd.object[t.name]=e,e}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.destroy=function(t){for(var e=[],i=0,a=this.bmd.array.filter(function(e){return e.name===t});i<a.length;i++){var o=a[i];e.push(o.name),o.destroy()}return delete this.bmd.object[t],this.bmd.array=this.bmd.array.filter(function(e){return e.name!==t}),e},t.prototype.destroyGroup=function(t){for(var e=[],i=0,a=this.bmd.array.filter(function(t){return t.group===name});i<a.length;i++){var o=a[i];e.push(o.name),o.destroy()}return delete this.bmd.object[name],this.bmd.array=this.bmd.array.filter(function(t){return t.group!==name}),e},t.prototype.get=function(t){return this.bmd.object[t]},t.prototype.getGroup=function(t){return this.bmd.array.filter(function(e){return e.group===t})},t.prototype.getAll=function(t){return void 0===t&&(t="BOTH"),"ARRAY"===t?this.bmd.array:"OBJECT"==t?this.bmd.object:{object:this.bmd.object,array:this.bmd.array}},t}(),PHASER_BUTTON_MANAGER=function(){function t(){this.game=null,this.resources={array:[],object:{}}}return t.prototype.assign=function(t){this.game=t.game},t.prototype.add=function(t){if(0===this.resources.array.filter(function(e){return e.name===t.name}).length){var e=this.game.add.button(t.x,t.y,t.reference,t.onclick);return e.name=t.name,e.group=t.group||null,this.resources.array.push(e),this.resources.object[t.name]=e,e}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.destroy=function(t){for(var e=[],i=0,a=this.resources.array.filter(function(e){return e.key===t});i<a.length;i++){var o=a[i];e.push(o.key),o.destroy()}return delete this.resources.object[t],this.resources.array=this.resources.array.filter(function(e){return e.key!==t}),e},t.prototype.destroyGroup=function(t){for(var e=[],i=0,a=this.resources.array.filter(function(e){return e.group===t});i<a.length;i++){var o=a[i];e.push(o.key),o.destroy()}return delete this.resources.object[t],this.resources.array=this.resources.array.filter(function(e){return e.group!==t}),e},t.prototype.get=function(t){return this.resources.object[t]},t.prototype.getGroup=function(t){return this.resources.array.filter(function(e){return e.group===t})},t.prototype.getAll=function(t){return void 0===t&&(t="BOTH"),"ARRAY"===t?this.resources.array:"OBJECT"==t?this.resources.object:{object:this.resources.object,array:this.resources.array}},t}(),PHASER_CONTROLS=function(){function t(){this.IO=null,this.game=null,this.buttonSensitivity={QUICK:1,SHORT:50,LONG:150,SUPERLONG:300},this.properties={isReady:!1,allowDebugger:!0,buttonDelay:50,timingRefreshRate:1},this.directionalButtons=["UP","DOWN","LEFT","RIGHT"],this.actionButtons=["A","B","X","Y"],this.triggerButtons=["L1","L2","R1","R2","L3","R3"],this.systemButtons=["START","BACK"],this.buttonArray=this.directionalButtons.concat(this.actionButtons,this.triggerButtons,this.systemButtons),this.buttonMap={UP:{name:"UP",code:"ArrowUp"},DOWN:{name:"DOWN",code:"ArrowDown"},LEFT:{name:"LEFT",code:"ArrowLeft"},RIGHT:{name:"RIGHT",code:"ArrowRight"},A:{name:"A",code:"KeyA"},B:{name:"S",code:"KeyS"},X:{name:"D",code:"KeyD"},Y:{name:"F",code:"KeyF"},L1:{name:"Q",code:"KeyQ"},L2:{name:"W",code:"KeyW"},R1:{name:"E",code:"KeyE"},R2:{name:"R",code:"KeyR"},L3:{name:"O",code:"KeyO"},R3:{name:"P",code:"KeyP"},START:{name:"ENTER",code:"Enter"},BACK:{name:"BACKSPACE",code:"Backspace"}},this.buttonMapId={UP:1,DOWN:2,LEFT:3,RIGHT:4,A:5,B:6,X:7,Y:8,L1:9,L2:10,R1:11,R2:12,L3:13,R3:14,START:15,BACK:16},this.disabledButtons={ALL:!1,DIRECTIONAL:!1,TRIGGER:!1,ACTION:!1,SYSTEM:!1},this.debugger={enabled:!1,text:{}},this.inputDelay={delay:Array.apply(null,Array(20)).map(function(){return 0})}}return t.prototype.assign=function(t){var e=this;this.game=t;var i={font:"12px Courier New",fill:"#fff",align:"left"};this.buttonArray.forEach(function(a,o){e.debugger.text[a]=null,e.debugger.text[a]=t.add.text(10,10+15*o,"",i),e.disabledButtons[a]=!1});for(var a={buttons:{},sensitivityPress:{},sensitivityBuffer:{},state:{}},o=function(i){a.buttons[i]=t.input.keyboard.addKey(Phaser.Keyboard[n.buttonMap[i].name]),a.sensitivityPress[i]=null,a.sensitivityBuffer[i]=0,a.state[i]=function(){return e.getBtnPressType(e.IO.sensitivityBuffer[i])}},n=this,r=0,s=this.buttonArray;r<s.length;r++){o(s[r])}for(var l=function(t){a.buttons[t].onDown.add(function(i){var o,n;clearInterval(a.sensitivityPress[t]);var r=["DIRECTIONAL","ACTION","TRIGGER","SYSTEM"];Object.keys(e.buttonMap).forEach(function(t,a){if(e.buttonMap[t].code===i.event.code)for(var s=0,l=r;s<l.length;s++){var p=l[s];e[p.toLowerCase()+"Buttons"].indexOf(t)+1&&(o=p,n=t)}});var s=!1;e.disabledButtons.ALL&&(s=!0);for(var l=0,p=r;l<p.length;l++){var h=p[l];e.disabledButtons[h]&&o===h&&(s=!0)}Object.keys(e.buttonMap).forEach(function(t,i){e.disabledButtons[t]&&n===t&&(s=!0)}),s||(a.sensitivityPress[t]=setInterval(function(){a.sensitivityBuffer[t]+=1},e.properties.timingRefreshRate))},p)},p=this,h=0,u=this.buttonArray;h<u.length;h++){l(u[h])}return t.input.keyboard.onUpCallback=function(t){for(var i=0,o=e.buttonArray;i<o.length;i++){var n=o[i];t.code===e.buttonMap[n].code&&(clearInterval(a.sensitivityPress[n]),a.sensitivityBuffer[n]=0)}"Backquote"===t.code&&e.properties.allowDebugger&&(e.setDebugger(!e.debugger.enabled),e.updateDebugger())},this.properties.isReady=!0,this.IO=a,a},t.prototype.mapKeys=function(t){var e=this;this.properties.isReady=!1,this.destroyAll(),setTimeout(function(){e.buttonMap=t,e.properties.isReady=!0,e.assign(e.game)},1)},t.prototype.isReady=function(){return this.properties.isReady},t.prototype.checkWithDelay=function(t){return this.read(t.key).active===t.isActive&&(this.game.time.now>this.inputDelay.delay[this.getKeyId(t.key)]&&(this.inputDelay.delay[this.getKeyId(t.key)]=t.delay+this.game.time.now,!0))},t.prototype.isDebuggerEnabled=function(){return this.debugger.enabled},t.prototype.setDebugger=function(t){void 0===t&&(t=!0),this.debugger.enabled=t},t.prototype.updateDebugger=function(){if(this.properties.isReady)for(var t=0,e=this.buttonArray;t<e.length;t++){var i=e[t];this.debugger.text[i].setText(this.debugger.enabled?this.debuggerString(i):"").bringToTop()}},t.prototype.disableAllInput=function(){this.disabledButtons.ALL=!0},t.prototype.enableAllInput=function(){this.disabledButtons.ALL=!1},t.prototype.disableAllDirectionalButtons=function(){this.disabledButtons.DIRECTIONAL=!0},t.prototype.enableAllDirectionalButtons=function(){this.disabledButtons.DIRECTIONAL=!1},t.prototype.disableAllTriggerButtons=function(){this.disabledButtons.TRIGGER=!0},t.prototype.enableAllTriggerButtons=function(){this.disabledButtons.TRIGGER=!1},t.prototype.disableAllActionButtons=function(){this.disabledButtons.ACTION=!0},t.prototype.enableAllActionButtons=function(){this.disabledButtons.ACTION=!1},t.prototype.disableAllSystemButtons=function(){this.disabledButtons.SYSTEM=!0},t.prototype.enableAllSystemButtons=function(){this.disabledButtons.SYSTEM=!1},t.prototype.setDisableKeyProperty=function(t,e){void 0===e&&(e=!0),this.properties.isReady&&(this.disabledButtons[t.toUpperCase()]=e)},t.prototype.getKeyDisabledValue=function(t){return this.properties.isReady?this.disabledButtons[t.toUpperCase()]:null},t.prototype.clearAllControlIntervals=function(){if(this.properties.isReady)for(var t=0,e=this.buttonArray;t<e.length;t++){var i=e[t];clearInterval(this.IO.sensitivityPress[i])}},t.prototype.getKeyId=function(t){return this.buttonMapId[t.toUpperCase()]},t.prototype.read=function(t){if(this.properties.isReady){return{}[t]={id:this.buttonMapId[t.toUpperCase()],active:this.IO.state[t.toUpperCase()]().val>0,duration:this.IO.state[t.toUpperCase()]().val,state:this.IO.state[t.toUpperCase()]().state,type:this.IO.state[t.toUpperCase()]().type,disabled:this.disabledButtons[t.toUpperCase()]}}return{}},t.prototype.readMulti=function(t,e){if(void 0===e&&(e="OBJECT"),this.properties.isReady){if("OBJECT"===e){for(var i={},a=0,o=t;a<o.length;a++){i[s=o[a]]={id:this.buttonMapId[s.toUpperCase()],active:this.IO.state[s.toUpperCase()]().val>0,duration:this.IO.state[s.toUpperCase()]().val,state:this.IO.state[s.toUpperCase()]().state,type:this.IO.state[s.toUpperCase()]().type,disabled:this.disabledButtons[s.toUpperCase()]}}return i}if("ARRAY"===e){i=[];for(var n=0,r=t;n<r.length;n++){var s=r[n];i.push({id:this.buttonMapId[s.toUpperCase()],key:s,active:this.IO.state[s.toUpperCase()]().val>0,duration:this.IO.state[s.toUpperCase()]().val,state:this.IO.state[s.toUpperCase()]().state,type:this.IO.state[s.toUpperCase()]().type,disabled:this.disabledButtons[s.toUpperCase()]})}return i}}},t.prototype.debuggerString=function(t){return t.toUpperCase()+" ("+this.buttonMap[t.toUpperCase()].name+"/"+this.buttonMap[t.toUpperCase()].code+") | id: "+this.buttonMapId[t.toUpperCase()]+" duration: "+this.IO.state[t.toUpperCase()]().val+" | state: "+this.IO.state[t.toUpperCase()]().state+" | type: "+this.IO.state[t.toUpperCase()]().type+" | disabled: "+this.disabledButtons[t.toUpperCase()]},t.prototype.getBtnPressType=function(t){var e=this,i="NONE",a=0,o=0;return Object.keys(this.buttonSensitivity).forEach(function(n){o++,t>e.buttonSensitivity[n]&&(i=n,a=o)}),{val:t,type:i,state:a}},t.prototype.destroyAll=function(){var t=this;this.clearAllControlIntervals(),Object.keys(this.debugger.text).forEach(function(e){t.debugger.text[e].destroy()})},t}(),PHASER_GROUP_MANAGER=function(){function t(){this.game=null,this.group={array:[],object:{}}}return t.prototype.assign=function(t,e){void 0===e&&(e=10),this.game=t;for(var i=0;i<=e;i++){var a=t.add.group();this.group.object[""+i]=a,this.group.array.push(a)}},t.prototype.layer=function(t){return this.group.object[t]},t.prototype.add=function(t,e){this.group.object[t].add(e)},t.prototype.addMany=function(t,e){var i=this;e.forEach(function(e){i.group.object[t].add(e)})},t}(),PHASER_MASTER=function(){function t(t){this._game=t.game,this.resolution=t.resolution,this.states={BOOT:"BOOT",PRELOAD:"PRELOAD",READY:"READY"},this.currentState=this.states[0],this.variables={}}return t.prototype.let=function(t,e){if(void 0===e&&(e=null),void 0===this.variables[t])return this.variables[t]=e;console.log("Cannot LET duplicate key in PHASER_MASTER: "+t)},t.prototype.forceLet=function(t,e){return void 0===e&&(e=null),this.variables[t]=e},t.prototype.delete=function(t){delete this.variables[t]},t.prototype.get=function(t){return void 0!==this.variables[t]?this.variables[t]:(console.log("Cannot GET a variable that does not exist in PHASER_MASTER."),null)},t.prototype.getAll=function(){return this.variables},t.prototype.changeState=function(t){void 0===t&&(t=null);var e=t.toUpperCase(),i=!1;return void 0===this.states[e]&&(this.states[e]=e,i=!0),this.currentState=e,{created:i,state:this.currentState}},t.prototype.getCurrentState=function(){return this.currentState},t.prototype.getStates=function(){return this.states},t.prototype.getResolution=function(){return this.resolution},t.prototype.checkState=function(t){return this.currentState===t.toUpperCase()},t.prototype.game=function(){return this._game},t}(),PHASER_MOUSE=function(){function t(t){this.game=null,this.clickSensitvity={QUICK:1,SHORT:50,LONG:150,SUPERLONG:300},this.mouseMapping=[0,1,2],this.mouseMap={LEFT:0,MIDDLE:1,RIGHT:2},this.metrics={sensitivityPress:{},sensitivityBuffer:{},location:{},state:{}},this.properties={allowDebugger:!0,timingRefreshRate:1},this.inputDelay={delay:Array.apply(null,Array(2)).map(function(){return 0})},this.debugger={enabled:void 0!==t.showDebugger&&t.showDebugger,text:{},pointer:null}}return t.prototype.assign=function(t){var e=this;this.game=t;for(var i=function(t){a.metrics.sensitivityPress[t]=null,a.metrics.sensitivityBuffer[t]=0,a.metrics.location[t]={x:null,y:null},a.metrics.state[t]=function(){return e.getBtnPressType(e.metrics.sensitivityBuffer[t])}},a=this,o=0,n=this.mouseMapping;o<n.length;o++){i(n[o])}this.game.input.onDown.add(function(t){var i=e.checkMouseClick();clearInterval(e.metrics.sensitivityPress[i]),e.metrics.sensitivityPress[i]=setInterval(function(){e.metrics.sensitivityBuffer[i]+=1,e.metrics.location[i]={x:t.x,y:t.y}},e.properties.timingRefreshRate)}),this.game.input.onUp.add(function(t){var i=e.checkMouseClick();e.clearAllControlIntervals(),e.metrics.sensitivityBuffer[i]=0});var r={font:"12px Courier New",fill:"#fff",align:"left"};this.mouseMapping.forEach(function(t,i){e.debugger.text[t]=null,e.debugger.text[t]=e.game.add.text(5,e.game.height-35-15*i,"",r)}),this.debugger.pointer=this.game.add.text(5,this.game.height-20,"",r),t.canvas.oncontextmenu=function(t){t.preventDefault()}},t.prototype.checkMouseClick=function(){var t=0;return this.game.input.activePointer.leftButton.isDown&&(t=0),this.game.input.activePointer.middleButton.isDown&&(t=1),this.game.input.activePointer.rightButton.isDown&&(t=2),t},t.prototype.debuggerString=function(t){return"Button_"+t+" | {x: "+this.metrics.location[t].x+", y: "+this.metrics.location[t].y+"} | active: "+(this.metrics.sensitivityBuffer[t]>0)+" | state: "+this.metrics.state[t]().state+" | duration: "+this.metrics.state[t]().val+" | type: "+this.metrics.state[t]().type},t.prototype.setDebugger=function(t){void 0===t&&(t=!0),this.debugger.enabled=t},t.prototype.updateDebugger=function(){for(var t=0,e=this.mouseMapping;t<e.length;t++){var i=e[t];this.debugger.text[i].setText(this.debugger.enabled?this.debuggerString(i):"").bringToTop()}this.debugger.pointer.setText(this.debugger.enabled?"Pointer: {x: "+this.game.input.mousePointer.x+", y: "+this.game.input.mousePointer.y+"}":"").bringToTop()},t.prototype.clearAllControlIntervals=function(){for(var t=0,e=this.mouseMapping;t<e.length;t++){var i=e[t];this.metrics.sensitivityBuffer[i]=0,clearInterval(this.metrics.sensitivityPress[i])}},t.prototype.checkWithDelay=function(t){if(this.read(t.key).active===t.isActive){var e=this.mouseMap[t.key.toUpperCase()];return this.game.time.now>this.inputDelay.delay[e]&&(this.inputDelay.delay[e]=t.delay+this.game.time.now,!0)}return!1},t.prototype.read=function(t){void 0===t&&(t="LEFT");var e=this.mouseMap[t.toUpperCase()];return{id:e,x:this.metrics.location[e].x,y:this.metrics.location[e].y,active:this.metrics.sensitivityBuffer[e]>0,duration:this.metrics.sensitivityBuffer[e],state:this.metrics.state[e]().state,type:this.metrics.state[e]().type}},t.prototype.getBtnPressType=function(t){var e=this,i="NONE",a=0,o=0;return Object.keys(this.clickSensitvity).forEach(function(n){o++,t>e.clickSensitvity[n]&&(i=n,a=o)}),{val:t,type:i,state:a}},t}(),PHASER_PRELOADER=function(){function t(t){this.game=t.game,this.init(t.delayInSeconds,t.done)}return t.prototype.init=function(t,e){var i,a,o=this;this.game.load.onLoadStart.add(function(){(i=o.game.add.text(o.game.world.centerX,o.game.world.centerY/2,"",{font:"18px Impact",fill:"#fff",align:"center"})).anchor.set(.5),(a=o.game.add.text(o.game.world.centerX,o.game.world.centerY,"",{font:"32px Impact",fill:"#fff",align:"center"})).anchor.set(.5)},this),this.game.load.onFileComplete.add(function(t,e,o,n,r){i.setText("Please wait..."),a.setText(t+"%")},this),this.game.load.onLoadComplete.add(function(){i.setText("File loaded!"),a.setText(""),o.game.time.events.add(Phaser.Timer.SECOND*t,function(){i.destroy(),a.destroy(),e()},o).autoDestroy=!0},this)},t}(),PHASER_SPRITE_MANAGER=function(){function t(){this.game=null,this.sprites={array:[],object:{}},this.spriteCount=0}return t.prototype.assign=function(t){this.game=t},t.prototype.add=function(t){if(0===this.sprites.array.filter(function(e){return e.name===t.name}).length){t.x=void 0!==t.x?t.x:0,t.y=void 0!==t.y?t.y:0,t.group=void 0!==t.group?t.group:null,t.visible=void 0===t.visible||t.visible,t.alpha=void 0!==t.alpha?t.alpha:1,t.width=void 0!==t.width?t.width:null,t.height=void 0!==t.height?t.height:null;var e=this.game.add.sprite(t.x,t.y,t.reference);return e.name=t.name,e.group=t.group,e.defaultPosition={x:t.x,y:t.y},e.visible=t.visible,e.alpha=t.alpha,null!==t.width&&(e.width=t.width),null!==t.height&&(e.height=t.height),e.setDefaultPositions=function(t,e){this.defaultPosition.x=t,this.defaultPosition.y=e},e.getDefaultPositions=function(){return this.defaultPosition},e.init=function(){},e.onUpdate=function(){},e.reveal=function(){},e.show=function(){this.visible=!0},e.hide=function(){this.visible=!1},this.sprites.array.push(e),this.sprites.object[t.name]=e,e}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.addFromAtlas=function(t){if(0===this.sprites.array.filter(function(e){return e.name===t.name}).length){t.x=void 0!==t.x?t.x:0,t.y=void 0!==t.y?t.y:0,t.group=void 0!==t.group?t.group:null,t.visible=void 0===t.visible||t.visible,t.alpha=void 0!==t.alpha?t.alpha:1,t.width=void 0!==t.width?t.width:null,t.height=void 0!==t.height?t.height:null;var e=this.game.add.sprite(t.x,t.y,t.atlas,t.filename);return e.name=t.name,e.group=t.group,e.defaultPosition={x:t.x,y:t.y},e.visible=t.visible,e.alpha=t.alpha,null!==t.width&&(e.width=t.width),null!==t.height&&(e.height=t.height),e.setDefaultPositions=function(t,e){this.defaultPosition.x=t,this.defaultPosition.y=e},e.getDefaultPositions=function(){return this.defaultPosition},e.init=function(){},e.onUpdate=function(){},e.reveal=function(){},e.show=function(){this.visible=!0},e.hide=function(){this.visible=!1},this.sprites.array.push(e),this.sprites.object[t.name]=e,e}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.addTilespriteFromAtlas=function(t){if(0===this.sprites.array.filter(function(e){return e.name===t.name}).length){t.x=void 0!==t.x?t.x:0,t.y=void 0!==t.y?t.y:0,t.group=void 0!==t.group?t.group:null,t.visible=void 0===t.visible||t.visible,t.alpha=void 0!==t.alpha?t.alpha:1,t.width=void 0!==t.width?t.width:null,t.height=void 0!==t.height?t.height:null;var e=this.game.add.tileSprite(t.x,t.y,t.width,t.height,t.atlas,t.filename);return e.name=t.name,e.group=t.group,e.defaultPosition={x:t.x,y:t.y},e.visible=t.visible,e.alpha=t.alpha,null!==t.width&&(e.width=t.width),null!==t.height&&(e.height=t.height),e.setDefaultPositions=function(t,e){this.defaultPosition.x=t,this.defaultPosition.y=e},e.getDefaultPositions=function(){return this.defaultPosition},e.init=function(){},e.onUpdate=function(){},e.reveal=function(){},e.show=function(){this.visible=!0},e.hide=function(){this.visible=!1},this.sprites.array.push(e),this.sprites.object[t.name]=e,e}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.addEmptySprite=function(t){if(0===this.sprites.array.filter(function(e){return e.name===t.name}).length){t.x=void 0!==t.x?t.x:0,t.y=void 0!==t.y?t.y:0,t.group=void 0!==t.group?t.group:null,t.visible=void 0===t.visible||t.visible,t.alpha=void 0!==t.alpha?t.alpha:1,t.width=void 0!==t.width?t.width:null,t.height=void 0!==t.height?t.height:null;var e=this.game.add.sprite(t.x,t.y);return e.name=t.name,e.group=t.group,e.defaultPosition={x:t.x,y:t.y},e.visible=t.visible,e.alpha=t.alpha,null!==t.width&&(e.width=t.width),null!==t.height&&(e.height=t.height),e.setDefaultPositions=function(t,e){this.defaultPosition.x=t,this.defaultPosition.y=e},e.getDefaultPositions=function(){return this.defaultPosition},e.init=function(){},e.onUpdate=function(){},e.reveal=function(){},e.show=function(){this.visible=!0},e.hide=function(){this.visible=!1},this.sprites.array.push(e),this.sprites.object[t.name]=e,e}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.createBasicMask=function(t,e,i,a){var o=this.game.add.graphics(0,0);return o.beginFill(16777215),o.drawRect(t,e,i,a),o},t.prototype.addBasicMaskToSprite=function(t){var e=this.game.add.graphics(0,0);return e.beginFill(16777215),e.drawRect(t.x,t.y,t.width,t.height),t.mask=e,e},t.prototype.destroy=function(t){if(void 0!==this.sprites.object[t]){for(var e=[],i=0,a=this.sprites.array.filter(function(e){return e.name===t});i<a.length;i++){var o=a[i];e.push(o.name),o.destroy()}return delete this.sprites.object[t],this.sprites.array=this.sprites.array.filter(function(e){return e.name!==t}),e}return console.log("Cannot delete "+t+" because it does not exist."),null},t.prototype.destroyGroup=function(t){for(var e=[],i=0,a=this.sprites.array.filter(function(e){return e.group===t});i<a.length;i++){var o=a[i];e.push(o.name),o.destroy()}return delete this.sprites.object[t],this.sprites.array=this.sprites.array.filter(function(e){return e.group!==t}),e},t.prototype.get=function(t){return this.sprites.object[t]},t.prototype.getGroup=function(t){return this.sprites.array.filter(function(e){return e.group===t})},t.prototype.getManyGroups=function(t){for(var e=[],i=function(i){var o=a.sprites.array.filter(function(e){return e.group===t[i]});e=e.concat(o)},a=this,o=0;o<t.length;o++)i(o);return e},t.prototype.getAll=function(t){return void 0===t&&(t="BOTH"),"ARRAY"===t?this.sprites.array:"OBJECT"==t?this.sprites.object:{object:this.sprites.object,array:this.sprites.array}},t.prototype.count=function(){return this.spriteCount++,{total:this.sprites.array.length,unique:this.spriteCount}},t.prototype.centerWorld=function(t){if(void 0===this.sprites.object[t])return console.log("Error centering sprite:  key does not exists."),null;var e=this.sprites.object[t];return e.alignIn(this.game.world.bounds,Phaser.CENTER),e},t.prototype.centerOnPoint=function(t,e,i){if(void 0===this.sprites.object[t])return console.log("Error centering sprite:  key does not exists."),null;var a=this.sprites.object[t];return a.x=e-a.width/2,a.y=i-a.height/2,a},t}(),PHASER_TEXT_MANAGER=function(){function t(){this.game=null,this.texts={array:[],object:{}}}return t.prototype.assign=function(t){this.game=t},t.prototype.add=function(t){var e=this.texts.array.filter(function(e){return e.name===t.name});if(t.x=void 0!==t.x?t.x:0,t.y=void 0!==t.y?t.y:0,t.group=void 0!==t.group?t.group:null,t.size=void 0!==t.size?t.size:12,t.default=void 0!==t.default?t.default:"",t.visible=void 0===t.visible||t.visible,t.alpha=void 0!==t.alpha?t.alpha:1,0===e.length){var i=this.game.add.bitmapText(t.x,t.y,t.font,t.default,t.size);return i.name=t.name,i.group=t.group,i.visible=t.visible,i.alpha=t.alpha,i.show=function(){this.visible=!0},i.hide=function(){this.visible=!1},this.texts.array.push(i),this.texts.object[t.name]=i,i}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.destroy=function(t){for(var e=[],i=0,a=this.texts.array.filter(function(e){return e.name===t});i<a.length;i++){var o=a[i];e.push(o.name),o.destroy()}return delete this.texts.object[t],this.texts.array=this.texts.array.filter(function(e){return e.name!==t}),e},t.prototype.destroyGroup=function(t){for(var e=[],i=0,a=this.texts.array.filter(function(e){return e.group===t});i<a.length;i++){var o=a[i];e.push(o.key),o.destroy()}return delete this.texts.object[t],this.texts.array=this.texts.array.filter(function(e){return e.group!==t}),e},t.prototype.get=function(t){return this.texts.object[t]},t.prototype.getGroup=function(t){return this.texts.array.filter(function(e){return e.group===t})},t.prototype.getAll=function(t){return void 0===t&&(t="BOTH"),"ARRAY"===t?this.texts.array:"OBJECT"==t?this.texts.object:{object:this.texts.object,array:this.texts.array}},t.prototype.alignToBottomLeftCorner=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],a=this.game;return i.x=e,i.y=a.canvas.height-i.height-e,i},t.prototype.alignToBottomCenter=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],a=this.game;return i.x=a.canvas.width/2-i.width/2,i.y=a.canvas.height-i.height-e,i},t.prototype.alignToBottomRightCorner=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],a=this.game;return i.x=a.canvas.width-i.width-e,i.y=a.canvas.height-i.height-e,i},t.prototype.alignToCenterRight=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],a=this.game;return i.x=a.canvas.width-i.width-e,i.y=a.canvas.height/2-i.height/2,i},t.prototype.alignToTopRightCorner=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],a=this.game;return i.x=a.canvas.width-i.width-e,i.y=e,i},t.prototype.alignToTopCenter=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],a=this.game;return i.x=a.canvas.width/2-i.width/2-e,i.y=e,i},t.prototype.alignToTopLeftCorner=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t];this.game;return i.x=e,i.y=e,i},t.prototype.alignToCenterLeft=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],a=this.game;return i.x=e,i.y=a.canvas.height/2-i.height/2,i},t.prototype.alignToCenter=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],a=this.game;return i.x=a.canvas.width/2-i.width/2,i.y=a.canvas.height/2-i.height/2,i},t.prototype.center=function(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[t],o=this.game;return a.x=o.canvas.width/2-a.width/2+e,a.y=o.canvas.height/2-a.height/2+i,a},t}(),WEAPON_MANAGER=function(){function t(){}return t.prototype.assign=function(t,e,i,a,o){this.game=t,this.phaserSprites=i,this.phaserMaster=e,this.phaserGroup=a,this.atlas=o},t.prototype.createBullet=function(t){var e=this.game,i=this.phaserMaster,a=this.phaserSprites,o=this.phaserGroup,n=this.atlas,r=i.getAll().weaponData.primaryWeapons.BULLET,s=a.addFromAtlas({y:t.y,name:t.name,group:t.group,atlas:n,filename:r.spriteAnimation[0]});return r.spriteAnimation.length>1&&(s.animations.add("animate",r.spriteAnimation,1,!0),s.animations.play("animate",30,!0)),s.anchor.setTo(.5,.5),s.x=t.x+t.offset,e.physics.enable(s,Phaser.Physics.ARCADE),s.body.velocity.y=r.initialVelocity,s.accelerate=function(){s.body.velocity.y-=r.velocity,s.body.velocity.x+=t.spread},s.destroyIt=function(){a.destroy(s.name)},s.onUpdate=function(){this.accelerate(),this.y<-this.height&&this.destroyIt()},void 0!==t.layer&&o.add(t.layer,s),s},t.prototype.createMissle=function(t){var e=this.game,i=this.phaserMaster,a=this.phaserSprites,o=this.phaserGroup,n=this.atlas,r=i.getAll().weaponData.primaryWeapons.MISSLE,s=a.addFromAtlas({y:t.y,name:t.name,group:t.group,atlas:n,filename:r.spriteAnimation[0]});return r.spriteAnimation.length>1&&(s.animations.add("animate",r.spriteAnimation,1,!0),s.animations.play("animate",30,!0)),s.anchor.setTo(.5,.5),s.angle=-90,s.x=t.x+t.offset,e.physics.enable(s,Phaser.Physics.ARCADE),s.body.velocity.y=r.initialVelocity,s.accelerate=function(){s.body.velocity.y-=r.velocity,s.body.velocity.x+=t.spread},s.destroyIt=function(){a.destroy(s.name)},s.onUpdate=function(){s.accelerate(),s.y<-s.height&&s.destroyIt()},void 0!==t.layer&&o.add(t.layer,s),s},t.prototype.createLaser=function(t){var e=this.game,i=this.phaserMaster,a=this.phaserSprites,o=this.phaserGroup,n=this.atlas,r=i.getAll().weaponData.primaryWeapons.LASER,s=a.addFromAtlas({y:t.y,name:t.name,group:t.group,atlas:n,filename:r.spriteAnimation[0]});return r.spriteAnimation.length>1&&(s.animations.add("animate",r.spriteAnimation,1,!0),s.animations.play("animate",30,!0)),s.anchor.setTo(.5,.5),s.x=t.x+t.offset,e.physics.enable(s,Phaser.Physics.ARCADE),s.body.velocity.y=r.initialVelocity,s.accelerate=function(){s.body.velocity.y-=r.velocity,s.body.velocity.x+=t.spread},s.destroyIt=function(){a.destroy(s.name)},s.onUpdate=function(){s.accelerate(),s.y<-s.height&&s.destroyIt()},void 0!==t.layer&&o.add(t.layer,s),s},t.prototype.createClusterbomb=function(t){var e=this,i=this.game,a=this.phaserMaster,o=this.phaserSprites,n=this.phaserGroup,r=this.atlas,s=a.getAll().weaponData.secondaryWeapons.CLUSTERBOMB,l=o.addFromAtlas({x:t.x,y:t.y,name:t.name,group:t.group,atlas:r,filename:s.spriteAnimation[0]});return s.spriteAnimation.length>1&&(l.animations.add("animate",s.spriteAnimation,1,!0),l.animations.play("animate",30,!0)),i.physics.enable(l,Phaser.Physics.ARCADE),l.anchor.setTo(.5,.5),l.body.velocity.y=s.initialVelocity,l.angle=90,l.hasDetonated=!1,l.self=this,setTimeout(function(){l.hasDetonated||(l.hasDetonated=!0,l.destroyIt())},800),l.accelerate=function(){l.body.velocity.y>-400&&(l.body.velocity.y-=s.velocity),l.body.velocity.x+=t.spread},l.destroyIt=function(){e.createExplosion(l.x,l.y,1.25,t.layer);for(var a=0;a<s.bomblets;a++)e.createBomblet({x:l.x,y:l.y,ix:i.rnd.integerInRange(-400,400),iy:i.rnd.integerInRange(-400,100),group:t.group,layer:t.layer});o.destroy(l.name)},l.onUpdate=function(){l.angle+=5,l.accelerate(),l.y<-l.height&&l.destroyIt()},void 0!==t.layer&&n.add(t.layer,l),l},t.prototype.createTriplebomb=function(t){var e=this,i=this.game,a=this.phaserMaster,o=this.phaserSprites,n=this.phaserGroup,r=this.atlas,s=a.getAll().weaponData.secondaryWeapons.TRIPLEBOMB,l=o.addFromAtlas({x:t.x,y:t.y,name:t.name,group:t.group,atlas:r,filename:s.spriteAnimation[0]});return s.spriteAnimation.length>1&&(l.animations.add("animate",s.spriteAnimation,1,!0),l.animations.play("animate",30,!0)),i.physics.enable(l,Phaser.Physics.ARCADE),l.anchor.setTo(.5,.5),l.body.velocity.y=s.initialVelocity,l.angle=90,l.hasDetonated=!1,l.self=this,l.accelerate=function(){l.body.velocity.y>-500&&(l.body.velocity.y-=s.velocity),l.body.velocity.x+=t.spread},l.destroyIt=function(){e.createExplosion(l.x,l.y,1.25,t.layer),o.destroy(l.name)},l.onUpdate=function(){l.angle+=15,l.accelerate(),l.y<-l.height&&l.destroyIt()},void 0!==t.layer&&n.add(t.layer,l),l},t.prototype.createTurret=function(t){var e=this,i=this.game,a=this.phaserMaster,o=this.phaserSprites,n=this.phaserGroup,r=this.atlas,s=a.getAll().weaponData.secondaryWeapons.TURRET,l=o.addFromAtlas({x:t.x,y:t.y,name:t.name,group:t.group,atlas:r,filename:s.spriteAnimation[0]});l.anchor.setTo(.5,.5),i.physics.enable(l,Phaser.Physics.ARCADE),n.add(2,l),setTimeout(function(){l.destroyIt()},s.lifespan),l.fireInterval=setInterval(function(){var a=l.x,o=l.y,n=l.width;e.createBullet({name:"B"+i.rnd.integer(),group:"ship_wpn_preview",x:a,offset:0,y:o,spread:0,layer:t.layer}),e.createBullet({name:"B"+i.rnd.integer(),group:"ship_wpn_preview",x:a+n/2,offset:0,y:o,spread:0,layer:t.layer}),e.createBullet({name:"B"+i.rnd.integer(),group:"ship_wpn_preview",x:a-n/2,offset:0,y:o,spread:0,layer:t.layer})},200),l.fireInterval,l.destroyIt=function(){e.createExplosion(l.x,l.y,.5,t.layer),clearInterval(l.fireInterval),o.destroy(l.name)},void 0!==t.layer&&n.add(t.layer,l)},t.prototype.createBlastradius=function(t){var e=this.game,i=this.phaserMaster,a=this.phaserSprites,o=this.phaserGroup,n=this.atlas,r=i.getAll().weaponData.secondaryWeapons.BLASTRADIUS,s=a.addFromAtlas({x:t.x,y:t.y,name:t.name,group:t.group,atlas:n,filename:r.spriteAnimation[0]});if(s.anchor.setTo(.5,.5),s.scale.setTo(1,1),r.spriteAnimation.length>1){var l=s.animations.add("animate",r.spriteAnimation,30,!1);l.onStart.add(function(){},s),l.onComplete.add(function(){a.destroy(s.name)},s),l.play("animate")}e.physics.enable(s,Phaser.Physics.ARCADE),void 0!==t.layer&&o.add(t.layer,s)},t.prototype.createBomblet=function(t){var e=this,i=this.game,a=(this.phaserMaster,this.phaserSprites),o=this.phaserGroup,n=this.atlas,r=a.addFromAtlas({x:t.x,y:t.y,name:"bomblet_"+i.rnd.integer(),group:t.group,atlas:n,filename:"clusterBomb.png"});return r.anchor.setTo(.5,.5),r.scale.setTo(.5,.5),i.physics.enable(r,Phaser.Physics.ARCADE),r.body.velocity.y=t.iy,r.body.velocity.x=t.ix,r.fuse=i.time.now,r.detonate=i.time.now+i.rnd.integerInRange(1250,1800),r.destroyIt=function(){e.createExplosion(r.x,r.y,1,t.layer),a.destroy(r.name)},r.onUpdate=function(){r.angle+=5,r.game.time.now>r.detonate&&r.destroyIt()},void 0!==t.layer&&o.add(t.layer,r,t.layer),r},t.prototype.createExplosion=function(t,e,i,a){var o=this.game,n=(this.phaserMaster,this.phaserSprites),r=this.phaserGroup,s=this.atlas,l=n.addFromAtlas({name:"explosion_"+o.rnd.integer(),group:"explosions",x:t,y:e,atlas:s,filename:"explosions_Layer_1.png"});l.scale.setTo(i,i),l.anchor.setTo(.5,.5),l.animations.add("explosion",Phaser.Animation.generateFrameNames("explosions_Layer_",1,16,".png"),1,!0),l.animations.play("explosion",30,!0),setTimeout(function(){n.destroy(l.name)},Phaser.Timer.SECOND/2),void 0!==a&&r.add(a,l)},t}();