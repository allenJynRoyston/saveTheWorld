var PhaserGameObject=function(){function e(){this.game=null,this.global={pause:!1}}return e.prototype.init=function(e,t,a){var n=new Phaser.Game(a.width,a.height,Phaser.WEBGL,e,{preload:function(){var e=i.game();e.load.enableParallel=!0,e.stage.backgroundColor="#2f2f2f";var t="src/phaser/saveTheWorld/resources";e.load.atlas("atlas",t+"/spritesheets/heroSelect/heroSelectAtlas.png",t+"/spritesheets/heroSelect/heroSelectAtlas.json",Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),e.load.atlas("atlas_main",t+"/spritesheets/main/main.png",t+"/spritesheets/main/main.json",Phaser.Loader.TEXTURE_atlas_main_JSON_HASH),e.load.atlas("atlas_weapons",t+"/spritesheets/weapons/weaponsAtlas.png",t+"/spritesheets/weapons/weaponsAtlas.json",Phaser.Loader.TEXTURE_atlas_main_JSON_HASH),e.load.atlas("atlas_ships",t+"/spritesheets/ships/ships.png",t+"/spritesheets/ships/ships.json",Phaser.Loader.TEXTURE_atlas_main_JSON_HASH),e.load.bitmapFont("gem",t+"/fonts/gem.png",t+"/fonts/gem.xml"),e.load.json("weaponData",t+"/json/weaponData.json"),e.load.json("pilotData",t+"/json/pilotData.json"),i.changeState("PRELOAD"),new PHASER_PRELOADER({game:e,delayInSeconds:0,done:function(){!function(){i.game();var e=s.getOnly(["pointer"]).pointer,t=i.getOnly(["currentSelection","pilotSelection"]),a=t.currentSelection,n=t.pilotSelection;e.updateLocation(a),_(n),w(),b("WIPEOUT",function(){y.overlayBGControls({transition:"FADEOUT",delay:0,speed:250},function(){i.changeState("MAINMENU")})})}()}})},create:function(){var e=i.game();o.assign(e),r.assign(e),s.assign(e),l.assign(e),p.assign(e),h.assign(e),u.assign(e,20),d.assign(e),m.assign(e,i,s,u,"atlas_weapons"),c.assign(e,i,s,p,u,o,m,"atlas_ships","atlas_weapons"),y.assign(e,s,d,u,"atlas_main");i.let("currentSelection",0);var t=i.let("pilotSelection",0),a=(i.let("loadoutSelection",0),i.let("primaryWeaponSelection",0),i.let("subWeaponSelection",0),i.let("perkSelection",0),i.let("weaponData",e.cache.getJSON("weaponData")),i.let("pilotData",e.cache.getJSON("pilotData"))),n=this.game.world.width-240,g=this.game.world.height/2,f=s.addFromAtlas({x:n,y:0,height:e.world.height,name:"verticleFrame",group:"ui_frame",filename:"ui_frame_v.png",atlas:"atlas"}),v=s.addFromAtlas({x:0,y:g,width:f.x,name:"dividerFrame1",group:"ui_frame",filename:"ui_frame_h.png",atlas:"atlas"}),b=d.addGradient({name:"overlayFadeout",start:"#ffffff",end:"#ffffff",width:1,height:1,render:!1}),x=s.add({x:0,y:0,name:"container_1",width:n,height:g,reference:b.cacheBitmapData,visible:!1}),A=s.add({x:0,y:325,name:"container_2",width:n,height:g,reference:b.cacheBitmapData,visible:!1}),w=s.add({x:n,y:0,name:"container_3",width:e.world.width-n,height:e.world.height,reference:b.cacheBitmapData,visible:!1}),T=s.addBasicMaskToSprite(x);y.buildOverlayBackground("#ffffff","#ffffff",19,!0),y.buildOverlayGrid(240,132,20,"logo_small.png");var S=s.addTilespriteFromAtlas({name:"bg_clouds",group:"ui_bg",x:x.x,y:x.y,width:x.width,height:x.height,atlas:"atlas",filename:"bg_clouds.png"});S.mask=T,S.onUpdate=function(){0===i.get("currentSelection")&&(this.tilePosition.x-=3)};var I=s.addTilespriteFromAtlas({name:"bg_cityscape",group:"ui_bg",x:A.x,y:A.y,width:A.width,height:A.height,atlas:"atlas",filename:"bg_cityscape.png"});I.onUpdate=function(){1===i.get("currentSelection")&&(this.tilePosition.x-=.25)};var E=s.addTilespriteFromAtlas({name:"bg_cityscape_1",group:"ui_bg",x:A.x,y:A.y+50,width:A.width,height:A.height,atlas:"atlas",filename:"bg_cityscape_1.png"});E.onUpdate=function(){1===i.get("currentSelection")&&(this.tilePosition.x-=.5)};var D=s.addTilespriteFromAtlas({name:"bg_cityscape_2",group:"ui_bg",x:A.x,y:A.y+115,width:A.width,height:A.height,atlas:"atlas",filename:"bg_cityscape_2.png"});D.onUpdate=function(){1===i.get("currentSelection")&&(this.tilePosition.x-=1)};var P=s.addTilespriteFromAtlas({name:"bg_cityscape_3",group:"ui_bg",x:A.x,y:A.y+200,width:A.width,height:A.height,atlas:"atlas",filename:"bg_cityscape_3.png"});P.onUpdate=function(){1===i.get("currentSelection")&&(this.tilePosition.x-=2)};var O=s.addTilespriteFromAtlas({name:"bg_space",group:"ui_bg",x:w.x,y:w.y,width:w.width,height:w.height,atlas:"atlas",filename:"bg_space.png"});O.onUpdate=function(){2===i.get("currentSelection")?this.tilePosition.y+=2:this.tilePosition.y+=.1};var L=s.addFromAtlas({name:"pointer",group:"ui",atlas:"atlas",filename:"ui_pointer.png"});L.anchor.setTo(.5,.5),L.hide=function(){this.visible=!1},L.show=function(){this.visible=!0},L.updateLocation=function(e){i.forceLet("currentSelection",e);var t=s.get("textbox"+e),a=t.x,n=t.y;this.x=a-90,this.y=n};var R=s.addFromAtlas({name:"downarrow",group:"ui",atlas:"atlas",filename:"ui_downarrow.png",visible:!1});R.anchor.setTo(.5,.5),R.hide=function(){this.visible=!1},R.show=function(){this.visible=!0},R.updateLocation=function(e,t){this.x=e,this.y=t};var C=s.addFromAtlas({name:"textbox0",group:"ui_textholders",atlas:"atlas",filename:"ui_textbox.png",alpha:1});C.anchor.setTo(.5,.5),s.centerOnPoint("textbox0",x.width/2+C.width/2,x.y+40);var k=p.add({name:"text0",group:"ui_text",x:C.x,y:C.y,font:"gem",size:12,default:"SELECT PILOT"});k.anchor.setTo(.5,.5);var M=s.addFromAtlas({name:"textbox1",group:"ui_textholders",atlas:"atlas",filename:"ui_textbox.png",alpha:1});M.anchor.setTo(.5,.5),s.centerOnPoint("textbox1",A.width/2+M.width/2,A.y+50);var B=p.add({name:"text1",group:"ui_text",x:M.x,y:M.y,font:"gem",size:12,default:"LOADOUT"});B.anchor.setTo(.5,.5);var W=s.addFromAtlas({name:"textbox2",group:"ui_textholders",atlas:"atlas",filename:"ui_textbox.png",alpha:1});W.anchor.setTo(.5,.5),s.centerOnPoint("textbox2",w.x+w.width/2+W.width/2,w.y+40);var U=p.add({name:"text2",group:"ui_text",x:W.x,y:W.y,font:"gem",size:12,default:"START"});U.anchor.setTo(.5,.5);var N=s.addFromAtlas({name:"pilotDescriptionBox",group:"ui_textholders",atlas:"atlas",filename:"ui_descriptionbox.png",alpha:1});N.anchor.setTo(.5,.5),s.centerOnPoint("pilotDescriptionBox",x.width/2+N.width/2,x.y+295);var G=p.add({name:"pilotDescriptionText",group:"ui_text",x:N.x-N.width/2+20,y:N.y-N.height/2,font:"gem",size:14,default:""});G.maxWidth=N.width-40,G.updateThisText=function(e){this.setText("\nNAME:               "+F[e].name+"\n\nFIRING RATE:        "+F[e].firerate+"\nSUBWEAPON RECHARGE: "+F[e].subweaponRecharge+"\nHEALTH:             "+F[e].health+"\nMOVEMENT:           "+F[e].movement+"\n              ")},u.addMany(17,[C,M,W,N]),u.addMany(18,[k,B,U,G]);for(var F=a.pilots,j=0;j<F.length;j++){var H=s.addFromAtlas({name:"profile"+j,group:"ui_profiles",y:x.y+110,atlas:"atlas",filename:""+F[j].image,alpha:0});H.anchor.setTo(.5,.5);var K=H.width/2*(F.length-1);H.x=x.x+j*H.width+x.width/2-K,H.alpha=1,u.add(18,H)}var Y=s.addFromAtlas({name:"profileSelector",group:"ui_profiles",atlas:"atlas",filename:"ui_pictureframe.png",alpha:0});Y.anchor.setTo(.5,.5),Y.updateLocation=function(e){i.forceLet("pilotSelection",e),s.getGroup("ui_profiles").map(function(e){e.alpha=.85});var t=s.get("profile"+e);t.alpha=1;var a=t.x,n=t.y;this.x=a,this.y=n,R.updateLocation(a,n-t.height/2-8)},Y.inc=function(){(t+=1)>F.length-1&&(t=0),_(t)},Y.dec=function(){(t-=1)<0&&(t=F.length-1),_(t)},u.add(18,Y),u.addMany(1,[O]),u.addMany(6,[S,I,E,D,P]),u.addMany(10,[f,v]),u.addMany(14,[L,R])},update:function(){i.game();var e=i.getAll(),a=e.currentSelection,n=(e.pilotSelection,e.loadoutSelection),r=e.primaryWeaponList,l=e.primaryWeaponSelection,h=(e.secondaryWeaponList,e.subWeaponSelection,s.getAll()),u=h.profileSelector,d=h.loadoutCatagorySelector,c=h.pointer,m=h.downarrow,f=h.loadoutDescription,x=o.getOnly(["DOWN","UP","LEFT","RIGHT","A","START"]),w=(x.DOWN,x.UP,x.LEFT,x.RIGHT,p.getAll("OBJECT").loadoutDescriptionText);s.getManyGroups(["ui_bg","playership","ship_wpn_preview"]).map(function(e){e.onUpdate()}),o.checkWithDelay({isActive:!0,key:"BACK",delay:250})&&2===a&&c.updateLocation(0);o.checkWithDelay({isActive:!0,key:"START",delay:250})&&(2!==a&&(i.forceLet("loadoutSelection",0),c.show(),m.hide(),f.hide(),w.hide(),d.hide(),i.changeState("MAINMENU"),c.updateLocation(2)),2===a&&(c.hide(),i.forceLet("currentSelection",null),y.overlayBGControls({transition:"FADEIN",delay:0,speed:250},function(){b("WIPEIN",function(){setTimeout(function(){!function(){i.game();var e=i.getAll(),a=e.primaryWeaponList,n=e.primaryWeaponSelection,o=(e.loadoutSelection,e.secondaryWeaponList),r=e.subWeaponSelection,s=e.perkList,l=e.perkSelection;v("pilot",e.pilotSelection),v("primaryWeapon",a[n].reference),v("secondaryWeapon",o[r].reference),v("perk",s[l].reference),p=i.get("gameData"),g.commit("setGamedata",p),t.startGame();var p}()},1e3)})})));i.checkState("MAINMENU")&&(o.checkWithDelay({isActive:!0,key:"UP",delay:250})&&2!==a&&c.updateLocation(0),o.checkWithDelay({isActive:!0,key:"DOWN",delay:250})&&(1===a&&(c.hide(),m.show(),f.show(),w.show(),d.show(),d.updateLocation(n),S(n),i.changeState("LOADOUTSELECT")),2!==a&&c.updateLocation(1)),o.checkWithDelay({isActive:!0,key:"RIGHT",delay:250})&&0===a&&u.inc(),o.checkWithDelay({isActive:!0,key:"LEFT",delay:250})&&0===a&&u.dec(),o.checkWithDelay({isActive:!0,key:"A",delay:250})&&2===a&&(c.hide(),i.forceLet("currentSelection",null),b("FADEIN")));i.checkState("PILOTSELECT")&&(o.checkWithDelay({isActive:!0,key:"LEFT",delay:250})&&u.dec(),o.checkWithDelay({isActive:!0,key:"RIGHT",delay:250})&&u.inc(),o.checkWithDelay({isActive:!0,key:"A",delay:250})&&(m.hide(),c.show(),i.changeState("MAINMENU")));i.checkState("LOADOUTSELECT")&&(0===n&&o.checkWithDelay({isActive:!1,key:"R3",delay:r[l].cooldown})&&A("PRIMARY"),1===n&&o.checkWithDelay({isActive:!1,key:"R3",delay:2e3})&&A("SECONDARY"),o.checkWithDelay({isActive:!0,key:"DOWN",delay:250})&&T(1),o.checkWithDelay({isActive:!0,key:"UP",delay:250})&&(0===n?(i.forceLet("loadoutSelection",0),c.show(),m.hide(),f.hide(),w.hide(),d.hide(),i.changeState("MAINMENU")):T(-1)),o.checkWithDelay({isActive:!0,key:"RIGHT",delay:250})&&S(1),o.checkWithDelay({isActive:!0,key:"LEFT",delay:250})&&S(-1),o.checkWithDelay({isActive:!0,key:"BACK",delay:250})&&(i.forceLet("loadoutSelection",0),c.show(),m.hide(),f.hide(),w.hide(),d.hide(),i.changeState("MAINMENU")))}});n.preserveDrawingBuffer=!0;var i=new PHASER_MASTER({game:n,resolution:{width:a.width,height:a.height}}),o=new PHASER_CONTROLS,r=new PHASER_MOUSE({showDebugger:!1}),s=new PHASER_SPRITE_MANAGER,l=new PHASER_BITMAPDATA_MANAGER,p=new PHASER_TEXT_MANAGER,h=new PHASER_BUTTON_MANAGER,u=new PHASER_GROUP_MANAGER,d=new PHASER_BITMAPDATA_MANAGER,c=new PLAYER_MANAGER,m=new WEAPON_MANAGER,y=new UTILITY_MANAGER,g=a.store,f=JSON.stringify(g.getters._gameData());function v(e,t){i.get("gameData")[e]=t}function b(e,t){void 0===t&&(t=function(){}),y.overlayControls({transition:e,delay:1,speed:250,tileDelay:10},t)}function x(e){m.createBomblet(e,function(t){var a,n,i,o;a=t.x,n=t.y,i=.5,o=e.layer+1,m.createExplosion(a,n,i,o)})}function A(e){i.game();var t=i.getAll(),a=t.primaryWeaponList,n=t.primaryWeaponSelection,o=(t.loadoutSelection,t.secondaryWeaponList),r=t.subWeaponSelection;t.perkSelection,s.getAll("OBJECT").ship;if("PRIMARY"===e)switch(a[n].reference){case"BULLET":!function(){var e=i.game(),t=s.getOnly(["ship"]).ship,a=10,n=2,o=5;t.fireWeapon();for(var r=function(n){setTimeout(function(){m.createBullet({name:"bullet_"+e.rnd.integer(),group:"ship_wpn_preview",x:t.x+n*a-o,y:t.y,spread:0,layer:7})},25)},l=0;l<n;l++)r(l)}();break;case"LASER":!function(){var e=i.game(),t=s.getOnly(["ship"]).ship,a=30,n=1,o=0;t.fireWeapon();for(var r=0;r<n;r++)m.createLaser({name:"laser_"+e.rnd.integer(),group:"ship_wpn_preview",x:t.x+r*a-o,y:t.y-t.height/2,spread:0,layer:7})}();break;case"MISSLE":!function(){var e=i.game(),t=s.getOnly(["ship"]).ship,a=30,n=2,o=15;t.fireWeapon();for(var r=0;r<n;r++)m.createMissle({name:"missle_"+e.rnd.integer(),group:"ship_wpn_preview",x:t.x+r*a-o,y:t.y-t.height/2,spread:r%2==0?-.5:.5,layer:7})}()}if("SECONDARY"===e)switch(s.getGroup("ship_wpn_preview").map(function(e){e.destroyIt()}),o[r].reference){case"CLUSTERBOMB":!function(){var e=i.game(),t=s.getOnly(["ship"]).ship;t.fireSubweapon(),m.createClusterbomb({name:"clusterbomb_"+e.rnd.integer(),group:"ship_wpn_preview",x:t.x-22,y:t.y,layer:2},function(t){for(var a=0;a<t.bomblets;a++)x({x:t.x,y:t.y,ix:e.rnd.integerInRange(-400,400),iy:e.rnd.integerInRange(-400,100),damage:t.damageAmount/4,group:"ship_wpn_preview",layer:2})})}();break;case"TRIPLEBOMB":!function(){for(var e=i.game(),t=s.getOnly(["ship"]).ship,a=0;a<3;a++)setTimeout(function(){t.fireSubweapon(),m.createTriplebomb({name:"triplebomb_"+e.rnd.integer(),group:"ship_wpn_preview",x:t.x+20,y:t.y,layer:2})},300*a)}();break;case"TURRET":!function(){var e=i.game(),t=s.getOnly(["ship"]).ship,a=function(t){var a=10,n=3,i=10;t.fireInterval=setInterval(function(){for(var o=0;o<n;o++)m.createBullet({name:"bullet_"+e.rnd.integer(),group:"ship_wpn_preview",x:t.x+o*a-i,y:t.y,spread:0,layer:2})},200),t.fireInterval},n=function(e){e.x=t.x-e.offset,e.y=t.y},o=function(e){};m.createTurret({name:"turret_"+e.rnd.integer(),group:"ship_wpn_preview",x:t.x,y:t.y,offset:50,layer:3},a,o,n),m.createTurret({name:"turret_"+e.rnd.integer(),group:"ship_wpn_preview",x:t.x,y:t.y,offset:-50,layer:3},a,o,n)}()}}function w(){var e=i.getAll(),t=e.primaryWeaponSelection,a=e.subWeaponSelection,n=e.perkSelection;s.getGroup("ui_box_selected").map(function(e){e.alpha=0}),s.get("sbox_pw_"+t).alpha=1,s.get("sbox_sw_"+a).alpha=1,s.get("sbox_sp_"+n).alpha=1}function _(e){var t=s.getOnly(["profileSelector","loadoutCatagorySelector","container_3"]),a=t.profileSelector,n=(t.loadoutCatagorySelector,t.container_3),o=p.getOnly(["pilotDescriptionText"]).pilotDescriptionText;i.forceLet("primaryWeaponSelection",0),i.forceLet("subWeaponSelection",0),i.forceLet("perkSelection",0),void 0!==s.get("ship")&&c.destroyShip("ship"),function(e){var t=i.getOnly(["weaponData","pilotData"]),a=t.weaponData,n=t.pilotData,o=s.getOnly(["container_2","downarrow"]),r=o.container_2,l=o.downarrow;s.getManyGroups(["ui_loadout","ui_box_selected"]).map(function(e){s.destroy(e.name)}),p.getManyGroups(["ui_loadout"]).map(function(e){p.destroy(e.name)});for(var h=[],d=[],c=[],m=0,y=Object.keys(a.primaryWeapons);m<y.length;m++){var g=y[m];h.push(a.primaryWeapons[g])}for(var f=0,v=Object.keys(a.secondaryWeapons);f<v.length;f++)g=v[f],d.push(a.secondaryWeapons[g]);for(var b=0,x=Object.keys(a.perks);b<x.length;b++)g=x[b],c.push(a.perks[g]);var A=h.filter(function(t){for(var a=0;a<n.pilots[e].weapons.length;a++)if(t.reference===n.pilots[e].weapons[a])return t}),w=d.filter(function(t){for(var a=0;a<n.pilots[e].subweapons.length;a++)if(t.reference===n.pilots[e].subweapons[a])return t}),_=c.filter(function(t){for(var a=0;a<n.pilots[e].perks.length;a++)if(t.reference===n.pilots[e].perks[a])return t});i.forceLet("primaryWeaponList",A),i.forceLet("secondaryWeaponList",w),i.forceLet("perkList",_),A.map(function(e,t){var a=s.addFromAtlas({name:"box_pw_"+t,group:"ui_loadout",y:r.y+90,atlas:"atlas",filename:"ui_box_unselected.png",alpha:0});a.anchor.setTo(.5,.5);var n=(a.width+5)/2*(A.length-1);a.x=r.x+t*a.width+r.width/2-n+5*t,a.alpha=1;var i=s.addFromAtlas({name:"sbox_pw_"+t,group:"ui_box_selected",y:r.y+90,atlas:"atlas",filename:"ui_box_selected.png",alpha:0});i.anchor.setTo(.5,.5),i.x=r.x+t*i.width+r.width/2-n+5*t,i.alpha=0;var o=s.addFromAtlas({name:"icon_pw_"+t,group:"ui_loadout",y:r.y+90,atlas:"atlas_weapons",filename:""+e.spriteIcon,alpha:1});o.anchor.setTo(.5,.5),o.x=r.x+t*i.width+r.width/2-n+5*t,u.addMany(13,[a,i,o])}),w.map(function(e,t){var a=s.addFromAtlas({name:"box_sw_"+t,group:"ui_loadout",y:r.y+140,atlas:"atlas",filename:"ui_box_unselected.png",alpha:0});a.anchor.setTo(.5,.5);var n=(a.width+5)/2*(w.length-1);a.x=r.x+t*a.width+r.width/2-n+5*t,a.alpha=1;var i=s.addFromAtlas({name:"sbox_sw_"+t,group:"ui_box_selected",y:r.y+140,atlas:"atlas",filename:"ui_box_selected.png",alpha:0});i.anchor.setTo(.5,.5),i.x=r.x+t*i.width+r.width/2-n+5*t,i.alpha=0;var o=s.addFromAtlas({name:"icon_sw_"+t,group:"ui_loadout",y:r.y+140,atlas:"atlas_weapons",filename:""+e.spriteIcon,alpha:1});o.anchor.setTo(.5,.5),o.x=r.x+t*i.width+r.width/2-n+5*t,u.addMany(13,[a,i,o])}),_.map(function(e,t){var a=s.addFromAtlas({name:"box_sp_"+t,group:"ui_loadout",y:r.y+190,atlas:"atlas",filename:"ui_box_unselected.png",alpha:0});a.anchor.setTo(.5,.5);var n=(a.width+5)/2*(_.length-1);a.x=r.x+t*a.width+r.width/2-n+5*t,a.alpha=1;var i=s.addFromAtlas({name:"sbox_sp_"+t,group:"ui_box_selected",y:r.y+190,atlas:"atlas",filename:"ui_box_selected.png",alpha:0});i.anchor.setTo(.5,.5),i.x=r.x+t*i.width+r.width/2-n+5*t,i.alpha=0;var o=s.addFromAtlas({name:"icon_sp_"+t,group:"ui_loadout",y:r.y+190,atlas:"atlas_weapons",filename:""+e.spriteIcon,alpha:1});o.anchor.setTo(.5,.5),o.x=r.x+t*i.width+r.width/2-n+5*t,u.addMany(13,[a,i,o])});var T=s.addFromAtlas({name:"loadoutCatagorySelector",group:"ui_loadout",atlas:"atlas",filename:"ui_pointer.png",visible:!1,alpha:0});T.anchor.setTo(.5,.5),T.show=function(){this.visible=!0},T.hide=function(){this.visible=!1},T.updateLocation=function(e){var t,a=i.getAll(),n=a.primaryWeaponSelection,o=a.subWeaponSelection,r=a.perkSelection;if(0===e){var p=(t=s.get("box_pw_"+n)).x,h=t.y;l.updateLocation(p,h-30)}if(1===e){var u=(t=s.get("box_sw_"+o)).x,d=t.y;l.updateLocation(u,d-30)}if(2===e){var c=(t=s.get("box_sp_"+r)).x,m=t.y;l.updateLocation(c,m-30)}t.x;var y=t.y;this.x=40,this.y=y,this.visible};var S=s.addFromAtlas({name:"loadoutDescription",group:"ui_loadout",atlas:"atlas",filename:"ui_descriptionbox_small.png",visible:!1});S.anchor.setTo(.5,.5),s.centerOnPoint("loadoutDescription",r.width/2+S.width/2,r.y+310);var I=p.add({name:"loadoutDescriptionText",group:"ui_loadout",x:S.x,y:S.y,font:"gem",size:14,default:""});I.anchor.setTo(.5,.5),I.maxWidth=S.width-40,u.add(17,S),u.add(18,I)}(e),a.updateLocation(e),o.updateThisText(e),w();var r=i.getOnly(["primaryWeaponSelection","primaryWeaponList","secondaryWeaponList","subWeaponSelection","perkSelection","perkList"]),l=r.primaryWeaponSelection,h=r.primaryWeaponList,d=r.secondaryWeaponList,m=r.subWeaponSelection,y=r.perkSelection,g=r.perkList,f=c.createShip({name:"ship",group:"playership",shipId:e,layer:5});f.attachPerk(g[y].reference),f.attachWeapon(h[l].reference),f.attachSubweapon(d[m].reference),f.visible=!0,s.centerOnPoint("ship",n.x+n.width/2+f.width/2,n.height-100)}function T(e){var t=i.getAll().loadoutSelection,a=s.getAll("OBJECT"),n=(a.downarrow,a.loadoutCatagorySelector);t+=e,e>0&&t>2&&(t=2),e<0&&t<0&&(t=0),i.forceLet("loadoutSelection",t),S(null),n.updateLocation(t)}function S(e){var t,a=i.getOnly(["weaponData","loadoutSelection","primaryWeaponSelection","subWeaponSelection","perkSelection","primaryWeaponList","secondaryWeaponList","perkList"]),n=(a.weaponData,a.loadoutSelection),o=a.primaryWeaponSelection,r=a.subWeaponSelection,l=a.perkSelection,h=a.primaryWeaponList,u=a.secondaryWeaponList,d=a.perkList,c=s.getOnly(["downarrow","loadoutCatagorySelector","ship"]),m=c.downarrow,y=c.loadoutCatagorySelector,g=c.ship,f=p.getOnly(["loadoutDescriptionText"]).loadoutDescriptionText;switch(n){case 0:o+=e,e>0&&(o>=h.length&&(o=0),i.forceLet("primaryWeaponSelection",o)),e<0&&(o<0&&(o=h.length-1),i.forceLet("primaryWeaponSelection",o)),f.setText(h[o].name+": "+h[o].description);break;case 1:r+=e,e>0&&(r>=u.length&&(r=0),i.forceLet("subWeaponSelection",r)),e<0&&(r<0&&(r=u.length-1),i.forceLet("subWeaponSelection",r)),f.setText(u[r].name+": "+u[r].description);break;case 2:l+=e,e>0&&(l>=d.length&&(l=0),i.forceLet("perkSelection",l)),e<0&&(l<0&&(l=d.length-1),i.forceLet("perkSelection",l)),f.setText(d[l].name+": "+d[l].description)}if(g.attachPerk(d[l].reference),g.attachWeapon(h[o].reference),g.attachSubweapon(u[r].reference),0===n){var v=(t=s.get("box_pw_"+o)).x,b=t.y;m.updateLocation(v,b-30)}if(1===n){v=(t=s.get("box_sw_"+r)).x,b=t.y;m.updateLocation(v,b-30)}if(2===n){v=(t=s.get("box_sp_"+l)).x,b=t.y;m.updateLocation(v,b-30)}w(),y.updateLocation(n)}i.let("gameData",JSON.parse(f)),t.game=this,this.game=i.game()},e.prototype.destroy=function(){this.game.destroy()},e}(),__phaser=new PhaserGameObject,PHASER_AUDIO=function(){return function(){}}(),PHASER_BITMAPDATA_MANAGER=function(){function e(){this.game=null,this.bmd={array:[],object:{}}}return e.prototype.assign=function(e){this.game=e},e.prototype.addGradient=function(e){if(0===this.bmd.array.filter(function(t){return t.name===e.name}).length){var t=this.game.make.bitmapData(e.width,e.height),a=t.context.createLinearGradient(0,0,0,e.height);a.addColorStop(0,e.start),a.addColorStop(1,e.end),t.context.fillStyle=a,t.context.fillRect(0,0,e.width,e.height);var n=this.game.cache.addBitmapData(e.name,t),i=this.game.make.bitmapData();return i.load(this.game.cache.getBitmapData(e.name)),e.render&&i.addToWorld(e.x,e.y),i.name=e.name,i.group=e.group,i.cacheBitmapData=n,this.bmd.array.push(i),this.bmd.object[e.name]=i,i}console.log("Duplicate key name not allowed: "+e.name)},e.prototype.addImage=function(e){if(0===this.bmd.array.filter(function(t){return t.name===e.name}).length){var t=this.game.make.bitmapData();return t.load(e.reference),t.addToWorld(e.x,e.y),e.render||t.cls(),t.name=e.name,t.group=e.group,t.cacheBitmapData=e.reference,this.bmd.array.push(t),this.bmd.object[e.name]=t,t}console.log("Duplicate key name not allowed: "+e.name)},e.prototype.addEmpty=function(e){if(0===this.bmd.array.filter(function(t){return t.name===e.name}).length){var t=this.game.make.bitmapData(e.width,e.height);return t.addToWorld(e.x,e.y),e.render||t.cls(),t.name=e.name,t.group=e.group,this.bmd.array.push(t),this.bmd.object[e.name]=t,t}console.log("Duplicate key name not allowed: "+e.name)},e.prototype.destroy=function(e){for(var t=[],a=0,n=this.bmd.array.filter(function(t){return t.name===e});a<n.length;a++){var i=n[a];t.push(i.name),i.destroy()}return delete this.bmd.object[e],this.bmd.array=this.bmd.array.filter(function(t){return t.name!==e}),t},e.prototype.destroyGroup=function(e){for(var t=[],a=0,n=this.bmd.array.filter(function(e){return e.group===name});a<n.length;a++){var i=n[a];t.push(i.name),i.destroy()}return delete this.bmd.object[name],this.bmd.array=this.bmd.array.filter(function(e){return e.group!==name}),t},e.prototype.get=function(e){return this.bmd.object[e]},e.prototype.getGroup=function(e){return this.bmd.array.filter(function(t){return t.group===e})},e.prototype.getAll=function(e){return void 0===e&&(e="BOTH"),"ARRAY"===e?this.bmd.array:"OBJECT"==e?this.bmd.object:{object:this.bmd.object,array:this.bmd.array}},e.prototype.takeSnapshot=function(){return this.game.canvas.toDataURL()},e}(),PHASER_BUTTON_MANAGER=function(){function e(){this.game=null,this.resources={array:[],object:{}}}return e.prototype.assign=function(e){this.game=e.game},e.prototype.add=function(e){if(0===this.resources.array.filter(function(t){return t.name===e.name}).length){var t=this.game.add.button(e.x,e.y,e.reference,e.onclick);return t.name=e.name,t.group=e.group||null,this.resources.array.push(t),this.resources.object[e.name]=t,t}console.log("Duplicate key name not allowed: "+e.name)},e.prototype.destroy=function(e){for(var t=[],a=0,n=this.resources.array.filter(function(t){return t.key===e});a<n.length;a++){var i=n[a];t.push(i.key),i.destroy()}return delete this.resources.object[e],this.resources.array=this.resources.array.filter(function(t){return t.key!==e}),t},e.prototype.destroyGroup=function(e){for(var t=[],a=0,n=this.resources.array.filter(function(t){return t.group===e});a<n.length;a++){var i=n[a];t.push(i.key),i.destroy()}return delete this.resources.object[e],this.resources.array=this.resources.array.filter(function(t){return t.group!==e}),t},e.prototype.get=function(e){return this.resources.object[e]},e.prototype.getGroup=function(e){return this.resources.array.filter(function(t){return t.group===e})},e.prototype.getAll=function(e){return void 0===e&&(e="BOTH"),"ARRAY"===e?this.resources.array:"OBJECT"==e?this.resources.object:{object:this.resources.object,array:this.resources.array}},e}(),PHASER_CONTROLS=function(){function e(){this.IO=null,this.game=null,this.buttonSensitivity={QUICK:1,SHORT:50,LONG:150,SUPERLONG:300},this.releasedKeys=[],this.properties={isReady:!1,allowDebugger:!0,buttonDelay:50,timingRefreshRate:1},this.directionalButtons=["UP","DOWN","LEFT","RIGHT"],this.actionButtons=["A","B","X","Y"],this.triggerButtons=["L1","L2","R1","R2","L3","R3"],this.systemButtons=["START","BACK"],this.buttonArray=this.directionalButtons.concat(this.actionButtons,this.triggerButtons,this.systemButtons),this.buttonMap={UP:{name:"UP",code:"ArrowUp"},DOWN:{name:"DOWN",code:"ArrowDown"},LEFT:{name:"LEFT",code:"ArrowLeft"},RIGHT:{name:"RIGHT",code:"ArrowRight"},A:{name:"A",code:"KeyA"},B:{name:"S",code:"KeyS"},X:{name:"D",code:"KeyD"},Y:{name:"F",code:"KeyF"},L1:{name:"Q",code:"KeyQ"},L2:{name:"W",code:"KeyW"},R1:{name:"E",code:"KeyE"},R2:{name:"R",code:"KeyR"},L3:{name:"O",code:"KeyO"},R3:{name:"P",code:"KeyP"},START:{name:"ENTER",code:"Enter"},BACK:{name:"BACKSPACE",code:"Backspace"}},this.buttonMapId={UP:1,DOWN:2,LEFT:3,RIGHT:4,A:5,B:6,X:7,Y:8,L1:9,L2:10,R1:11,R2:12,L3:13,R3:14,START:15,BACK:16},this.disabledButtons={ALL:!1,DIRECTIONAL:!1,TRIGGER:!1,ACTION:!1,SYSTEM:!1},this.debugger={enabled:!1,text:{}},this.inputDelay={delay:Array.apply(null,Array(20)).map(function(){return 0})}}return e.prototype.assign=function(e){var t=this;this.game=e;var a={font:"12px Courier New",fill:"#fff",align:"left"};this.buttonArray.forEach(function(n,i){t.debugger.text[n]=null,t.debugger.text[n]=e.add.text(10,10+15*i,"",a),t.disabledButtons[n]=!1});for(var n={buttons:{},sensitivityPress:{},sensitivityBuffer:{},state:{}},i=function(a){n.buttons[a]=e.input.keyboard.addKey(Phaser.Keyboard[o.buttonMap[a].name]),n.sensitivityPress[a]=null,n.sensitivityBuffer[a]=0,n.state[a]=function(){return t.getBtnPressType(t.IO.sensitivityBuffer[a])}},o=this,r=0,s=this.buttonArray;r<s.length;r++){i(s[r])}for(var l=function(e){n.buttons[e].onDown.add(function(a){var i,o;clearInterval(n.sensitivityPress[e]);var r=["DIRECTIONAL","ACTION","TRIGGER","SYSTEM"];Object.keys(t.buttonMap).forEach(function(e,n){if(t.buttonMap[e].code===a.event.code)for(var s=0,l=r;s<l.length;s++){var p=l[s];t[p.toLowerCase()+"Buttons"].indexOf(e)+1&&(i=p,o=e)}});var s=!1;t.disabledButtons.ALL&&(s=!0);for(var l=0,p=r;l<p.length;l++){var h=p[l];t.disabledButtons[h]&&i===h&&(s=!0)}Object.keys(t.buttonMap).forEach(function(e,a){t.disabledButtons[e]&&o===e&&(s=!0)}),s||(n.sensitivityPress[e]=setInterval(function(){n.sensitivityBuffer[e]+=1},t.properties.timingRefreshRate))},p)},p=this,h=0,u=this.buttonArray;h<u.length;h++){l(u[h])}return e.input.keyboard.onUpCallback=function(e){for(var a=0,i=t.buttonArray;a<i.length;a++){var o=i[a];e.code===t.buttonMap[o].code&&(t.releasedKeys.push(t.buttonMap[o].code),setTimeout(function(){t.releasedKeys.shift()},1500),clearInterval(n.sensitivityPress[o]),n.sensitivityBuffer[o]=0)}"Backquote"===e.code&&t.properties.allowDebugger&&(t.setDebugger(!t.debugger.enabled),t.updateDebugger())},this.properties.isReady=!0,this.IO=n,n},e.prototype.mapKeys=function(e){var t=this;this.properties.isReady=!1,this.destroyAll(),setTimeout(function(){t.buttonMap=e,t.properties.isReady=!0,t.assign(t.game)},1)},e.prototype.isReady=function(){return this.properties.isReady},e.prototype.checkWithDelay=function(e){return this.read(e.key).active===e.isActive&&(this.game.time.now>this.inputDelay.delay[this.getKeyId(e.key)]&&(this.inputDelay.delay[this.getKeyId(e.key)]=e.delay+this.game.time.now,!0))},e.prototype.isDebuggerEnabled=function(){return this.debugger.enabled},e.prototype.setDebugger=function(e){void 0===e&&(e=!0),this.debugger.enabled=e},e.prototype.updateDebugger=function(){if(this.properties.isReady)for(var e=0,t=this.buttonArray;e<t.length;e++){var a=t[e];this.debugger.text[a].setText(this.debugger.enabled?this.debuggerString(a):"").bringToTop()}},e.prototype.disableAllInput=function(){this.disabledButtons.ALL=!0},e.prototype.enableAllInput=function(){this.disabledButtons.ALL=!1},e.prototype.disableAllDirectionalButtons=function(){this.disabledButtons.DIRECTIONAL=!0},e.prototype.enableAllDirectionalButtons=function(){this.disabledButtons.DIRECTIONAL=!1},e.prototype.disableAllTriggerButtons=function(){this.disabledButtons.TRIGGER=!0},e.prototype.enableAllTriggerButtons=function(){this.disabledButtons.TRIGGER=!1},e.prototype.disableAllActionButtons=function(){this.disabledButtons.ACTION=!0},e.prototype.enableAllActionButtons=function(){this.disabledButtons.ACTION=!1},e.prototype.disableAllSystemButtons=function(){this.disabledButtons.SYSTEM=!0},e.prototype.enableAllSystemButtons=function(){this.disabledButtons.SYSTEM=!1},e.prototype.setDisableKeyProperty=function(e,t){void 0===t&&(t=!0),this.properties.isReady&&(this.disabledButtons[e.toUpperCase()]=t)},e.prototype.getKeyDisabledValue=function(e){return this.properties.isReady?this.disabledButtons[e.toUpperCase()]:null},e.prototype.clearAllControlIntervals=function(){if(this.properties.isReady)for(var e=0,t=this.buttonArray;e<t.length;e++){var a=t[e];clearInterval(this.IO.sensitivityPress[a])}},e.prototype.getKeyId=function(e){return this.buttonMapId[e.toUpperCase()]},e.prototype.read=function(e){if(this.properties.isReady){return{}[e]={id:this.buttonMapId[e.toUpperCase()],active:this.IO.state[e.toUpperCase()]().val>0,duration:this.IO.state[e.toUpperCase()]().val,state:this.IO.state[e.toUpperCase()]().state,type:this.IO.state[e.toUpperCase()]().type,disabled:this.disabledButtons[e.toUpperCase()]}}return{}},e.prototype.readMulti=function(e,t){if(void 0===t&&(t="OBJECT"),this.properties.isReady){if("OBJECT"===t){for(var a={},n=0,i=e;n<i.length;n++){a[s=i[n]]={id:this.buttonMapId[s.toUpperCase()],active:this.IO.state[s.toUpperCase()]().val>0,duration:this.IO.state[s.toUpperCase()]().val,state:this.IO.state[s.toUpperCase()]().state,type:this.IO.state[s.toUpperCase()]().type,disabled:this.disabledButtons[s.toUpperCase()]}}return a}if("ARRAY"===t){a=[];for(var o=0,r=e;o<r.length;o++){var s=r[o];a.push({id:this.buttonMapId[s.toUpperCase()],key:s,active:this.IO.state[s.toUpperCase()]().val>0,duration:this.IO.state[s.toUpperCase()]().val,state:this.IO.state[s.toUpperCase()]().state,type:this.IO.state[s.toUpperCase()]().type,disabled:this.disabledButtons[s.toUpperCase()]})}return a}}},e.prototype.getReleasedKeys=function(){return this.releasedKeys},e.prototype.getOnly=function(e){for(var t=this,a={},n=function(n){e.map(function(e){n===e&&(a[n]={id:t.buttonMapId[n.toUpperCase()],active:t.IO.state[n.toUpperCase()]().val>0,duration:t.IO.state[n.toUpperCase()]().val,state:t.IO.state[n.toUpperCase()]().state,type:t.IO.state[n.toUpperCase()]().type,disabled:t.disabledButtons[n.toUpperCase()]})})},i=0,o=this.buttonArray;i<o.length;i++){n(o[i])}return a},e.prototype.getAll=function(){for(var e={},t=0,a=this.buttonArray;t<a.length;t++){var n=a[t];e[n]={id:this.buttonMapId[n.toUpperCase()],active:this.IO.state[n.toUpperCase()]().val>0,duration:this.IO.state[n.toUpperCase()]().val,state:this.IO.state[n.toUpperCase()]().state,type:this.IO.state[n.toUpperCase()]().type,disabled:this.disabledButtons[n.toUpperCase()]}}return e},e.prototype.debuggerString=function(e){return e.toUpperCase()+" ("+this.buttonMap[e.toUpperCase()].name+"/"+this.buttonMap[e.toUpperCase()].code+") | id: "+this.buttonMapId[e.toUpperCase()]+" duration: "+this.IO.state[e.toUpperCase()]().val+" | state: "+this.IO.state[e.toUpperCase()]().state+" | type: "+this.IO.state[e.toUpperCase()]().type+" | disabled: "+this.disabledButtons[e.toUpperCase()]},e.prototype.getBtnPressType=function(e){var t=this,a="NONE",n=0,i=0;return Object.keys(this.buttonSensitivity).forEach(function(o){i++,e>t.buttonSensitivity[o]&&(a=o,n=i)}),{val:e,type:a,state:n}},e.prototype.destroyAll=function(){var e=this;this.clearAllControlIntervals(),Object.keys(this.debugger.text).forEach(function(t){e.debugger.text[t].destroy()})},e}(),PHASER_GROUP_MANAGER=function(){function e(){this.game=null,this.group={array:[],object:{}}}return e.prototype.assign=function(e,t){void 0===t&&(t=10),this.game=e;for(var a=0;a<=t;a++){var n=e.add.group();this.group.object[""+a]=n,this.group.array.push(n)}},e.prototype.layer=function(e){return this.group.object[e]},e.prototype.add=function(e,t){this.group.object[e].add(t)},e.prototype.addMany=function(e,t){var a=this;t.forEach(function(t){a.group.object[e].add(t)})},e}(),PHASER_MASTER=function(){function e(e){var t=this;this._game=e.game,this.resolution=e.resolution,this.states={BOOT:"BOOT",PRELOAD:"PRELOAD",READY:"READY"},this.currentState=this.states[0],this.variables={},setTimeout(function(){t._game.time.pausedTimeTotal=0,t._game.time.addToPausedTime=function(e){t._game.time.pausedTimeTotal+=e},t._game.time.returnTrueTime=function(){return t._game.time.now-t._game.time.pausedTimeTotal}},1)}return e.prototype.let=function(e,t){if(void 0===t&&(t=null),void 0===this.variables[e])return this.variables[e]=t;console.log("Cannot LET duplicate key in PHASER_MASTER: "+e)},e.prototype.forceLet=function(e,t){return void 0===t&&(t=null),this.variables[e]=t},e.prototype.delete=function(e){delete this.variables[e]},e.prototype.get=function(e){return void 0!==this.variables[e]?this.variables[e]:(console.log("Cannot GET a variable that does not exist in PHASER_MASTER."),null)},e.prototype.getAll=function(){return this.variables},e.prototype.getOnly=function(e){var t={},a=[];for(var n in this.variables)a.push({key:n,data:this.variables[n]});for(var i=function(n){a.filter(function(t){return t.key===e[n]}).map(function(e){t[e.key]=e.data})},o=0;o<e.length;o++)i(o);return t},e.prototype.changeState=function(e){void 0===e&&(e=null);var t=e.toUpperCase(),a=!1;return void 0===this.states[t]&&(this.states[t]=t,a=!0),this.currentState=t,{created:a,state:this.currentState}},e.prototype.getCurrentState=function(){return this.currentState},e.prototype.getStates=function(){return this.states},e.prototype.getResolution=function(){return this.resolution},e.prototype.checkState=function(e){return this.currentState===e.toUpperCase()},e.prototype.getState=function(){return{currentState:this.currentState}},e.prototype.game=function(){return this._game},e}(),PHASER_MOUSE=function(){function e(e){this.game=null,this.clickSensitvity={QUICK:1,SHORT:50,LONG:150,SUPERLONG:300},this.mouseMapping=[0,1,2],this.mouseMap={LEFT:0,MIDDLE:1,RIGHT:2},this.metrics={sensitivityPress:{},sensitivityBuffer:{},location:{},state:{}},this.properties={allowDebugger:!0,timingRefreshRate:1},this.inputDelay={delay:Array.apply(null,Array(2)).map(function(){return 0})},this.debugger={enabled:void 0!==e.showDebugger&&e.showDebugger,text:{},pointer:null}}return e.prototype.assign=function(e){var t=this;this.game=e;for(var a=function(e){n.metrics.sensitivityPress[e]=null,n.metrics.sensitivityBuffer[e]=0,n.metrics.location[e]={x:null,y:null},n.metrics.state[e]=function(){return t.getBtnPressType(t.metrics.sensitivityBuffer[e])}},n=this,i=0,o=this.mouseMapping;i<o.length;i++){a(o[i])}this.game.input.onDown.add(function(e){var a=t.checkMouseClick();clearInterval(t.metrics.sensitivityPress[a]),t.metrics.sensitivityPress[a]=setInterval(function(){t.metrics.sensitivityBuffer[a]+=1,t.metrics.location[a]={x:e.x,y:e.y}},t.properties.timingRefreshRate)}),this.game.input.onUp.add(function(e){var a=t.checkMouseClick();t.clearAllControlIntervals(),t.metrics.sensitivityBuffer[a]=0});var r={font:"12px Courier New",fill:"#fff",align:"left"};this.mouseMapping.forEach(function(e,a){t.debugger.text[e]=null,t.debugger.text[e]=t.game.add.text(5,t.game.height-35-15*a,"",r)}),this.debugger.pointer=this.game.add.text(5,this.game.height-20,"",r),e.canvas.oncontextmenu=function(e){e.preventDefault()}},e.prototype.checkMouseClick=function(){var e=0;return this.game.input.activePointer.leftButton.isDown&&(e=0),this.game.input.activePointer.middleButton.isDown&&(e=1),this.game.input.activePointer.rightButton.isDown&&(e=2),e},e.prototype.debuggerString=function(e){return"Button_"+e+" | {x: "+this.metrics.location[e].x+", y: "+this.metrics.location[e].y+"} | active: "+(this.metrics.sensitivityBuffer[e]>0)+" | state: "+this.metrics.state[e]().state+" | duration: "+this.metrics.state[e]().val+" | type: "+this.metrics.state[e]().type},e.prototype.setDebugger=function(e){void 0===e&&(e=!0),this.debugger.enabled=e},e.prototype.updateDebugger=function(){for(var e=0,t=this.mouseMapping;e<t.length;e++){var a=t[e];this.debugger.text[a].setText(this.debugger.enabled?this.debuggerString(a):"").bringToTop()}this.debugger.pointer.setText(this.debugger.enabled?"Pointer: {x: "+this.game.input.mousePointer.x+", y: "+this.game.input.mousePointer.y+"}":"").bringToTop()},e.prototype.clearAllControlIntervals=function(){for(var e=0,t=this.mouseMapping;e<t.length;e++){var a=t[e];this.metrics.sensitivityBuffer[a]=0,clearInterval(this.metrics.sensitivityPress[a])}},e.prototype.checkWithDelay=function(e){if(this.read(e.key).active===e.isActive){var t=this.mouseMap[e.key.toUpperCase()];return this.game.time.now>this.inputDelay.delay[t]&&(this.inputDelay.delay[t]=e.delay+this.game.time.now,!0)}return!1},e.prototype.read=function(e){void 0===e&&(e="LEFT");var t=this.mouseMap[e.toUpperCase()];return{id:t,x:this.metrics.location[t].x,y:this.metrics.location[t].y,active:this.metrics.sensitivityBuffer[t]>0,duration:this.metrics.sensitivityBuffer[t],state:this.metrics.state[t]().state,type:this.metrics.state[t]().type}},e.prototype.getBtnPressType=function(e){var t=this,a="NONE",n=0,i=0;return Object.keys(this.clickSensitvity).forEach(function(o){i++,e>t.clickSensitvity[o]&&(a=o,n=i)}),{val:e,type:a,state:n}},e}(),PHASER_PRELOADER=function(){function e(e){this.game=e.game,this.init(e.delayInSeconds,e.done)}return e.prototype.init=function(e,t){var a,n,i=this;this.game.load.onLoadStart.add(function(){(a=i.game.add.text(i.game.world.centerX,i.game.world.centerY/2,"",{font:"18px Impact",fill:"#fff",align:"center"})).anchor.set(.5),(n=i.game.add.text(i.game.world.centerX,i.game.world.centerY,"",{font:"32px Impact",fill:"#fff",align:"center"})).anchor.set(.5)},this),this.game.load.onFileComplete.add(function(e,t,i,o,r){a.setText("Please wait..."),n.setText(e+"%")},this),this.game.load.onLoadComplete.add(function(){a.setText("File loaded!"),n.setText(""),i.game.time.events.add(Phaser.Timer.SECOND*e,function(){a.destroy(),n.destroy(),t()},i).autoDestroy=!0},this)},e}(),PHASER_SPRITE_MANAGER=function(){function e(){this.game=null,this.sprites={array:[],object:{}},this.spriteCount=0}return e.prototype.assign=function(e){this.game=e},e.prototype.add=function(e){if(0===this.sprites.array.filter(function(t){return t.name===e.name}).length){e.x=void 0!==e.x?e.x:0,e.y=void 0!==e.y?e.y:0,e.group=void 0!==e.group?e.group:null,e.org=void 0!==e.org?e.org:null,e.visible=void 0===e.visible||e.visible,e.alpha=void 0!==e.alpha?e.alpha:1,e.width=void 0!==e.width?e.width:null,e.height=void 0!==e.height?e.height:null;var t=this.game.add.sprite(e.x,e.y,e.reference);return t.name=e.name,t.group=e.group,t.org=e.org,t.defaultPosition={x:e.x,y:e.y},t.visible=e.visible,t.alpha=e.alpha,null!==e.width&&(t.width=e.width),null!==e.height&&(t.height=e.height),t.setDefaultPositions=function(e,t){this.defaultPosition.x=e||this.x,this.defaultPosition.y=t||this.y},t.getDefaultPositions=function(){return this.defaultPosition},t.init=function(){},t.onUpdate=function(){},t.reveal=function(){},t.show=function(){this.visible=!0},t.hide=function(){this.visible=!1},this.sprites.array.push(t),this.sprites.object[e.name]=t,t}console.log("Duplicate key name not allowed: "+e.name)},e.prototype.addFromAtlas=function(e){if(0===this.sprites.array.filter(function(t){return t.name===e.name}).length){e.x=void 0!==e.x?e.x:0,e.y=void 0!==e.y?e.y:0,e.group=void 0!==e.group?e.group:null,e.org=void 0!==e.org?e.org:null,e.visible=void 0===e.visible||e.visible,e.alpha=void 0!==e.alpha?e.alpha:1,e.width=void 0!==e.width?e.width:null,e.height=void 0!==e.height?e.height:null;var t=this.game.add.sprite(e.x,e.y,e.atlas,e.filename);return t.name=e.name,t.group=e.group,t.org=e.org,t.defaultPosition={x:e.x,y:e.y},t.visible=e.visible,t.alpha=e.alpha,null!==e.width&&(t.width=e.width),null!==e.height&&(t.height=e.height),t.setDefaultPositions=function(e,t){this.defaultPosition.x=e||this.x,this.defaultPosition.y=t||this.y},t.getDefaultPositions=function(){return this.defaultPosition},t.init=function(){},t.onUpdate=function(){},t.reveal=function(){},t.show=function(){this.visible=!0},t.hide=function(){this.visible=!1},this.sprites.array.push(t),this.sprites.object[e.name]=t,t}console.log("Duplicate key name not allowed: "+e.name)},e.prototype.addTilespriteFromAtlas=function(e){if(0===this.sprites.array.filter(function(t){return t.name===e.name}).length){e.x=void 0!==e.x?e.x:0,e.y=void 0!==e.y?e.y:0,e.group=void 0!==e.group?e.group:null,e.org=void 0!==e.org?e.org:null,e.visible=void 0===e.visible||e.visible,e.alpha=void 0!==e.alpha?e.alpha:1,e.width=void 0!==e.width?e.width:null,e.height=void 0!==e.height?e.height:null;var t=this.game.add.tileSprite(e.x,e.y,e.width,e.height,e.atlas,e.filename);return t.name=e.name,t.group=e.group,t.org=e.org,t.defaultPosition={x:e.x,y:e.y},t.visible=e.visible,t.alpha=e.alpha,null!==e.width&&(t.width=e.width),null!==e.height&&(t.height=e.height),t.setDefaultPositions=function(e,t){this.defaultPosition.x=e||this.x,this.defaultPosition.y=t||this.y},t.getDefaultPositions=function(){return this.defaultPosition},t.init=function(){},t.onUpdate=function(){},t.reveal=function(){},t.show=function(){this.visible=!0},t.hide=function(){this.visible=!1},this.sprites.array.push(t),this.sprites.object[e.name]=t,t}console.log("Duplicate key name not allowed: "+e.name)},e.prototype.addEmptySprite=function(e){if(0===this.sprites.array.filter(function(t){return t.name===e.name}).length){e.x=void 0!==e.x?e.x:0,e.y=void 0!==e.y?e.y:0,e.group=void 0!==e.group?e.group:null,e.org=void 0!==e.org?e.org:null,e.visible=void 0===e.visible||e.visible,e.alpha=void 0!==e.alpha?e.alpha:1,e.width=void 0!==e.width?e.width:null,e.height=void 0!==e.height?e.height:null;var t=this.game.add.sprite(e.x,e.y);return t.name=e.name,t.group=e.group,t.org=e.org,t.defaultPosition={x:e.x,y:e.y},t.visible=e.visible,t.alpha=e.alpha,null!==e.width&&(t.width=e.width),null!==e.height&&(t.height=e.height),t.setDefaultPositions=function(e,t){this.defaultPosition.x=e||this.x,this.defaultPosition.y=t||this.y},t.getDefaultPositions=function(){return this.defaultPosition},t.init=function(){},t.onUpdate=function(){},t.reveal=function(){},t.show=function(){this.visible=!0},t.hide=function(){this.visible=!1},this.sprites.array.push(t),this.sprites.object[e.name]=t,t}console.log("Duplicate key name not allowed: "+e.name)},e.prototype.createBasicMask=function(e,t,a,n){var i=this.game.add.graphics(0,0);return i.beginFill(16777215),i.drawRect(e,t,a,n),i},e.prototype.addBasicMaskToSprite=function(e){var t=this.game.add.graphics(0,0);return t.beginFill(16777215),t.drawRect(e.x,e.y,e.width,e.height),e.mask=t,t},e.prototype.destroy=function(e){if(void 0!==this.sprites.object[e]){for(var t=[],a=0,n=this.sprites.array.filter(function(t){return t.name===e});a<n.length;a++){var i=n[a];t.push(i.name),i.destroy()}return delete this.sprites.object[e],this.sprites.array=this.sprites.array.filter(function(t){return t.name!==e}),t}return console.log("Cannot delete "+e+" because it does not exist."),null},e.prototype.destroyGroup=function(e){for(var t=[],a=0,n=this.sprites.array.filter(function(t){return t.group===e});a<n.length;a++){var i=n[a];t.push(i.name),i.destroy()}return delete this.sprites.object[e],this.sprites.array=this.sprites.array.filter(function(t){return t.group!==e}),t},e.prototype.get=function(e){return this.sprites.object[e]},e.prototype.getGroup=function(e){return this.sprites.array.filter(function(t){return t.group===e||t.org===e})},e.prototype.getManyGroups=function(e){for(var t=[],a=function(a){var i=n.sprites.array.filter(function(t){return t.group===e[a]||t.org===e[a]});t=t.concat(i)},n=this,i=0;i<e.length;i++)a(i);return t},e.prototype.getOnly=function(e){for(var t={},a=function(a){n.sprites.array.filter(function(t){return t.group===e[a]||t.name===e[a]}).map(function(e){t[e.name]=e})},n=this,i=0;i<e.length;i++)a(i);return t},e.prototype.getAll=function(e){return void 0===e&&(e="OBJECT"),"ARRAY"===e?this.sprites.array:"OBJECT"==e?this.sprites.object:{object:this.sprites.object,array:this.sprites.array}},e.prototype.count=function(){return this.spriteCount++,{total:this.sprites.array.length,unique:this.spriteCount}},e.prototype.centerWorld=function(e){if(void 0===this.sprites.object[e])return console.log("Error centering sprite:  key does not exists."),null;var t=this.sprites.object[e];return t.alignIn(this.game.world.bounds,Phaser.CENTER),t},e.prototype.centerOnPoint=function(e,t,a){if(void 0===this.sprites.object[e])return console.log("Error centering sprite:  key does not exists."),null;var n=this.sprites.object[e];return n.x=t-n.width/2,n.y=a-n.height/2,n},e}(),PHASER_TEXT_MANAGER=function(){function e(){this.game=null,this.texts={array:[],object:{}}}return e.prototype.assign=function(e){this.game=e},e.prototype.add=function(e){var t=this.texts.array.filter(function(t){return t.name===e.name});if(e.x=void 0!==e.x?e.x:0,e.y=void 0!==e.y?e.y:0,e.group=void 0!==e.group?e.group:null,e.size=void 0!==e.size?e.size:12,e.default=void 0!==e.default?e.default:"",e.visible=void 0===e.visible||e.visible,e.alpha=void 0!==e.alpha?e.alpha:1,0===t.length){var a=this.game.add.bitmapText(e.x,e.y,e.font,e.default,e.size);return a.name=e.name,a.group=e.group,a.visible=e.visible,a.alpha=e.alpha,a.init=function(){},a.show=function(){this.visible=!0},a.hide=function(){this.visible=!1},this.texts.array.push(a),this.texts.object[e.name]=a,a}console.log("Duplicate key name not allowed: "+e.name)},e.prototype.destroy=function(e){for(var t=[],a=0,n=this.texts.array.filter(function(t){return t.name===e});a<n.length;a++){var i=n[a];t.push(i.name),i.destroy()}return delete this.texts.object[e],this.texts.array=this.texts.array.filter(function(t){return t.name!==e}),t},e.prototype.destroyGroup=function(e){for(var t=[],a=0,n=this.texts.array.filter(function(t){return t.group===e});a<n.length;a++){var i=n[a];t.push(i.key),i.destroy()}return delete this.texts.object[e],this.texts.array=this.texts.array.filter(function(t){return t.group!==e}),t},e.prototype.get=function(e){return this.texts.object[e]},e.prototype.getGroup=function(e){return this.texts.array.filter(function(t){return t.group===e})},e.prototype.getManyGroups=function(e){for(var t=[],a=function(a){var i=n.texts.array.filter(function(t){return t.group===e[a]});t=t.concat(i)},n=this,i=0;i<e.length;i++)a(i);return t},e.prototype.getAll=function(e){return void 0===e&&(e="OBJECT"),"ARRAY"===e?this.texts.array:"OBJECT"==e?this.texts.object:{object:this.texts.object,array:this.texts.array}},e.prototype.getOnly=function(e){for(var t={},a=function(a){n.texts.array.filter(function(t){return t.group===e[a]||t.name===e[a]}).map(function(e){t[e.name]=e})},n=this,i=0;i<e.length;i++)a(i);return t},e.prototype.alignToBottomLeftCorner=function(e,t){if(void 0===t&&(t=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[e],n=this.game;return a.x=t,a.y=n.canvas.height-a.height-t,a},e.prototype.alignToBottomCenter=function(e,t){if(void 0===t&&(t=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[e],n=this.game;return a.x=n.canvas.width/2-a.width/2,a.y=n.canvas.height-a.height-t,a},e.prototype.alignToBottomRightCorner=function(e,t){if(void 0===t&&(t=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[e],n=this.game;return a.x=n.canvas.width-a.width-t,a.y=n.canvas.height-a.height-t,a},e.prototype.alignToCenterRight=function(e,t){if(void 0===t&&(t=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[e],n=this.game;return a.x=n.canvas.width-a.width-t,a.y=n.canvas.height/2-a.height/2,a},e.prototype.alignToTopRightCorner=function(e,t){if(void 0===t&&(t=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[e],n=this.game;return a.x=n.canvas.width-a.width-t,a.y=t,a},e.prototype.alignToTopCenter=function(e,t){if(void 0===t&&(t=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[e],n=this.game;return a.x=n.canvas.width/2-a.width/2-t,a.y=t,a},e.prototype.alignToTopLeftCorner=function(e,t){if(void 0===t&&(t=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[e];this.game;return a.x=t,a.y=t,a},e.prototype.alignToCenterLeft=function(e,t){if(void 0===t&&(t=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[e],n=this.game;return a.x=t,a.y=n.canvas.height/2-a.height/2,a},e.prototype.alignToCenter=function(e,t){if(void 0===t&&(t=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var a=this.texts.object[e],n=this.game;return a.x=n.canvas.width/2-a.width/2,a.y=n.canvas.height/2-a.height/2,a},e.prototype.center=function(e,t,a){if(void 0===t&&(t=0),void 0===a&&(a=0),void 0===this.texts.object[e])return console.log("Error centering sprite:  key does not exists."),null;var n=this.texts.object[e],i=this.game;return n.x=i.canvas.width/2-n.width/2+t,n.y=i.canvas.height/2-n.height/2+a,n},e}(),ENEMY_MANAGER=function(){function e(e){this.showHitbox=e.showHitbox}return e.prototype.assign=function(e,t,a,n,i,o,r,s){this.game=e,this.phaserSprites=a,this.phaserMaster=t,this.phaserTexts=n,this.phaserGroup=i,this.weaponManager=o,this.atlas=r,this.atlas_weapons=s},e.prototype.collisionCheck=function(e,t){this.phaserSprites.getManyGroups(["player_hitboxes"]).map(function(a){a.game.physics.arcade.overlap(e,a,function(e,a){a.parent.takeDamage(t),e.destroyIt()},null,e)})},e.prototype.facePlayer=function(e){var t=this.game,a=this.phaserSprites.getOnly(["player"]).player;return Math.ceil(360/(2*Math.PI)*t.math.angleBetween(e.x,e.y,a.x,a.y)-90)},e.prototype.bulletCollisionWithPlayer=function(e){var t=this.phaserSprites.getGroup("player_hitboxes").slice(),a=e.collidables.primaryWeapon.slice();this.game.physics.arcade.overlap(t,a,function(e,t){e.isInvincible||e.isDead||e.isDamaged||(e.parent.takeDamage(t.damgeOnImpact),t.destroyIt())})},e.prototype.createSmallEnemy1=function(e,t,a,n){var i=this;void 0===t&&(t=function(){}),void 0===a&&(a=function(){}),void 0===n&&(n=function(){});var o=this.game,r=(this.phaserMaster,this.phaserSprites),s=this.phaserGroup,l=this.atlas,p=r.addFromAtlas({name:"enemy_"+o.rnd.integer(),group:"enemies",org:"gameobjects",atlas:l,filename:"small_1",visible:!0});p.anchor.setTo(.5,.5),p.scale.setTo(1,1),p.maxHealth=100,p.health=p.maxHealth,p.pierceResistence=1,p.fallThreshold=o.rnd.integerInRange(0,75),p.cosWave={data:o.math.sinCosGenerator(200,.5*o.world.height,0,1).cos,count:0},p.sinWave={data:o.math.sinCosGenerator(o.rnd.integerInRange(200,300),1===o.rnd.integerInRange(0,1)?-50:50,1,3).sin,count:0},p.fireDelay=0,p.fireTimer=1e3,p.isInvincible=!1,p.isDamaged=!1,p.isDestroyed=!1,p.onLayer=e.layer,p.weaponSystems=[],p.collidables={primaryWeapon:[],secondaryWeapon:[]},s.add(e.layer,p);["small_1_hitbox_1"].map(function(e){var t=r.addFromAtlas({name:"enemy_hitbox_"+o.rnd.integer(),group:"enemy_hitboxes",atlas:l,filename:e,alpha:i.showHitbox?.75:0});t.anchor.setTo(.5,.5),o.physics.enable(t,Phaser.Physics.ARCADE),p.addChild(t)});var h=this.weaponManager.enemyBullet(3);h.bulletSpeedVariance=100,h.bulletAngleVariance=20,h.bullets.children.map(function(e){e.damgeOnImpact=10});var u=Phaser.Animation.generateFrameNames("bullet_fire_",1,4).slice(),d=this.phaserSprites.addFromAtlas({name:"enemy_weapons_"+this.game.rnd.integer(),group:"enemy_weapons",atlas:this.atlas_weapons,filename:u[0],visible:!0});return d.anchor.setTo(.5,.5),d.angle=180,d.animations.add("fireWeapon",u,1,!0),d.sync=function(e){var t=e.x,a=e.y;d.x=t,d.y=a},d.destroyIt=function(){var e=d.x,t=d.y;i.weaponManager.blueImpact(e,t,1,p.onLayer),i.phaserSprites.destroy(d.name),o.time.events.add(4*Phaser.Timer.SECOND,function(){d.ammo.destroy()},i).autoDestroy=!0},d.onUpdate=function(){h.onUpdate()},d.fire=function(){var e=r.get("player");e.isInvincible||e.isDead?(h.checkOrientation(d),h.fire(d)):h.fire(d,e.x,e.y),d.animations.play("fireWeapon",24,!1)},s.add(e.layer+1,d),d.ammo=h,p.weaponSystems.push(d),p.collidables.primaryWeapon=[],p.collidables.primaryWeapon.push(h.bullets),p.onUpdate=function(){r.get("player");n(p),p.angle=i.facePlayer(p),p.weaponSystems.map(function(e){e.angle=i.facePlayer(p)-180}),o.time.returnTrueTime()>p.fireDelay&&!p.isDestroyed&&p.y>.3*p.game.canvas.height&&(p.fireDelay=o.time.returnTrueTime()+p.fireTimer,p.weaponSystems.map(function(e){d.fire()})),p.isDestroyed?p.inPlace=!0:(p.y=-p.cosWave.data[p.cosWave.count]-p.height,p.x=p.sinWave.data[p.sinWave.count]+e.x,p.cosWave.count++,p.sinWave.count++,p.cosWave.count>=p.cosWave.data.length&&p.removeIt(),p.weaponSystems.map(function(e){e.sync(p)})),i.bulletCollisionWithPlayer(p)},p.damageIt=function(e){t(p),p.isDamaged=!0,o.time.events.add(150,function(){p.isDamaged=!1},i).autoDestroy=!0,p.health-=e,p.tint=16711680,p.game.add.tween(p).to({tint:16777215},100,Phaser.Easing.Linear.Out,!0,0,0,!1),p.health<=0&&p.destroyIt()},p.removeIt=function(){p.weaponSystems.map(function(e){e.destroyIt()}),p.children.map(function(e){i.phaserSprites.destroy(e.name)}),r.destroy(p.name)},p.destroyIt=function(){p.isDestroyed=!0,p.tint=16711680,p.weaponSystems.map(function(e){e.destroyIt()}),p.explodeInterval=o.time.events.loop(250,function(){i.weaponManager.createExplosion(p.x+o.rnd.integerInRange(-p.width/2,p.width/2),p.y+o.rnd.integerInRange(-p.height/2,p.height/2),1,p.onLayer+1)}),p.game.add.tween(p).to({y:p.y+100,alpha:.5},750,Phaser.Easing.Linear.Out,!0,100,0,!1).onComplete.add(function(){a(p),o.time.events.remove(p.explodeInterval),p.children.map(function(e){i.phaserSprites.destroy(e.name)}),r.destroy(p.name)})},p},e.prototype.createBigEnemy1=function(e,t,a,n,i){var o=this;void 0===t&&(t=function(){}),void 0===a&&(a=function(){}),void 0===n&&(n=function(){}),void 0===i&&(i=function(){});var r=this.game,s=(this.phaserMaster,this.phaserSprites),l=this.phaserGroup,p=this.atlas,h=s.addFromAtlas({x:e.x,name:"enemy_"+r.rnd.integer(),group:"enemies",org:"gameobjects",atlas:p,filename:"big_1",visible:!0});h.anchor.setTo(.5,.5),h.scale.setTo(1,1),r.physics.enable(h,Phaser.Physics.ARCADE),h.atTarget=!1,h.maxHealth=1500,h.health=h.maxHealth,h.pierceResistence=4,h.fallThreshold=r.rnd.integerInRange(0,75),h.sinWave=r.math.sinCosGenerator(400+e.y,r.world.height/2,1,1),h.count=0,h.fireDelay=0,h.fireTimer=500,h.inPlace=!1,h.isDestroyed=!1,h.onLayer=e.layer,l.add(e.layer,h);return["big_1_hitbox_1","big_1_hitbox_2"].map(function(e){var t=s.addFromAtlas({name:"enemy_hitbox_"+r.rnd.integer(),group:"enemy_hitboxes",atlas:p,filename:e,alpha:o.showHitbox?.75:0});t.anchor.setTo(.5,.5),r.physics.enable(t,Phaser.Physics.ARCADE),h.addChild(t)}),h.damageIt=function(e){t(h),h.atTarget||(h.health-=e,h.tint=16711680,h.game.add.tween(h).to({tint:16777215},100,Phaser.Easing.Linear.Out,!0,0,0,!1),h.health<=0&&h.destroyIt())},h.removeIt=function(){s.destroy(h.name)},h.destroyIt=function(){h.children.map(function(e){o.phaserSprites.destroy(e.name)}),h.isDestroyed||(h.isDestroyed=!0,h.tint=16711680,h.explodeInterval=r.time.events.loop(100,function(){o.weaponManager.createExplosion(h.x+r.rnd.integerInRange(-h.width/2,h.width/2),h.y+r.rnd.integerInRange(-h.height/2,h.height/2),1,h.onLayer+1)}),h.game.add.tween(h).to({y:h.y-15,alpha:.5},750,Phaser.Easing.Linear.Out,!0,100,0,!1).onComplete.add(function(){r.time.events.remove(h.explodeInterval),a(h),o.weaponManager.createExplosion(h.x,h.y,1,e.layer+1),s.destroy(h.name)}))},h.onUpdate=function(){i(h),r.time.returnTrueTime()>h.fireDelay&&h.inPlace&&(h.fireDelay=r.time.returnTrueTime()+h.fireTimer),!h.isDestroyed&&h.count<h.sinWave.cos.length/2?(h.y=-h.sinWave.cos[h.count]-h.height,h.count++):h.inPlace=!0},h.removeIt=function(){s.destroy(h.name)},h},e.prototype.createAsteroid=function(e,t,a,n,i){var o=this;void 0===t&&(t=function(){}),void 0===a&&(a=function(){}),void 0===n&&(n=function(){}),void 0===i&&(i=function(){});var r=this.game,s=(this.phaserMaster,this.phaserSprites),l=this.phaserGroup,p=this.atlas,h=s.addFromAtlas({x:e.x,y:e.y,name:"enemy_"+r.rnd.integer(),group:"enemies",org:"gameobjects",atlas:p,filename:"asteroid_mid_layer_"+r.rnd.integerInRange(1,3),visible:!0});h.anchor.setTo(.5,.5),h.scale.setTo(1.5,1.5),r.physics.enable(h,Phaser.Physics.ARCADE),h.body.velocity.y=e.iy,h.body.velocity.x=e.ix,h.angleMomentum=r.rnd.integerInRange(-5,5),h.body.bounce.setTo(1,1),h.atTarget=!1,h.maxHealth=150,h.health=h.maxHealth,h.pierceResistence=4,h.fallThreshold=r.rnd.integerInRange(0,75),l.add(e.layer,h);return["1_hitbox_1","1_hitbox_2"].map(function(e){var t=s.addFromAtlas({name:"enemy_hitbox_"+r.rnd.integer(),group:"enemy_hitboxes",atlas:p,filename:e,alpha:o.showHitbox?.75:0});t.anchor.setTo(.5,.5),t.destroyIt=function(e){e.body=null,o.phaserSprites.destroy(e.name)},r.physics.enable(t,Phaser.Physics.ARCADE),h.addChild(t)}),h.damageIt=function(e,a){void 0===a&&(a=null),t(h),h.atTarget||(h.health-=e,h.tint=16711680,h.game.add.tween(h).to({tint:16777215},100,Phaser.Easing.Linear.Out,!0,0,0,!1),h.health<=0&&h.destroyIt())},h.destroyIt=function(){var t={angle:r.rnd.integerInRange(-720,720),x:h.x-r.rnd.integerInRange(-25,25),y:h.y-r.rnd.integerInRange(5,25),alpha:.5};h.game.add.tween(h).to(t,r.rnd.integerInRange(150,500),Phaser.Easing.Linear.Out,!0,0,0,!1),h.body=null,r.time.events.add(Phaser.Timer.SECOND/2,function(){a(h),o.weaponManager.createExplosion(h.x,h.y,1,e.layer+1),s.destroy(h.name)},h).autoDestroy=!0},h.fallToPlanet=function(){h.tint=0,h.atTarget=!0,h.body=null,h.game.add.tween(h).to({y:h.y+60},2*Phaser.Timer.SECOND,Phaser.Easing.Linear.In,!0,0).autoDestroy=!0,r.time.events.add(350,function(){o.game.add.tween(h.scale).to({x:0,y:0},1*Phaser.Timer.SECOND,Phaser.Easing.Linear.In,!0,r.rnd.integerInRange(0,500)).onComplete.add(function(){n(h),h.removeIt(),o.weaponManager.createExplosion(h.x,h.y,.25,6)}).autoDestroy=!0}).autoDestroy=!0},h.checkLocation=function(){h.angle+=h.angleMomentum,h.angleMomentum>0&&(h.angleMomentum-=.002),h.angleMomentum<0&&(h.angleMomentum+=.002),h.y>h.height&&null!==h.body&&(h.body.collideWorldBounds=!0),h.y>o.game.canvas.height-(75+h.fallThreshold)&&(null===h.body||h.atTarget||(h.body.collideWorldBounds=!1,h.fallToPlanet()))},h.onUpdate=function(){i(h),r.physics.arcade.collide([s.get("leftBoundry"),s.get("rightBoundry")],h),h.rotate+=2,h.atTarget||(null!==h.body&&(h.body.velocity.y+2<100&&(h.body.velocity.y+=2),h.body.velocity.x>0&&(h.body.velocity.x-=.2),h.body.velocity.x<0&&(h.body.velocity.x+=.2)),h.checkLocation())},h.removeIt=function(){s.destroy(h.name)},h},e.prototype.createDebris=function(e,t,a,n,i){var o=this;void 0===t&&(t=function(e){}),void 0===a&&(a=function(e){}),void 0===n&&(n=function(e){}),void 0===i&&(i=function(e){});var r=this.game,s=(this.phaserMaster,this.phaserSprites),l=this.phaserGroup,p=this.atlas,h=s.addFromAtlas({x:e.x,y:e.y,name:"enemy_"+r.rnd.integer(),group:"enemies",org:"gameobjects",atlas:p,filename:"asteroid_mid_layer_"+r.rnd.integerInRange(1,3),visible:!0});h.anchor.setTo(.5,.5),h.scale.setTo(1,1),r.physics.enable(h,Phaser.Physics.ARCADE),h.body.velocity.y=e.iy,h.body.velocity.x=e.ix,h.angleMomentum=r.rnd.integerInRange(-5,5),h.body.bounce.setTo(1,1),h.atTarget=!1,h.maxHealth=50,h.health=h.maxHealth,h.pierceResistence=1,h.fallThrehold=r.rnd.integerInRange(0,75),l.add(e.layer,h),h.damageIt=function(e,t){void 0===t&&(t=null),h.health-=e,h.tint=16711680,h.game.add.tween(h).to({tint:16777215},100,Phaser.Easing.Linear.Out,!0,0,0,!1),h.health<=0&&h.destroyIt(h)},h.removeIt=function(){s.destroy(h.name)},h.fallToPlanet=function(){h.tint=0,h.atTarget=!0,h.body=null,h.game.add.tween(h).to({y:h.y+60},2*Phaser.Timer.SECOND,Phaser.Easing.Linear.In,!0,0).autoDestroy=!0,r.time.events.add(350,function(){o.game.add.tween(h.scale).to({x:0,y:0},1*Phaser.Timer.SECOND,Phaser.Easing.Linear.In,!0,r.rnd.integerInRange(0,500)).onComplete.add(function(){n(h),h.removeIt(),o.weaponManager.createExplosion(h.x,h.y,.25,6)}).autoDestroy=!0}).autoDestroy=!0},h.destroyIt=function(){var e={angle:r.rnd.integerInRange(-720,720),x:h.x-r.rnd.integerInRange(-25,25),y:h.y-r.rnd.integerInRange(5,25),alpha:.5};h.game.add.tween(h).to(e,r.rnd.integerInRange(50,200),Phaser.Easing.Linear.Out,!0,0,0,!1),h.body=null,r.time.events.add(Phaser.Timer.SECOND/3,function(){a(h),o.weaponManager.createExplosion(h.x,h.y,.5,6),s.destroy(h.name)},h).autoDestroy=!0},h.checkLocation=function(){h.angle+=h.angleMomentum,h.angleMomentum>0&&(h.angleMomentum-=.002),h.angleMomentum<0&&(h.angleMomentum+=.002),h.y>h.height&&null!==h.body&&(h.body.collideWorldBounds=!0),h.y>o.game.canvas.height-(50+h.fallThrehold)&&(null===h.body||h.atTarget||(h.body.collideWorldBounds=!1,h.fallToPlanet())),h.y>o.game.canvas.height+h.height&&h.removeIt()},h.onUpdate=function(){r.physics.arcade.collide([s.get("leftBoundry"),s.get("rightBoundry")],h),h.rotate+=4,null!==h.body&&(h.body.velocity.y+1<50&&(h.body.velocity.y+=1),h.body.velocity.x>0&&(h.body.velocity.x-=.2),h.body.velocity.x<0&&(h.body.velocity.x+=.2)),h.checkLocation()}},e.prototype.createGiantAsteroid=function(e,t,a,n,i){var o=this;void 0===t&&(t=function(){}),void 0===a&&(a=function(){}),void 0===n&&(n=function(){}),void 0===i&&(i=function(){});var r=this.game,s=(this.phaserMaster,this.phaserSprites),l=this.phaserGroup,p=this.atlas,h=s.addFromAtlas({x:e.x,y:e.y,name:"enemy_"+r.rnd.integer(),group:"boss",atlas:p,filename:"asteroid_large_layer_"+r.rnd.integerInRange(1,3),visible:!0});return h.anchor.setTo(.5,.5),r.physics.enable(h,Phaser.Physics.ARCADE),h.body.velocity.y=e.iy,h.body.velocity.x=e.ix,h.angleMomentum=r.rnd.integerInRange(-5,5),h.body.bounce.setTo(1,1),h.atTarget=!1,h.maxHealth=5e3,h.health=h.maxHealth,h.pierceResistence=50,l.add(e.layer,h),h.damageIt=function(e,a){void 0===a&&(a=null),t(h),h.atTarget||(h.health-=e,h.tint=16711680,h.game.add.tween(h).to({tint:16777215},100,Phaser.Easing.Linear.Out,!0,0,0,!1),h.health<=0&&h.destroyIt())},h.destroyIt=function(e){void 0===e&&(e=!0);var t={angle:720,x:h.x-r.rnd.integerInRange(-10,10),y:h.y-r.rnd.integerInRange(10,10),alpha:.15};h.game.add.tween(h).to(t,2*Phaser.Timer.SECOND,Phaser.Easing.Linear.Out,!0,0,0,!1),h.game.add.tween(h.scale).to({x:.5,y:.5},2*Phaser.Timer.SECOND,Phaser.Easing.Linear.Out,!0,0,0,!1),h.body=null,r.time.events.add(Phaser.Timer.SECOND/2,function(){a(h),s.destroy(h.name)},h).autoDestroy=!0},h.fallToPlanet=function(){h.tint=0,h.atTarget=!0,h.body=null,h.game.add.tween(h).to({y:h.y+60},2*Phaser.Timer.SECOND,Phaser.Easing.Linear.In,!0,0).autoDestroy=!0,r.time.events.add(350,function(){o.game.add.tween(h.scale).to({x:0,y:0},1*Phaser.Timer.SECOND,Phaser.Easing.Linear.In,!0,r.rnd.integerInRange(0,500)).onComplete.add(function(){n(h),h.removeIt(),o.weaponManager.createExplosion(h.x,h.y,.25,6)}).autoDestroy=!0}).autoDestroy=!0},h.checkLocation=function(){h.angle+=h.angleMomentum,h.angleMomentum>0&&(h.angleMomentum-=.002),h.angleMomentum<0&&(h.angleMomentum+=.002),h.y>h.height&&null!==h.body&&(h.body.collideWorldBounds=!0),h.y>h.game.canvas.height-h.height&&(null===h.body||h.atTarget||(h.body.collideWorldBounds=!1,h.fallToPlanet()))},h.onUpdate=function(){i(h),r.physics.arcade.collide([s.get("leftBoundry"),s.get("rightBoundry")],h),h.rotate+=2,h.atTarget||(null!==h.body&&(h.body.velocity.y+1<25&&(h.body.velocity.y+=1),h.body.velocity.x>0&&(h.body.velocity.x-=.2),h.body.velocity.x<0&&(h.body.velocity.x+=.2)),h.checkLocation())},h.removeIt=function(){s.destroy(h.name)},h},e}(),ITEMSPAWN_MANAGER=function(){function e(){}return e.prototype.assign=function(e,t,a,n,i){this.game=e,this.phaserSprites=a,this.phaserMaster=t,this.phaserGroup=n,this.atlas=i},e.prototype.spawnHealthpack=function(e,t,a,n){var i=this;void 0===n&&(n=function(){});var o=Phaser.Animation.generateFrameNames("healthpack_",1,4).slice(),r=this.phaserSprites.addFromAtlas({name:"healthpack_"+this.game.rnd.integer(),group:"itemspawns",x:e,y:t,atlas:this.atlas,filename:o[0]});r.animations.add("animate",o,8,!0),r.animations.play("animate"),r.anchor.setTo(.5,.5),r.blinkLifespan=this.game.time.returnTrueTime()+10*Phaser.Timer.SECOND,r.blinkLifespanInterval=this.game.time.returnTrueTime(),r.blinkLifespanCount=0,this.game.physics.enable(r,Phaser.Physics.ARCADE),r.body.collideWorldBounds=!0,r.body.bounce.setTo(1,1),r.body.velocity.y=this.game.rnd.integerInRange(50,50),r.body.velocity.x=this.game.rnd.integerInRange(-200,200),r.destroyIt=function(){i.phaserSprites.destroy(r.name)},r.pickedUp=function(){i.phaserSprites.destroy(r.name)},r.onUpdate=function(){i.game.time.returnTrueTime()>r.blinkLifespan&&r.destroyIt(),i.game.time.returnTrueTime()>r.blinkLifespan-3*Phaser.Timer.SECOND&&i.game.time.returnTrueTime()>r.blinkLifespanInterval&&(r.blinkLifespanInterval=i.game.time.returnTrueTime()+200-5*r.blinkLifespanCount,r.alpha=r.blinkLifespanCount%2==0?.25:1,r.blinkLifespanCount++),i.phaserSprites.getManyGroups(["playership"]).map(function(e){e.game.physics.arcade.overlap(r,e,function(e,t){n(),r.pickedUp()},null,r)})},this.phaserGroup.add(a,r)},e.prototype.spawnPowerup=function(e,t,a,n){var i=this;void 0===n&&(n=function(){});var o=Phaser.Animation.generateFrameNames("powerup_",1,4).slice(),r=this.phaserSprites.addFromAtlas({name:"healthpack_"+this.game.rnd.integer(),group:"itemspawns",x:e,y:t,atlas:this.atlas,filename:o[0]});r.animations.add("animate",o,8,!0),r.animations.play("animate"),r.anchor.setTo(.5,.5),r.blinkLifespan=this.game.time.returnTrueTime()+10*Phaser.Timer.SECOND,r.blinkLifespanInterval=this.game.time.returnTrueTime(),r.blinkLifespanCount=0,this.game.physics.enable(r,Phaser.Physics.ARCADE),r.body.collideWorldBounds=!0,r.body.bounce.setTo(1,1),r.body.velocity.y=this.game.rnd.integerInRange(50,50),r.body.velocity.x=this.game.rnd.integerInRange(-200,200),r.destroyIt=function(){i.phaserSprites.destroy(r.name)},r.pickedUp=function(){i.phaserSprites.destroy(r.name)},r.onUpdate=function(){i.game.time.returnTrueTime()>r.blinkLifespan&&r.destroyIt(),i.game.time.returnTrueTime()>r.blinkLifespan-3*Phaser.Timer.SECOND&&i.game.time.returnTrueTime()>r.blinkLifespanInterval&&(r.blinkLifespanInterval=i.game.time.returnTrueTime()+200-5*r.blinkLifespanCount,r.alpha=r.blinkLifespanCount%2==0?.25:1,r.blinkLifespanCount++),i.phaserSprites.getManyGroups(["playership"]).map(function(e){e.game.physics.arcade.overlap(r,e,function(e,t){n(),r.pickedUp()},null,r)})},this.phaserGroup.add(a,r)},e.prototype.spawnSpecial=function(e,t,a,n){var i=this;void 0===n&&(n=function(){});var o=Phaser.Animation.generateFrameNames("special_",1,5).slice(),r=this.phaserSprites.addFromAtlas({name:"healthpack_"+this.game.rnd.integer(),group:"itemspawns",x:e,y:t,atlas:this.atlas,filename:o[0]});r.animations.add("animate",o,8,!0),r.animations.play("animate"),r.anchor.setTo(.5,.5),r.blinkLifespan=this.game.time.returnTrueTime()+10*Phaser.Timer.SECOND,r.blinkLifespanInterval=this.game.time.returnTrueTime(),r.blinkLifespanCount=0,this.game.physics.enable(r,Phaser.Physics.ARCADE),r.body.collideWorldBounds=!0,r.body.bounce.setTo(1,1),r.body.velocity.y=this.game.rnd.integerInRange(50,50),r.body.velocity.x=this.game.rnd.integerInRange(-200,200),r.destroyIt=function(){i.phaserSprites.destroy(r.name)},r.pickedUp=function(){i.phaserSprites.destroy(r.name)},r.onUpdate=function(){i.game.time.returnTrueTime()>r.blinkLifespan&&r.destroyIt(),i.game.time.returnTrueTime()>r.blinkLifespan-3*Phaser.Timer.SECOND&&i.game.time.returnTrueTime()>r.blinkLifespanInterval&&(r.blinkLifespanInterval=i.game.time.returnTrueTime()+200-5*r.blinkLifespanCount,r.alpha=r.blinkLifespanCount%2==0?.25:1,r.blinkLifespanCount++),i.phaserSprites.getManyGroups(["playership"]).map(function(e){e.game.physics.arcade.overlap(r,e,function(e,t){n(),r.pickedUp()},null,r)})},this.phaserGroup.add(a,r)},e}(),PLAYER_MANAGER=function(){function e(){}return e.prototype.assign=function(e,t,a,n,i,o,r,s,l){this.game=e,this.phaserSprites=a,this.phaserMaster=t,this.phaserTexts=n,this.phaserGroup=i,this.phaserControls=o,this.weaponManager=r,this.atlas=s,this.weaponAtlas=l,this.player=null},e.prototype.createShip=function(e,t,a,n,i){var o=this;void 0===t&&(t=function(){}),void 0===a&&(a=function(){}),void 0===n&&(n=function(){}),void 0===i&&(i=function(){});var r=this.game,s=(e.shipId,this.phaserMaster.getOnly(["gameData"]).gameData),l=this.phaserMaster.getOnly(["starMomentum"]).starMomentum,p=this.phaserSprites.addFromAtlas({name:e.name,group:e.group,org:e.org,atlas:this.atlas,filename:"ship_base_form",visible:!1});p.anchor.setTo(.5,.5),p.scale.setTo(1,1),p.isInvincible=!1,p.isDead=!0,p.isDamaged=!1,p.isForceMoved=!1,p.ignoreBoundaries=null,p.onLayer=e.layer,p.primaryWeapon=e.primaryWeapon,p.secondaryWeapon=e.secondaryWeapon,p.perk=e.perk,p.weaponSystems=[],p.subweaponSystems=[],p.attachments=[],p.collidables={primaryWeapon:[],secondaryWeapon:[]},p.xCapture=[],p.yCapture=[],p.clearEnemyBulletsInterval;var h=Phaser.Animation.generateFrameNames("ship_start_",1,7).slice(),u=Phaser.Animation.generateFrameNames("ship_explode_",1,5).slice(),d=Phaser.Animation.generateFrameNames("ship_explode_",6,7).slice();p.animations.add("shipDamage",["ship_damage","ship_damage","ship_damage","ship_damage","ship_start_7"],1,!0),p.animations.add("shipStart",h,1,!0),p.animations.add("preExplode",u,1,!0),p.animations.add("preExplodeLoop",d,1,!0),r.physics.enable(p,Phaser.Physics.ARCADE),this.phaserGroup.add(e.layer,p);["ship_hitbox_1","ship_hitbox_2"].map(function(e,t){var a=o.phaserSprites.addFromAtlas({y:10,name:"player_hitbox_"+t,group:"player_hitboxes",atlas:o.atlas,filename:e,alpha:0});a.anchor.setTo(.5,.5),r.physics.enable(a,Phaser.Physics.ARCADE),p.addChild(a)});var c=Phaser.Animation.generateFrameNames("ship_fullpower_",1,7).concat(Phaser.Animation.generateFrameNames("ship_fullpower__",1,7).reverse()),m=this.phaserSprites.addFromAtlas({name:"ship_fullpower_addon",atlas:this.atlas,filename:c[0],visible:!1});m.anchor.setTo(.5,.5),m.animations.add("fullpower",c,1,!0),m.animations.play("fullpower",45,!0),p.addChild(m);var y=Phaser.Animation.generateFrameNames("exhaust_",1,3),g=this.phaserSprites.addFromAtlas({y:45,name:"bottom_exhaust",atlas:this.atlas,filename:y[0],alpha:1});g.anchor.setTo(.5,.5),g.animations.add("animate",y,1,!0),g.animations.play("animate",12,!0),g.sync=function(e){var t=e.x,a=e.y,n=e.alpha,i=e.isDead;g.x=t,g.y=a+40,g.alpha=i?0:n,g.visible=l.y>=0},p.attachments.push(g),this.phaserGroup.add(e.layer-1,g);var f=this.phaserSprites.addFromAtlas({y:0,name:"top_exhaust",atlas:this.atlas,filename:y[0],alpha:1});return f.anchor.setTo(.5,.5),f.angle=180,f.animations.add("animate",y,1,!0),f.animations.play("animate",12,!0),f.sync=function(e){var t=e.x,a=e.y,n=e.alpha;f.x=t,f.y=a,f.alpha=e.isDead?0:n,f.visible=l.y<0},p.attachments.push(f),this.phaserGroup.add(e.layer-1,f),p.clearAllEnemyBullets=function(e){p.clearEnemyBulletsInterval=r.time.returnTrueTime()+e},p.onUpdate=function(){m.visible=s.player.powerup>=30,p.xCapture.length>0&&(p.x+=p.xCapture[0],p.xCapture.shift()),p.yCapture.length>0&&(p.y+=p.yCapture[0],p.yCapture.shift()),p.ignoreBoundaries||p.checkLimits(),p.isForceMoved;var e=[];p.weaponSystems.concat(p.subweaponSystems).map(function(t){t.angle=p.angle,t.onUpdate(),t.sync(p),e.push(t.ammo.bullets)}),o.bulletCollisionDetection(),p.attachments.map(function(e){e.sync(p)}),i(p)},p.restoreHealth=function(e){var a=o.phaserMaster.getOnly(["gameData"]).gameData.player.health+e;a>100&&(a=100),t(a)},p.takeDamage=function(e){a(p);var i=o.phaserMaster.getOnly(["gameData"]).gameData.player.health-e;t(i),i>0?(p.animations.play("shipDamage",45,!1),p.isDamaged=!0,r.time.events.add(250,function(){p.isDamaged=!1},o).autoDestroy=!0,p.tint=16711680,p.alpha=.75,p.game.add.tween(p).to({tint:16777215,alpha:1},10,Phaser.Easing.Linear.Out,!0,100,0,!1).onComplete.add(function(){r.time.events.add(500,function(){p.isInvincible=!1},o).autoDestroy=!0})):(p.isDestroyed(),n(p))},p.isDestroyed=function(e){void 0===e&&(e=!0),p.isDead=!0,p.isInvincible=!0,p.destroyWeaponSystems(),p.onUpdate(),o.weaponManager.createExplosion(p.x,p.y,1,6),r.add.tween(o).to({angle:r.rnd.integerInRange(-90,90),alpha:0},1e3,Phaser.Easing.Linear.In,!0,0).onComplete.add(function(){o.weaponManager.createExplosion(p.x,p.y,1,6),p.visible=!1})},p.destroyWeaponSystems=function(){p.weaponSystems.map(function(e){e.destroyIt(),e.ammo.destroy()}),p.weaponSystems=[]},p.attachPerk=function(t){o.attachPerk(p,e,t)},p.attachWeapon=function(t){var a;switch(t){case"BULLET":a=o.attachBullet(p,e,t);break;case"SPREAD":a=o.attachSpread(p,e,t);break;case"LASER":a=o.attachLaser(p,e,t);break;case"MISSLE":a=o.attachMissle(p,e,t);break;case"SHOTGUN":a=o.attachShotgun(p,e,t);break;case"GATLING":a=o.attachGatling(p,e,t)}p.collidables.primaryWeapon=[],a.map(function(e){p.collidables.primaryWeapon.push(e.ammo.bullets)})},p.attachSubweapon=function(t){var a;switch(t){case"CLUSTERBOMB":a=o.attachClusterbomb(p,e,t)}p.collidables.secondaryWeapon=[],a.map(function(e){p.collidables.secondaryWeapon.push(e.ammo.bullets),e.ammo.bomblets&&e.ammo.bomblets.map(function(e){p.collidables.secondaryWeapon.push(e.bullets)})})},p.fireWeapon=function(){p.weaponSystems.map(function(e){e.fire()})},p.fireSubweapon=function(){p.subweaponSystems.map(function(e){e.fire()})},p.regenerateHealth=function(e){void 0===e&&(e=!1)},p.moveX=function(e){p.xCapture[0]=e},p.moveY=function(e){p.yCapture[0]=e},p.checkLimits=function(){this.y-this.height<0&&(this.y=this.height),this.y+this.height>this.game.canvas.height&&(this.y=this.game.canvas.height-this.height),this.x<0&&(this.x=this.game.canvas.width+this.width),this.x>this.game.canvas.width+this.width&&(this.x=0)},p.moveTo=function(e,t,a,n){void 0===n&&(n=function(){}),p.isInvincible=!0,p.isForceMoved=!0,o.phaserControls.disableAllInput(),r.add.tween(p).to({x:e,y:t},a,Phaser.Easing.Exponential.InOut,!0,0,0,!1).onComplete.add(function(){p.isInvincible=!1,p.isForceMoved=!1,o.phaserControls.enableAllInput(),n()})},p.moveToStart=function(e){void 0===e&&(e=function(){}),p.isDead=!1,p.isInvincible=!0,p.ignoreBoundaries=!0,p.x=o.game.world.centerX,p.y=2*o.game.world.height,r.time.events.add(150,function(){p.alpha=1,p.visible=!0,r.add.tween(p).to({y:r.world.centerY+100},1e3,Phaser.Easing.Exponential.InOut,!0,0,0,!1).onComplete.add(function(){p.ignoreBoundaries=!1,o.phaserControls.enableAllInput(),p.attachWeapon(p.primaryWeapon),p.attachSubweapon(p.secondaryWeapon),p.animations.play("shipStart",12,!1),r.time.events.add(1e3,function(){p.isInvincible=!1,e()}).autoDestroy=!0})}).autoDestroy=!0},p.playEndSequence=function(e){p.isInvincible=!0,p.game.add.tween(p.scale).to({x:2,y:2},750,Phaser.Easing.Exponential.InOut,!0,0,0,!1),p.game.add.tween(p).to({x:r.world.centerX,y:r.world.centerY+50},750,Phaser.Easing.Exponential.InOut,!0,0,0,!1).onComplete.add(function(){p.game.add.tween(p).to({y:r.world.height+200},750,Phaser.Easing.Exponential.InOut,!0,100,0,!1).onComplete.add(function(){p.game.add.tween(p).to({y:-200},1e3,Phaser.Easing.Exponential.InOut,!0,0,0,!1).onComplete.add(function(){e()},p)},p)},p)},this.player=p,p},e.prototype.attachPerk=function(e,t,a){var n,i,o,r=this;switch(a){case"FIREPOWER":n=Phaser.Animation.generateFrameNames("firepower_",1,8).concat(Phaser.Animation.generateFrameNames("firepower_",1,8).reverse()),i=30;break;case"ARMORPLATING":n=["armor_plating"],i=30;break;case"REGEN":n=Phaser.Animation.generateFrameNames("shield_layer_",1,8).slice(),i=30}void 0!==this.phaserSprites.get(t.name+"_ship_perk")&&this.phaserSprites.destroy(t.name+"_ship_perk"),"REGEN"===a?((o=this.phaserSprites.addFromAtlas({name:t.name+"_ship_perk",atlas:this.atlas,filename:n[0],alpha:.5})).anchor.setTo(.5,.5),o.scale.set(1.25,1.25),o.tweenFadeIn=function(){r.game.add.tween(o).to({alpha:.8},1e3,Phaser.Easing.Linear.In,!0,8e3).onComplete.add(function(){e.regenerateHealth(!0),o.tweenFadeOut()})},o.tweenFadeOut=function(){r.game.add.tween(o).to({alpha:0},1e3,Phaser.Easing.Linear.In,!0,1e3).onComplete.add(function(){e.regenerateHealth(!1),o.tweenFadeIn()})},this.game.time.events.add(1e3,function(){void 0!==o&&o.tweenFadeOut()}).autoDestroy=!0,o.animations.add("animate",n,1,!0),o.animations.play("animate",i,!0),e.addChild(o)):((o=this.phaserSprites.addFromAtlas({name:t.name+"_ship_perk",atlas:this.atlas,filename:n[0],visible:!0})).anchor.setTo(.5,.5),o.animations.add("animate",n,1,!0),o.animations.play("animate",i,!0),e.addChild(o))},e.prototype.attachLaser=function(e,t,a){for(var n=this,i=Phaser.Animation.generateFrameNames("laser_fire_",1,6).slice(),o=function(o){var s=r.phaserSprites.addFromAtlas({name:"ship_weapon_"+r.game.rnd.integer(),atlas:r.weaponAtlas,filename:i[0],alpha:0});s.anchor.setTo(.5,.5),i.length>0&&s.animations.add("fireWeapon",i,1,!0),s.offset=35*o-70,s.index=o,s.onUpdate=function(){l.onUpdate()},s.sync=function(e){var t=e.x,a=e.y;s.x=t+s.offset,s.y=a},s.destroyIt=function(){var t=s.x,a=s.y;n.weaponManager.blueImpact(t,a,1,e.onLayer),n.phaserSprites.destroy(s.name)},s.fire=function(){var e=n.phaserMaster.getOnly(["gameData"]).gameData,t=Math.floor((e.player.powerup-1)/5);l.fireAngle=270+s.angle,0==t&&2===s.index&&(l.fireOffset(0,-32),i.length>0&&s.animations.play("fireWeapon",60,!1)),1!=t||1!==s.index&&3!==s.index||(l.fireOffset(0,-32),i.length>0&&s.animations.play("fireWeapon",60,!1)),2!=t||1!==s.index&&2!==s.index&&3!==s.index||(l.fireOffset(0,-32),i.length>0&&s.animations.play("fireWeapon",60,!1)),3!=t||0!==s.index&&1!==s.index&&3!==s.index&&4!==s.index||(l.fireOffset(0,-32),i.length>0&&s.animations.play("fireWeapon",60,!1)),t>=4&&(l.fireOffset(0,-32),i.length>0&&s.animations.play("fireWeapon",60,!1))},r.phaserGroup.add(t.layer+1,s);var l=r.weaponManager.playerBullets(4,a);l.checkOrientation(s.angle),l.onUpdate=function(){};var p=void 0;switch(o){case 0:p=0;break;case 1:p=-20;break;case 2:p=-40;break;case 3:p=-20;break;case 4:p=0}l.trackSprite(s,0,p),s.ammo=l,e.weaponSystems.push(s)},r=this,s=0;s<5;s++)o(s);return e.weaponSystems},e.prototype.attachShotgun=function(e,t,a){for(var n=this,i=Phaser.Animation.generateFrameNames("bullet_fire_",1,4).slice(),o=function(o){var s=r.phaserSprites.addFromAtlas({name:"ship_weapon_"+r.game.rnd.integer(),atlas:r.weaponAtlas,filename:i[0]});s.anchor.setTo(.5,.5),i.length>0&&s.animations.add("fireWeapon",i,1,!0),s.offset=20*o-0,s.index=o,s.onUpdate=function(){l.onUpdate()},s.sync=function(e){var t=e.x,a=e.y;s.x=t+s.offset,s.y=a},s.destroyIt=function(){var t=s.x,a=s.y;n.weaponManager.blueImpact(t,a,1,e.onLayer),n.phaserSprites.destroy(s.name)},s.fire=function(){for(var e=n.phaserMaster.getOnly(["gameData"]).gameData,t=Math.floor((e.player.powerup-1)/5),a=0;a<5*(t+1);a++)l.fireAngle=270+s.angle,l.fire(s,null,s+1);i.length>0&&s.animations.play("fireWeapon",60,!1)},r.phaserGroup.add(t.layer+1,s);var l=r.weaponManager.playerBullets(60,a);l.checkOrientation(s.angle),l.onUpdate=function(){},l.trackSprite(s,0,-20),s.ammo=l,e.weaponSystems.push(s)},r=this,s=0;s<1;s++)o(s);return e.weaponSystems},e.prototype.attachBullet=function(e,t,a){for(var n=this,i=Phaser.Animation.generateFrameNames("bullet_fire_",1,4).slice(),o=function(o){var s=r.phaserSprites.addFromAtlas({name:"ship_weapon_"+r.game.rnd.integer(),atlas:r.weaponAtlas,filename:i[0],alpha:0});s.anchor.setTo(.5,.5),i.length>0&&s.animations.add("fireWeapon",i,1,!0),s.offset=25*o-175,s.index=o,s.onUpdate=function(){l.onUpdate()},s.sync=function(e){var t=e.x,a=e.y;s.x=t+s.offset,s.y=a},s.destroyIt=function(){var t=s.x,a=s.y;n.weaponManager.blueImpact(t,a,1,e.onLayer),n.phaserSprites.destroy(s.name)},s.fire=function(){var e=n.phaserMaster.getOnly(["gameData"]).gameData,t=Math.floor((e.player.powerup-1)/5);l.fireAngle=270+s.angle,t>=0&&(6===s.index||8===s.index)&&(l.fireOffset(0,-35),i.length>0&&s.animations.play("fireWeapon",60,!1)),t>=1&&7===s.index&&(l.fireOffset(0,-25),i.length>0&&s.animations.play("fireWeapon",60,!1)),t>=2&&(5===s.index||9===s.index)&&(l.fireOffset(0,-15),i.length>0&&s.animations.play("fireWeapon",60,!1)),t>=3&&(4===s.index||10===s.index)&&(l.fireOffset(0,-5),i.length>0&&s.animations.play("fireWeapon",60,!1)),t>=4&&(3===s.index||11===s.index)&&(l.fireOffset(0,5),i.length>0&&s.animations.play("fireWeapon",60,!1)),t>=5&&(2===s.index||12===s.index)&&(l.fireOffset(0,15),i.length>0&&s.animations.play("fireWeapon",60,!1))},r.phaserGroup.add(t.layer+1,s);var l=r.weaponManager.playerBullets(4,a);l.checkOrientation(s.angle),l.onUpdate=function(){},l.trackSprite(s,0,-20),s.ammo=l,e.weaponSystems.push(s)},r=this,s=0;s<15;s++)o(s);return e.weaponSystems},e.prototype.attachSpread=function(e,t,a){for(var n=this,i=Phaser.Animation.generateFrameNames("bullet_fire_",1,4).slice(),o=this.phaserMaster.getOnly(["gameData"]).gameData,r=Math.floor((o.player.powerup-1)/5),s=5===r?2:1,l=function(o){var l=p.phaserSprites.addFromAtlas({name:"ship_weapon_"+p.game.rnd.integer(),atlas:p.weaponAtlas,filename:i[0]});l.anchor.setTo(.5,.5),i.length>0&&l.animations.add("fireWeapon",i,1,!0),l.offset=20*o-10*(s-1),l.onUpdate=function(){u.onUpdate()},l.sync=function(e){var t=e.x,a=e.y;l.x=t+l.offset,l.y=a},l.destroyIt=function(){var t=l.x,a=l.y;n.weaponManager.blueImpact(t,a,1,e.onLayer),n.phaserSprites.destroy(l.name)},l.fire=function(){var e=n.phaserMaster.getOnly(["gameData"]).gameData,t=Math.floor((e.player.powerup-1)/5);u.fire(l,null,l+1),t>=0&&(u.fire(l,l.x+30,l.y-200),u.fire(l,l.x-30,l.y-200)),t>=1&&(u.fire(l,l.x+60,l.y-200),u.fire(l,l.x-60,l.y-200)),t>=2&&(u.fire(l,l.x+90,l.y-200),u.fire(l,l.x-90,l.y-200)),t>=3&&(u.fire(l,l.x+120,l.y-200),u.fire(l,l.x-120,l.y-200)),t>=4&&(u.fire(l,l.x+150,l.y-200),u.fire(l,l.x-150,l.y-200)),t>=5&&(u.fire(l,l.x+180,l.y-200),u.fire(l,l.x-180,l.y-200)),i.length>0&&l.animations.play("fireWeapon",60,!1)},p.phaserGroup.add(t.layer+1,l);var h=12*(r+2),u=p.weaponManager.playerBullets(h,a);u.checkOrientation(l.angle),u.onUpdate=function(){},l.ammo=u,e.weaponSystems.push(l)},p=this,h=0;h<s;h++)l(h);return e.weaponSystems},e.prototype.attachMissle=function(e,t,a){for(var n=this,i=Phaser.Animation.generateFrameNames("missle_fire_",1,4).slice(),o=this.phaserMaster.getOnly(["gameData"]).gameData,r=Math.floor((o.player.powerup-1)/5),s=5===r?2:1,l=function(o){var l=p.phaserSprites.addFromAtlas({name:"ship_weapon_"+p.game.rnd.integer(),atlas:p.weaponAtlas,filename:i[0],visible:!0});l.anchor.setTo(.5,.5),i.length>0&&l.animations.add("fireWeapon",i,1,!0),l.offset=20*o-10*(s-1),l.onUpdate=function(){u.onUpdate()},l.sync=function(e){var t=e.x,a=e.y;l.x=t+l.offset,l.y=a},l.destroyIt=function(){var t=l.x,a=l.y;n.weaponManager.blueImpact(t,a,1,e.onLayer),n.phaserSprites.destroy(l.name)},l.fire=function(){var e=n.phaserMaster.getOnly(["gameData"]).gameData,t=Math.floor((e.player.powerup-1)/5);u.fireAngle=270+l.angle,u.fire(l),t>=0&&(u.fire(l),u.fire(l)),t>=1&&(u.fire(l),u.fire(l)),t>=3&&(u.fire(l),u.fire(l)),t>=4&&(u.fire(l),u.fire(l)),t>=5&&(u.fire(l),u.fire(l)),i.length>0&&l.animations.play("fireWeapon",60,!1)},p.phaserGroup.add(t.layer+1,l);var h=8*(r+2),u=p.weaponManager.playerBullets(h,a);u.checkOrientation(l.angle),u.onUpdate=function(){},l.ammo=u,e.weaponSystems.push(l)},p=this,h=0;h<s;h++)l(h);return e.weaponSystems},e.prototype.attachGatling=function(e,t,a){for(var n=this,i=Phaser.Animation.generateFrameNames("missle_fire_",1,4).slice(),o=this.phaserMaster.getOnly(["gameData"]).gameData,r=(Math.floor((o.player.powerup-1)/5),function(o){var r=s.phaserSprites.addFromAtlas({name:"ship_weapon_"+s.game.rnd.integer(),atlas:s.weaponAtlas,filename:i[0],visible:!0});r.anchor.setTo(.5,.5),i.length>0&&r.animations.add("fireWeapon",i,1,!0),r.offset=20*o-0,r.onUpdate=function(){l.onUpdate()},r.sync=function(e){var t=e.x,a=e.y;r.x=t+r.offset,r.y=a},r.destroyIt=function(){var t=r.x,a=r.y;n.weaponManager.blueImpact(t,a,1,e.onLayer),n.phaserSprites.destroy(r.name)},r.fire=function(){var e=n.phaserMaster.getOnly(["gameData"]).gameData,t=Math.floor((e.player.powerup-1)/5);l.fireAngle=270+r.angle,l.fire(r,null,r+1),t>=1&&(n.game.time.events.add(50,function(){l.fire(r,null,r+20)}).autoDestroy=!0),t>=2&&(n.game.time.events.add(100,function(){l.fire(r,null,r-20)}).autoDestroy=!0),t>=3&&(n.game.time.events.add(150,function(){l.fire(r,null,r+20)}).autoDestroy=!0),t>=4&&(n.game.time.events.add(200,function(){l.fire(r,null,r-20)}).autoDestroy=!0),t>=5&&(n.game.time.events.add(50,function(){l.fire(r,null,r-20)}).autoDestroy=!0),i.length>0&&r.animations.play("fireWeapon",60,!1)},s.phaserGroup.add(t.layer+1,r);var l=s.weaponManager.playerBullets(45,a);l.checkOrientation(r.angle),l.onUpdate=function(){},r.ammo=l,e.weaponSystems.push(r)}),s=this,l=0;l<1;l++)r(l);return e.weaponSystems},e.prototype.attachClusterbomb=function(e,t,a){var n=this,i=Phaser.Animation.generateFrameNames("laser_fire_",1,6).slice(),o=this.phaserSprites.addFromAtlas({name:"ship_weapon_"+this.game.rnd.integer(),atlas:this.weaponAtlas,filename:i[0]});o.anchor.setTo(.5,.5),i.length>0&&o.animations.add("fireWeapon",i,1,!0),o.onUpdate=function(){r.onUpdate()},o.sync=function(e){var t=e.x,a=e.y;o.x=t,o.y=a},o.destroyIt=function(){var t=o.x,a=o.y;n.weaponManager.blueImpact(t,a,1,e.onLayer),n.phaserSprites.destroy(o.name)},o.fire=function(){r.fireOffset(0,-32)},this.phaserGroup.add(t.layer+1,o);var r=this.weaponManager.createClusterbomb(4,function(){e.clearAllEnemyBullets(2*Phaser.Timer.SECOND)});return r.onUpdate=function(){},r.trackSprite(o,0,0),o.ammo=r,e.subweaponSystems.push(o),e.subweaponSystems},e.prototype.bulletCollisionDetection=function(){var e=this,t=this.phaserSprites.getGroup("enemy_hitboxes").slice(),a=this.player.collidables.primaryWeapon.concat(this.player.collidables.secondaryWeapon);this.phaserSprites.getManyGroups(["impactExplosions"]).map(function(e){a.push(e)}),this.game.physics.arcade.overlap(t,a,function(t,a){var n=t.parent;if(!n.isDestroyed){var i=a.weaponData;(!n.isDamaged&&!n.isDestroyed||i.ignoreDamageState&&!n.isDestroyed)&&("LASER"===i.reference&&e.weaponManager.electricDischarge(a.x,a.y-a.height,1,n.onLayer+1),"SPREAD"===i.reference&&e.weaponManager.blueImpact(a.x,a.y-a.height,1,n.onLayer+1),"SHOTGUN"===i.reference&&e.weaponManager.pelletImpact(a.x,a.y-a.height,1,n.onLayer+1),"GATLING"===i.reference&&e.weaponManager.pelletImpact(a.x,a.y-a.height,1,n.onLayer+1),"BULLET"===i.reference&&e.weaponManager.orangeImpact(a.x,a.y-a.height,1,n.onLayer+1),"MISSLE"===i.reference&&e.weaponManager.createExplosionBasic(a.x,a.y-a.height,1,n.onLayer+1,Math.round(i.damage/2)),n.damageIt(i.damage)),i.pierce||i.completeAnimation||a.destroyIt(n.onLayer-1)}})},e.prototype.destroyShip=function(e){this.phaserSprites.destroy(e),this.phaserSprites.destroy(e+"_exhaust"),this.phaserSprites.getGroup(e+"_trails").map(function(e){e.destroySelf()})},e}(),UTILITY_MANAGER=function(){function e(){}return e.prototype.assign=function(e,t,a,n,i){this.game=e,this.phaserSprites=t,this.phaserBitmapdata=a,this.phaserGroup=n,this.atlas=i},e.prototype.buildOverlayBackground=function(e,t,a,n){void 0===n&&(n=!1);var i=this.game,o=this.phaserBitmapdata.addGradient({name:"um_overlay__bmd",start:e,end:t,width:5,height:5,render:!1}),r=this.phaserSprites.add({x:0,y:0,name:"um_overlay__bg",width:i.world.width,height:i.world.height,reference:o.cacheBitmapData,visible:n});r.flash=function(e,t){void 0===e&&(e=500),void 0===t&&(t=function(){}),r.visible=!0,r.alpha=1,i.time.events.add(250,function(){i.add.tween(r).to({alpha:0},e,Phaser.Easing.Linear.In,!0,0,0,!1).onComplete.add(function(){}),t()}).autoDestroy=!0},r.fadeIn=function(e,t){void 0===e&&(e=500),void 0===t&&(t=function(){}),r.visible=!0,r.alpha=0,i.add.tween(r).to({alpha:1},e,Phaser.Easing.Linear.In,!0,0,0,!1).onComplete.add(function(){t()})},r.fadeOut=function(e,t){void 0===e&&(e=500),void 0===t&&(t=function(){}),r.visible=!0,r.alpha=1,i.add.tween(r).to({alpha:0},e,Phaser.Easing.Linear.In,!0,0,0,!1).onComplete.add(function(){t()})},this.phaserGroup.add(a,r)},e.prototype.buildOverlayGrid=function(e,t,a,n){void 0===e&&(e=80),void 0===t&&(t=80);for(var i=this.game,o=0,r=0;r<Math.ceil(i.world.height/t)+1;r++)for(var s=function(s){var p=l.phaserSprites.addFromAtlas({x:s*e,y:r*t,name:"grid"+o,group:"um_grid__bg",width:e,height:t,atlas:l.atlas,filename:n,visible:!0});p.anchor.setTo(.5,.5),p.scale.setTo(1,1),p.fadeOut=function(e){p.scale.setTo(1,1),i.add.tween(p).to({height:0},e,Phaser.Easing.Linear.Out,!0,0,0,!1)},p.fadeIn=function(e){i.add.tween(p).to({height:t},e,Phaser.Easing.Linear.In,!0,0,0,!1)},p.scaleOut=function(e){i.add.tween(p.scale).to({x:0,y:0},e,Phaser.Easing.Linear.In,!0,0,0,!1)},p.scaleIn=function(e){i.add.tween(p.scale).to({x:1,y:1},e,Phaser.Easing.Linear.Out,!0,0,0,!1)},o++,l.phaserGroup.add(a,p)},l=this,p=0;p<Math.ceil(i.world.width/e)+1;p++)s(p)},e.prototype.overlayBGControls=function(e,t){var a=e.transition,n=e.delay,i=e.speed,o=this.phaserSprites.getOnly(["um_overlay__bg"]).um_overlay__bg;this.game.time.events.add(n,function(){switch(a){case"FLASHWHITE":o.flash(i,t);break;case"FADEIN":o.fadeIn(i,t);break;case"FADEOUT":o.fadeOut(i,t)}}).autoDestroy=!0},e.prototype.overlayControls=function(e,t){var a=this.game,n=e.transition,i=e.delay,o=e.speed,r=e.tileDelay,s=this.phaserSprites.getGroup("um_grid__bg"),l=[],p=[],h=r*s.length*.75,u=h+r*s.length;a.time.events.add(i,function(){switch(n){case"WIPEIN":s.map(function(e,t){t%2==0?p.push(e):l.push(e)}),p.map(function(e,t){a.time.events.add(r*t,function(){e.scaleIn(o)}).autoDestroy=!0}),a.time.events.add(u,function(){l.slice(0).reverse().map(function(e,t){a.time.events.add(r*t,function(){e.scaleIn(o)}).autoDestroy=!0})},h),a.time.events.add(u,function(){t()}).autoDestroy=!0;break;case"WIPEOUT":s.map(function(e,t){t%2==0?p.push(e):l.push(e)}),p.map(function(e,t){a.time.events.add(r*t,function(){e.scaleOut(o)}).autoDestroy=!0}),a.time.events.add(u,function(){l.slice(0).reverse().map(function(e,t){a.time.events.add(r*t,function(){e.scaleOut(o)}).autoDestroy=!0})},h),a.time.events.add(u,function(){t()}).autoDestroy=!0;break;case"FADEOUT":s.map(function(e,t){a.time.events.add(r*t,function(){e.fadeOut(o)}).autoDestroy=!0}),a.time.events.add(s.length*r+o,function(){t()}).autoDestroy=!0;break;case"FADEIN":s.map(function(e,t){a.time.events.add(u,function(){e.fadeIn(o)},r*t)}),a.time.events.add(u,function(){t()},s.length*r+o)}}).autoDestroy=!0},e}(),WEAPON_MANAGER=function(){function e(){}return e.prototype.assign=function(e,t,a,n,i){this.game=e,this.phaserSprites=a,this.phaserMaster=t,this.phaserGroup=n,this.atlas=i},e.prototype.enemyBullet=function(e){var t=this;void 0===e&&(e=2);var a=this.game,n=(this.phaserMaster,a.add.weapon(e,this.atlas,"enemy_bullet"));return n.bulletKillType=Phaser.Weapon.KILL_CAMERA_BOUNDS,n.bulletSpeed=400,n.bulletAngleOffset=90,n.multiFire=!0,n.checkOrientation=function(e){n.bulletSpeed=-Math.abs(n.bulletSpeed),n.bulletAngleOffset=-Math.abs(n.bulletAngleOffset)},this.phaserGroup.add(7,n.bullets),n.bullets.children.map(function(e){e.destroyIt=function(a){e.kill(),t.orangeImpact(e.x+t.game.rnd.integerInRange(-5,5),e.y+t.game.rnd.integerInRange(-5,15),1,a)}}),n},e.prototype.playerBullets=function(e,t){var a=this.game,n=this.phaserMaster.getAll(["weaponData"]).weaponData.primaryWeapons[t],i=a.add.weapon(e,this.atlas,n.spriteAnimation[0]);switch(i.bulletKillType=Phaser.Weapon.KILL_CAMERA_BOUNDS,i.bulletSpeed=n.bulletSpeed,i.bulletAngleOffset=90,i.multiFire=!0,n.spriteAnimation.length>0&&(i.bullets.callAll("animations.add","animations","fire",n.spriteAnimation,20,!0),i.bullets.callAll("play",null,"fire")),t){case"MISSLE":i.bulletSpeedVariance=300,i.bulletAngleVariance=15;break;case"SHOTGUN":i.bulletSpeedVariance=1e3,i.bulletAngleOffset=-10,i.bulletAngleVariance=20;break;case"GATLING":i.bulletSpeedVariance=300,i.bulletAngleVariance=3}return i.onKill.add(function(e){}),i.checkOrientation=function(e){e<180?(i.bulletSpeed=Math.abs(i.bulletSpeed),i.bulletAngleOffset=Math.abs(i.bulletAngleOffset)):(i.bulletSpeed=-Math.abs(i.bulletSpeed),i.bulletAngleOffset=-Math.abs(i.bulletAngleOffset))},this.phaserGroup.add(8,i.bullets),i.bullets.children.map(function(e){e.weaponData=n,e.pierce=n.pierce,e.destroyIt=function(t){e.kill()}}),i},e.prototype.createClusterbomb=function(e,t){var a=this;void 0===t&&(t=function(){});var n=this.game,i=this.phaserMaster,o=(this.phaserSprites,this.phaserGroup,this.atlas,i.getAll().weaponData.secondaryWeapons.CLUSTERBOMB),r=this.createBomblet(25),s=n.add.weapon(1,this.atlas,o.spriteAnimation[0]);return s.bulletKillType=Phaser.Weapon.KILL_LIFESPAN,s.bulletSpeed=o.bulletSpeed,s.multiFire=!0,s.bulletLifespan=750,s.bomblets=r,o.spriteAnimation.length>0&&(s.bullets.callAll("animations.add","animations","fire",o.spriteAnimation,20,!0),s.bullets.callAll("play",null,"fire")),s.onKill.add(function(e){t(),r.map(function(t){t.fire(e)}),a.createExplosionVacuum(e.x,e.y,1.25,8,o.damage)}),s.bullets.children.map(function(e){e.weaponData=o,e.pierce=o.pierce,e.destroyIt=function(t){e.kill()}}),this.phaserGroup.add(7,s.bullets),s},e.prototype.createBomblet=function(e){for(var t=this,a=this.game,n=this.phaserMaster,i=(this.phaserSprites,this.phaserGroup,this.atlas,n.getAll().weaponData,{reference:"BOMBLET",spriteAnimation:["icon_sw_1"],damage:25,pierce:!1,ignoreDamageState:!1,completeAnimation:!1}),o=[],r=0;r<e;r++){var s=a.add.weapon(1,this.atlas,i.spriteAnimation[0]);s.bulletKillType=Phaser.Weapon.KILL_LIFESPAN,s.bulletSpeed=500+a.rnd.integerInRange(50,150),s.bulletAngleVariance=140,s.bulletLifespan=a.rnd.integerInRange(50,500),i.spriteAnimation.length>0&&(s.bullets.callAll("animations.add","animations","fire",i.spriteAnimation,20,!0),s.bullets.callAll("play",null,"fire")),s.onKill.add(function(e){t.createExplosionBasic(e.x,e.y,1.25,8,i.damage)}),s.bullets.children.map(function(e){e.weaponData=i,e.pierce=i.pierce,e.destroyIt=function(t){e.kill()}}),this.phaserGroup.add(7,s.bullets),o.push(s)}return o},e.prototype.createExplosionVacuum=function(e,t,a,n,i,o,r){void 0===o&&(o=function(){}),void 0===r&&(r=function(){});var s=this.game,l=this.phaserSprites,p=this.phaserGroup,h=this.atlas,u={reference:"EXPLOSION_VACUUM",spriteAnimation:Phaser.Animation.generateFrameNames("explosion_vacuum_",1,9).slice(),damage:25,pierce:!1,ignoreDamageState:!1,completeAnimation:!0},d=l.addFromAtlas({name:"impact_A",group:"impactExplosions",x:e,y:t,atlas:h,filename:u.spriteAnimation[0]});return d.scale.setTo(a,a),d.anchor.setTo(.5,.5),d.weaponData=u,d.animations.add("explosion",u.spriteAnimation,1,!0),d.animations.play("explosion",30,!1).onComplete.add(function(){d.destroyIt()},d),d.destroyIt=function(){l.destroy(d.name)},s.camera.shake(.004,500),void 0!==n&&p.add(n,d),s.physics.enable(d,Phaser.Physics.ARCADE),d},e.prototype.createExplosionVacuumFire=function(e,t,a,n,i,o,r){void 0===o&&(o=function(){}),void 0===r&&(r=function(){});var s=this.game,l=this.phaserSprites,p=this.phaserGroup,h=this.atlas,u={reference:"VACUUMEXPLOSION",spriteAnimation:Phaser.Animation.generateFrameNames("explosion_vacuum_inner_",1,13).slice(),damage:25,pierce:!1,ignoreDamageState:!1,completeAnimation:!0},d=l.addFromAtlas({name:"impact_"+s.rnd.integer(),group:"impactExplosions",x:e,y:t,atlas:h,filename:u.spriteAnimation[0]});return d.scale.setTo(a,a),d.anchor.setTo(.5,.5),d.weaponData=u,d.animations.add("explosion",u.spriteAnimation,1,!0),d.animations.play("explosion",30,!1).onComplete.add(function(){d.destroyIt()},d),d.destroyIt=function(){l.destroy(d.name)},s.camera.shake(.004,500),void 0!==n&&p.add(n,d),s.physics.enable(d,Phaser.Physics.ARCADE),d},e.prototype.createExplosionBasic=function(e,t,a,n,i,o,r){void 0===o&&(o=function(){}),void 0===r&&(r=function(){});var s=this.game,l=this.phaserSprites,p=this.phaserGroup,h=this.atlas,u={reference:"EXPLOSION_BASIC",spriteAnimation:Phaser.Animation.generateFrameNames("explosions_Layer_",1,16),damage:25,pierce:!1,ignoreDamageState:!1,completeAnimation:!0},d=l.addFromAtlas({name:"impact_"+s.rnd.integer(),group:"impactExplosions",x:e,y:t,atlas:h,filename:u.spriteAnimation[0]});return d.scale.setTo(a,a),d.anchor.setTo(.5,.5),d.weaponData=u,d.animations.add("explosion",u.spriteAnimation,1,!0),d.animations.play("explosion",30,!1).onComplete.add(function(){d.destroyIt()},d),d.destroyIt=function(){l.destroy(d.name)},s.camera.shake(.002,500),void 0!==n&&p.add(n,d),s.physics.enable(d,Phaser.Physics.ARCADE),d},e.prototype.createExplosion=function(e,t,a,n,i,o){void 0===i&&(i=function(){}),void 0===o&&(o=function(){});var r=this.game,s=this.phaserSprites,l=this.phaserGroup,p=this.atlas,h={spriteAnimation:Phaser.Animation.generateFrameNames("explosion2_layer_",1,12)},u=s.addFromAtlas({name:"explosion_"+r.rnd.integer(),group:"noimpactExplosions",x:e,y:t,atlas:p,filename:h.spriteAnimation[0]});return u.scale.setTo(a,a),u.anchor.setTo(.5,.5),u.animations.add("explosion",h.spriteAnimation,1,!0),u.animations.play("explosion",30,!1).onComplete.add(function(){u.destroyIt()},u),u.destroyIt=function(){s.destroy(u.name)},void 0!==n&&l.add(n,u),u},e.prototype.pelletImpact=function(e,t,a,n){var i=this.game,o=this.phaserSprites,r=this.phaserGroup,s=this.atlas,l={spriteAnimation:Phaser.Animation.generateFrameNames("sparks_",1,3)},p=o.addFromAtlas({name:"impact_"+i.rnd.integer(),group:"noimpactExplosions",x:e,y:t,atlas:s,filename:l.spriteAnimation[0]});return p.scale.setTo(a,a),p.anchor.setTo(.5,.5),p.animations.add("explosion",l.spriteAnimation,1,!0),p.animations.play("explosion",30,!1).onComplete.add(function(){p.destroyIt()},p),p.destroyIt=function(){o.destroy(p.name)},void 0!==n&&r.add(n,p),i.physics.enable(p,Phaser.Physics.ARCADE),p},e.prototype.blueImpact=function(e,t,a,n){var i=this.game,o=this.phaserSprites,r=this.phaserGroup,s=this.atlas,l={spriteAnimation:Phaser.Animation.generateFrameNames("blue_explosion_small_layer_",1,7)},p=(Phaser.Animation.generateFrameNames("blue_explosion_small_layer_",1,7),o.addFromAtlas({name:"impact_"+i.rnd.integer(),group:"noimpactExplosions",x:e,y:t,atlas:s,filename:l.spriteAnimation[0]}));return p.scale.setTo(a,a),p.anchor.setTo(.5,.5),i.physics.enable(p,Phaser.Physics.ARCADE),p.animations.add("explosion",l.spriteAnimation,1,!0),p.animations.play("explosion",30,!1).onComplete.add(function(){p.destroyIt()},p),p.destroyIt=function(){o.destroy(p.name)},void 0!==n&&r.add(n,p),p},e.prototype.orangeImpact=function(e,t,a,n){var i=this.game,o=this.phaserSprites,r=this.phaserGroup,s=this.atlas,l={spriteAnimation:Phaser.Animation.generateFrameNames("orange_ring_explosion_layer_",1,7)},p=(Phaser.Animation.generateFrameNames("orange_ring_explosion_layer_",1,7),o.addFromAtlas({name:"impact_"+i.rnd.integer(),group:"noimpactExplosions",x:e,y:t,atlas:s,filename:l.spriteAnimation[0]}));return p.scale.setTo(a,a),p.anchor.setTo(.5,.5),i.physics.enable(p,Phaser.Physics.ARCADE),p.animations.add("explosion",l.spriteAnimation,1,!0),p.animations.play("explosion",30,!1).onComplete.add(function(){p.destroyIt()},p),p.destroyIt=function(){o.destroy(p.name)},void 0!==n&&r.add(n,p),p},e.prototype.electricDischarge=function(e,t,a,n){var i=this.game,o=this.phaserSprites,r=this.phaserGroup,s=this.atlas,l={spriteAnimation:Phaser.Animation.generateFrameNames("disintegrate",1,10)},p=o.addFromAtlas({name:"impact_"+i.rnd.integer(),group:"noimpactExplosions",x:e,y:t,atlas:s,filename:l.spriteAnimation[0]});return p.scale.setTo(a,a),p.anchor.setTo(.5,.5),i.physics.enable(p,Phaser.Physics.ARCADE),p.animations.add("explosion",l.spriteAnimation,1,!0),p.animations.play("explosion",30,!1).onComplete.add(function(){p.destroyIt()},p),p.destroyIt=function(){o.destroy(p.name)},void 0!==n&&r.add(n,p),p},e}();