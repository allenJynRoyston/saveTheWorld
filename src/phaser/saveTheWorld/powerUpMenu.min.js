var PhaserGameObject=function(){function t(){this.game=null,this.global={pause:!1}}return t.prototype.init=function(t,e,i){var r=new PHASER_MASTER({game:new Phaser.Game(i.width,i.height,Phaser.WEBGL,t,{preload:function(){var t=r.game();t.load.enableParallel=!0,t.stage.backgroundColor="#2f2f2f";var e="src/phaser/saveTheWorld/resources";t.load.image("texture",e+"/images/cyberglow.png"),t.load.image("equipped",e+"/images/gem.png"),t.load.image("purchased",e+"/images/player.png"),t.load.image("powerup1",e+"/images/bulletBtn.png"),t.load.image("pointer",e+"/images/ship.png"),t.load.bitmapFont("gem",e+"/fonts/gem.png",e+"/fonts/gem.xml"),t.load.json("weaponData",e+"/json/weaponData.json"),r.changeState("PRELOAD"),new PHASER_PRELOADER({game:t,delayInSeconds:0,done:function(){!function(){r.game();a.get("overlay").fadeOut(Phaser.Timer.SECOND/2,function(){r.changeState("READY")})}()}})},create:function(){var t=r.game();n.assign(t),o.assign(t),a.assign(t),s.assign(t),u.assign(t),p.assign(t),c.assign(t,10),r.let("selected",0);var e=t.cache.getJSON("weaponData"),i=[];for(var h in e.primaryWeapons)i.push(e.primaryWeapons[h]);for(var h in e.secondaryWeapons)i.push(e.secondaryWeapons[h]);r.let("weaponList",i);var d=s.addGradient({name:"overlaybmd",start:"#2f2f2f",end:"#2f2f2f",width:5,height:5,render:!1}),m=a.add({x:0,y:0,name:"overlay",reference:d.cacheBitmapData,visible:!0});m.width=t.canvas.width,m.height=t.canvas.height,m.fadeIn=function(e,i){t.add.tween(this).to({alpha:1},e,Phaser.Easing.Linear.In,!0,0,0,!1),setTimeout(function(){i()},e)},m.fadeOut=function(e,i){t.add.tween(this).to({alpha:0},e,Phaser.Easing.Linear.Out,!0,0,0,!1),setTimeout(function(){i()},e)};var v=u.add({name:"header",font:"gem",size:18,default:"Purchase Powerups!"});u.alignToTopCenter("header",10);var b=u.add({name:"instructions",size:14,font:"gem",default:"Trippy!"});b.maxWidth=t.canvas.width-15,u.alignToBottomLeftCorner("instructions",10),s.addGradient({name:"bgGradient",start:"#0000FF",end:"#00008b",width:15,height:15,render:!1});var A=a.add({x:0,y:t.canvas.height-b.height-15,name:"spriteBg1",reference:s.get("bgGradient").cacheBitmapData});A.width=t.canvas.width,A.height=t.canvas.height;var x=a.add({x:0,y:0,name:"spriteBg2",reference:s.get("bgGradient").cacheBitmapData});x.width=t.canvas.width,x.height=v.height+30;var E=a.add({name:"popupBox",group:"popupBoxGroup",reference:s.get("bgGradient").cacheBitmapData,visible:!1});E.popUp=function(t,e){var i=this;void 0===e&&(e=function(){});var r=u.add({name:"popupText",group:"popupBoxGroup",font:"gem",size:18,default:""+t,visible:!0});u.center("popupText"),r.alpha=0,this.visible=!0,this.width=r.width+50,this.height=r.height+50,this.x=r.x-25,this.y=r.y-25-20,this.game.add.tween(this).to({y:this.y+20,alpha:1},100,Phaser.Easing.Linear.In,!0,0,0,!1).onComplete.add(function(){i.game.add.tween(r).to({alpha:1},100,Phaser.Easing.Linear.In,!0,0,0,!1).onComplete.add(function(){e()})})},E.popOut=function(t){var e=this;void 0===t&&(t=function(){});var i=u.get("popupText");this.game.add.tween(i).to({alpha:0},100,Phaser.Easing.Linear.Out,!0,0,0,!1).onComplete.add(function(){u.destroy("popupText"),e.game.add.tween(e).to({alpha:0},100,Phaser.Easing.Linear.Out,!0,0,0,!1).onComplete.add(function(){t()})})},c.addMany(10,[m]),c.addMany(9,[v,b]),c.addMany(8,[A,x,E]);r.let("columns",4);var R,T=0,B=0;i.forEach(function(e,i){var r=a.add({name:"powerUp_"+i,reference:""+e.sprite});R=t.canvas.width/4*B+t.canvas.width/4/2-r.width/2,r.x=R,r.y=200*T+100;var n=a.add({name:"equippedIcon_"+i,group:"e",reference:"equipped",visible:!1});R=t.canvas.width/4*B+t.canvas.width/4/2-n.width/2,n.x=R,n.y=200*T+80;var o=a.add({name:"purchasedIcon_"+i,group:"p",reference:"purchased",visible:!1});R=t.canvas.width/4*B+t.canvas.width/4/2-o.width/2,o.x=R,o.y=200*T+150,B++,3!==i&&7!==i||(T++,B=0),c.add(5,r),c.addMany(6,[n,o])});var w=a.add({x:0,y:0,name:"pointer",reference:"pointer"});c.add(6,w),l(),g(),y(0),f(0)},update:function(){r.game();r.checkState("READY")&&(n.checkWithDelay({isActive:!0,key:"LEFT",delay:250})&&m(-1),n.checkWithDelay({isActive:!0,key:"RIGHT",delay:250})&&m(1),n.checkWithDelay({isActive:!0,key:"UP",delay:250})&&m(-r.get("columns")),n.checkWithDelay({isActive:!0,key:"DOWN",delay:250})&&m(r.get("columns")),n.checkWithDelay({isActive:!0,key:"START",delay:250})&&(t=r.get("selected"),i=r.get("weaponList")[t],o=r.get("gameData"),i.purchased?(o[i.type]=i,d(i.type,o[i.type]),l()):i.canPurchase?(o.money-=i.price,o.purchaseHistory.push(i.id),y(t),f(t),d("purchaseHistory",o.purchaseHistory),o[i.type]=i,d(i.type,o[i.type]),g(),l(),v("Purchased "+i.name,1500)):v("Insufficient funds",800)),n.checkWithDelay({isActive:!0,key:"BACK",delay:250})&&e.test());var t,i,o}}),resolution:{width:i.width,height:i.height}}),n=new PHASER_CONTROLS,o=new PHASER_MOUSE({showDebugger:!1}),a=new PHASER_SPRITE_MANAGER,s=new PHASER_BITMAPDATA_MANAGER,u=new PHASER_TEXT_MANAGER,p=new PHASER_BUTTON_MANAGER,c=new PHASER_GROUP_MANAGER,h=i.store;function d(t,e){var i=r.get("gameData");i[t]=e,h.commit("setGamedata",i)}function l(){var t=r.get("weaponList"),e=r.get("gameData");a.getGroup("e").forEach(function(t){t.visible=!1}),t.forEach(function(t,i){t.id===e.primaryWeapon.id&&(a.get("equippedIcon_"+i).visible=!0),t.id===e.secondaryWeapon.id&&(a.get("equippedIcon_"+i).visible=!0)})}function g(){var t=r.get("weaponList"),e=r.get("gameData"),i=r.get("gameData").purchaseHistory;t.forEach(function(t,r){t.purchased=!1,t.canPurchase=e.money>=t.price;for(var n=0,o=i;n<o.length;n++){var s=o[n];t.id===s&&(t.purchased=!0,t.canPurchase=!1,a.get("purchasedIcon_"+r).visible=!0)}}),r.forceLet("weaponList",t)}function y(t){var e=a.get("powerUp_"+t),i=a.get("pointer");i.x=e.x-27,i.y=e.y+e.height+20}function f(t){var e=r.get("weaponList"),i=u.get("instructions");e[t].purchased?i.setText("[PURCHASED] "+e[t].description+"."):i.setText(e[t].description+".")}function m(t){var e=r.get("selected"),i=r.get("weaponList");(e+=t)>i.length-1&&(e=i.length-1),e<0&&(e=0),y(e),f(e),r.forceLet("selected",e)}function v(t,e){r.changeState("FREEZE");var i=a.get("popupBox");i.popUp(t),setTimeout(function(){i.popOut(function(){r.changeState("READY")})},e)}r.let("gameData",h.getters._gameData()),e.game=this,this.game=r.game()},t.prototype.destroy=function(){this.game.destroy()},t}(),__phaser=new PhaserGameObject,PHASER_AUDIO=function(){return function(){}}(),PHASER_BITMAPDATA_MANAGER=function(){function t(){this.game=null,this.bmd={array:[],object:{}}}return t.prototype.assign=function(t){this.game=t},t.prototype.addGradient=function(t){if(0===this.bmd.array.filter(function(e){return e.name===t.name}).length){var e=this.game.make.bitmapData(t.width,t.height),i=e.context.createLinearGradient(0,0,0,t.height);i.addColorStop(0,t.start),i.addColorStop(1,t.end),e.context.fillStyle=i,e.context.fillRect(0,0,t.width,t.height);var r=this.game.cache.addBitmapData(t.name,e),n=this.game.make.bitmapData();return n.load(this.game.cache.getBitmapData(t.name)),t.render&&n.addToWorld(t.x,t.y),n.name=t.name,n.group=t.group,n.cacheBitmapData=r,this.bmd.array.push(n),this.bmd.object[t.name]=n,n}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.addImage=function(t){if(0===this.bmd.array.filter(function(e){return e.name===t.name}).length){var e=this.game.make.bitmapData();return e.load(t.reference),e.addToWorld(t.x,t.y),t.render||e.cls(),e.name=t.name,e.group=t.group,e.cacheBitmapData=t.reference,this.bmd.array.push(e),this.bmd.object[t.name]=e,e}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.addEmpty=function(t){if(0===this.bmd.array.filter(function(e){return e.name===t.name}).length){var e=this.game.make.bitmapData(t.width,t.height);return e.addToWorld(t.x,t.y),t.render||e.cls(),e.name=t.name,e.group=t.group,this.bmd.array.push(e),this.bmd.object[t.name]=e,e}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.destroy=function(t){for(var e=[],i=0,r=this.bmd.array.filter(function(e){return e.name===t});i<r.length;i++){var n=r[i];e.push(n.name),n.destroy()}return delete this.bmd.object[t],this.bmd.array=this.bmd.array.filter(function(e){return e.name!==t}),e},t.prototype.destroyGroup=function(t){for(var e=[],i=0,r=this.bmd.array.filter(function(t){return t.group===name});i<r.length;i++){var n=r[i];e.push(n.name),n.destroy()}return delete this.bmd.object[name],this.bmd.array=this.bmd.array.filter(function(t){return t.group!==name}),e},t.prototype.get=function(t){return this.bmd.object[t]},t.prototype.getGroup=function(t){return this.bmd.array.filter(function(e){return e.group===t})},t.prototype.getAll=function(t){return void 0===t&&(t="BOTH"),"ARRAY"===t?this.bmd.array:"OBJECT"==t?this.bmd.object:{object:this.bmd.object,array:this.bmd.array}},t}(),PHASER_BUTTON_MANAGER=function(){function t(){this.game=null,this.resources={array:[],object:{}}}return t.prototype.assign=function(t){this.game=t.game},t.prototype.add=function(t){if(0===this.resources.array.filter(function(e){return e.name===t.name}).length){var e=this.game.add.button(t.x,t.y,t.reference,t.onclick);return e.name=t.name,e.group=t.group||null,this.resources.array.push(e),this.resources.object[t.name]=e,e}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.destroy=function(t){for(var e=[],i=0,r=this.resources.array.filter(function(e){return e.key===t});i<r.length;i++){var n=r[i];e.push(n.key),n.destroy()}return delete this.resources.object[t],this.resources.array=this.resources.array.filter(function(e){return e.key!==t}),e},t.prototype.destroyGroup=function(t){for(var e=[],i=0,r=this.resources.array.filter(function(e){return e.group===t});i<r.length;i++){var n=r[i];e.push(n.key),n.destroy()}return delete this.resources.object[t],this.resources.array=this.resources.array.filter(function(e){return e.group!==t}),e},t.prototype.get=function(t){return this.resources.object[t]},t.prototype.getGroup=function(t){return this.resources.array.filter(function(e){return e.group===t})},t.prototype.getAll=function(t){return void 0===t&&(t="BOTH"),"ARRAY"===t?this.resources.array:"OBJECT"==t?this.resources.object:{object:this.resources.object,array:this.resources.array}},t}(),PHASER_CONTROLS=function(){function t(){this.IO=null,this.game=null,this.buttonSensitivity={QUICK:1,SHORT:50,LONG:150,SUPERLONG:300},this.properties={isReady:!1,allowDebugger:!0,buttonDelay:50,timingRefreshRate:1},this.directionalButtons=["UP","DOWN","LEFT","RIGHT"],this.actionButtons=["A","B","X","Y"],this.triggerButtons=["L1","L2","R1","R2","L3","R3"],this.systemButtons=["START","BACK"],this.buttonArray=this.directionalButtons.concat(this.actionButtons,this.triggerButtons,this.systemButtons),this.buttonMap={UP:{name:"UP",code:"ArrowUp"},DOWN:{name:"DOWN",code:"ArrowDown"},LEFT:{name:"LEFT",code:"ArrowLeft"},RIGHT:{name:"RIGHT",code:"ArrowRight"},A:{name:"A",code:"KeyA"},B:{name:"S",code:"KeyS"},X:{name:"D",code:"KeyD"},Y:{name:"F",code:"KeyF"},L1:{name:"Q",code:"KeyQ"},L2:{name:"W",code:"KeyW"},R1:{name:"E",code:"KeyE"},R2:{name:"R",code:"KeyR"},L3:{name:"O",code:"KeyO"},R3:{name:"P",code:"KeyP"},START:{name:"ENTER",code:"Enter"},BACK:{name:"BACKSPACE",code:"Backspace"}},this.buttonMapId={UP:1,DOWN:2,LEFT:3,RIGHT:4,A:5,B:6,X:7,Y:8,L1:9,L2:10,R1:11,R2:12,L3:13,R3:14,START:15,BACK:16},this.disabledButtons={ALL:!1,DIRECTIONAL:!1,TRIGGER:!1,ACTION:!1,SYSTEM:!1},this.debugger={enabled:!1,text:{}},this.inputDelay={delay:Array.apply(null,Array(20)).map(function(){return 0})}}return t.prototype.assign=function(t){var e=this;this.game=t;var i={font:"12px Courier New",fill:"#fff",align:"left"};this.buttonArray.forEach(function(r,n){e.debugger.text[r]=null,e.debugger.text[r]=t.add.text(10,10+15*n,"",i),e.disabledButtons[r]=!1});for(var r={buttons:{},sensitivityPress:{},sensitivityBuffer:{},state:{}},n=function(i){r.buttons[i]=t.input.keyboard.addKey(Phaser.Keyboard[o.buttonMap[i].name]),r.sensitivityPress[i]=null,r.sensitivityBuffer[i]=0,r.state[i]=function(){return e.getBtnPressType(e.IO.sensitivityBuffer[i])}},o=this,a=0,s=this.buttonArray;a<s.length;a++){n(s[a])}for(var u=function(t){r.buttons[t].onDown.add(function(i){var n,o;clearInterval(r.sensitivityPress[t]);var a=["DIRECTIONAL","ACTION","TRIGGER","SYSTEM"];Object.keys(e.buttonMap).forEach(function(t,r){if(e.buttonMap[t].code===i.event.code)for(var s=0,u=a;s<u.length;s++){var p=u[s];e[p.toLowerCase()+"Buttons"].indexOf(t)+1&&(n=p,o=t)}});var s=!1;e.disabledButtons.ALL&&(s=!0);for(var u=0,p=a;u<p.length;u++){var c=p[u];e.disabledButtons[c]&&n===c&&(s=!0)}Object.keys(e.buttonMap).forEach(function(t,i){e.disabledButtons[t]&&o===t&&(s=!0)}),s||(r.sensitivityPress[t]=setInterval(function(){r.sensitivityBuffer[t]+=1},e.properties.timingRefreshRate))},p)},p=this,c=0,h=this.buttonArray;c<h.length;c++){u(h[c])}return t.input.keyboard.onUpCallback=function(t){for(var i=0,n=e.buttonArray;i<n.length;i++){var o=n[i];t.code===e.buttonMap[o].code&&(clearInterval(r.sensitivityPress[o]),r.sensitivityBuffer[o]=0)}"Backquote"===t.code&&e.properties.allowDebugger&&(e.setDebugger(!e.debugger.enabled),e.updateDebugger())},this.properties.isReady=!0,this.IO=r,r},t.prototype.mapKeys=function(t){var e=this;this.properties.isReady=!1,this.destroyAll(),setTimeout(function(){e.buttonMap=t,e.properties.isReady=!0,e.assign(e.game)},1)},t.prototype.isReady=function(){return this.properties.isReady},t.prototype.checkWithDelay=function(t){return this.read(t.key).active===t.isActive&&(this.game.time.now>this.inputDelay.delay[this.getKeyId(t.key)]&&(this.inputDelay.delay[this.getKeyId(t.key)]=t.delay+this.game.time.now,!0))},t.prototype.isDebuggerEnabled=function(){return this.debugger.enabled},t.prototype.setDebugger=function(t){void 0===t&&(t=!0),this.debugger.enabled=t},t.prototype.updateDebugger=function(){if(this.properties.isReady)for(var t=0,e=this.buttonArray;t<e.length;t++){var i=e[t];this.debugger.text[i].setText(this.debugger.enabled?this.debuggerString(i):"").bringToTop()}},t.prototype.disableAllInput=function(){this.disabledButtons.ALL=!0},t.prototype.enableAllInput=function(){this.disabledButtons.ALL=!1},t.prototype.disableAllDirectionalButtons=function(){this.disabledButtons.DIRECTIONAL=!0},t.prototype.enableAllDirectionalButtons=function(){this.disabledButtons.DIRECTIONAL=!1},t.prototype.disableAllTriggerButtons=function(){this.disabledButtons.TRIGGER=!0},t.prototype.enableAllTriggerButtons=function(){this.disabledButtons.TRIGGER=!1},t.prototype.disableAllActionButtons=function(){this.disabledButtons.ACTION=!0},t.prototype.enableAllActionButtons=function(){this.disabledButtons.ACTION=!1},t.prototype.disableAllSystemButtons=function(){this.disabledButtons.SYSTEM=!0},t.prototype.enableAllSystemButtons=function(){this.disabledButtons.SYSTEM=!1},t.prototype.setDisableKeyProperty=function(t,e){void 0===e&&(e=!0),this.properties.isReady&&(this.disabledButtons[t.toUpperCase()]=e)},t.prototype.getKeyDisabledValue=function(t){return this.properties.isReady?this.disabledButtons[t.toUpperCase()]:null},t.prototype.clearAllControlIntervals=function(){if(this.properties.isReady)for(var t=0,e=this.buttonArray;t<e.length;t++){var i=e[t];clearInterval(this.IO.sensitivityPress[i])}},t.prototype.getKeyId=function(t){return this.buttonMapId[t.toUpperCase()]},t.prototype.read=function(t){if(this.properties.isReady){return{}[t]={id:this.buttonMapId[t.toUpperCase()],active:this.IO.state[t.toUpperCase()]().val>0,duration:this.IO.state[t.toUpperCase()]().val,state:this.IO.state[t.toUpperCase()]().state,type:this.IO.state[t.toUpperCase()]().type,disabled:this.disabledButtons[t.toUpperCase()]}}return{}},t.prototype.readMulti=function(t,e){if(void 0===e&&(e="OBJECT"),this.properties.isReady){if("OBJECT"===e){for(var i={},r=0,n=t;r<n.length;r++){i[s=n[r]]={id:this.buttonMapId[s.toUpperCase()],active:this.IO.state[s.toUpperCase()]().val>0,duration:this.IO.state[s.toUpperCase()]().val,state:this.IO.state[s.toUpperCase()]().state,type:this.IO.state[s.toUpperCase()]().type,disabled:this.disabledButtons[s.toUpperCase()]}}return i}if("ARRAY"===e){i=[];for(var o=0,a=t;o<a.length;o++){var s=a[o];i.push({id:this.buttonMapId[s.toUpperCase()],key:s,active:this.IO.state[s.toUpperCase()]().val>0,duration:this.IO.state[s.toUpperCase()]().val,state:this.IO.state[s.toUpperCase()]().state,type:this.IO.state[s.toUpperCase()]().type,disabled:this.disabledButtons[s.toUpperCase()]})}return i}}},t.prototype.debuggerString=function(t){return t.toUpperCase()+" ("+this.buttonMap[t.toUpperCase()].name+"/"+this.buttonMap[t.toUpperCase()].code+") | id: "+this.buttonMapId[t.toUpperCase()]+" duration: "+this.IO.state[t.toUpperCase()]().val+" | state: "+this.IO.state[t.toUpperCase()]().state+" | type: "+this.IO.state[t.toUpperCase()]().type+" | disabled: "+this.disabledButtons[t.toUpperCase()]},t.prototype.getBtnPressType=function(t){var e=this,i="NONE",r=0,n=0;return Object.keys(this.buttonSensitivity).forEach(function(o){n++,t>e.buttonSensitivity[o]&&(i=o,r=n)}),{val:t,type:i,state:r}},t.prototype.destroyAll=function(){var t=this;this.clearAllControlIntervals(),Object.keys(this.debugger.text).forEach(function(e){t.debugger.text[e].destroy()})},t}(),PHASER_GROUP_MANAGER=function(){function t(){this.game=null,this.group={array:[],object:{}}}return t.prototype.assign=function(t,e){void 0===e&&(e=10),this.game=t;for(var i=0;i<=e;i++){var r=t.add.group();this.group.object[""+i]=r,this.group.array.push(r)}},t.prototype.layer=function(t){return this.group.object[t]},t.prototype.add=function(t,e){this.group.object[t].add(e)},t.prototype.addMany=function(t,e){var i=this;e.forEach(function(e){i.group.object[t].add(e)})},t}(),PHASER_MASTER=function(){function t(t){this._game=t.game,this.resolution=t.resolution,this.states={BOOT:"BOOT",PRELOAD:"PRELOAD",READY:"READY"},this.currentState=this.states[0],this.variables={}}return t.prototype.let=function(t,e){if(void 0===e&&(e=null),void 0===this.variables[t])return this.variables[t]=e;console.log("Cannot LET duplicate key in PHASER_MASTER: "+t)},t.prototype.forceLet=function(t,e){return void 0===e&&(e=null),this.variables[t]=e},t.prototype.delete=function(t){delete this.variables[t]},t.prototype.get=function(t){return void 0!==this.variables[t]?this.variables[t]:(console.log("Cannot GET a variable that does not exist in PHASER_MASTER."),null)},t.prototype.changeState=function(t){void 0===t&&(t=null);var e=t.toUpperCase(),i=!1;return void 0===this.states[e]&&(this.states[e]=e,i=!0),this.currentState=e,{created:i,state:this.currentState}},t.prototype.getCurrentState=function(){return this.currentState},t.prototype.getStates=function(){return this.states},t.prototype.getResolution=function(){return this.resolution},t.prototype.checkState=function(t){return this.currentState===t.toUpperCase()},t.prototype.game=function(){return this._game},t}(),PHASER_MOUSE=function(){function t(t){this.game=null,this.clickSensitvity={QUICK:1,SHORT:50,LONG:150,SUPERLONG:300},this.mouseMapping=[0,1,2],this.mouseMap={LEFT:0,MIDDLE:1,RIGHT:2},this.metrics={sensitivityPress:{},sensitivityBuffer:{},location:{},state:{}},this.properties={allowDebugger:!0,timingRefreshRate:1},this.inputDelay={delay:Array.apply(null,Array(2)).map(function(){return 0})},this.debugger={enabled:void 0!==t.showDebugger&&t.showDebugger,text:{},pointer:null}}return t.prototype.assign=function(t){var e=this;this.game=t;for(var i=function(t){r.metrics.sensitivityPress[t]=null,r.metrics.sensitivityBuffer[t]=0,r.metrics.location[t]={x:null,y:null},r.metrics.state[t]=function(){return e.getBtnPressType(e.metrics.sensitivityBuffer[t])}},r=this,n=0,o=this.mouseMapping;n<o.length;n++){i(o[n])}this.game.input.onDown.add(function(t){var i=e.checkMouseClick();clearInterval(e.metrics.sensitivityPress[i]),e.metrics.sensitivityPress[i]=setInterval(function(){e.metrics.sensitivityBuffer[i]+=1,e.metrics.location[i]={x:t.x,y:t.y}},e.properties.timingRefreshRate)}),this.game.input.onUp.add(function(t){var i=e.checkMouseClick();e.clearAllControlIntervals(),e.metrics.sensitivityBuffer[i]=0});var a={font:"12px Courier New",fill:"#fff",align:"left"};this.mouseMapping.forEach(function(t,i){e.debugger.text[t]=null,e.debugger.text[t]=e.game.add.text(5,e.game.height-35-15*i,"",a)}),this.debugger.pointer=this.game.add.text(5,this.game.height-20,"",a),t.canvas.oncontextmenu=function(t){t.preventDefault()}},t.prototype.checkMouseClick=function(){var t=0;return this.game.input.activePointer.leftButton.isDown&&(t=0),this.game.input.activePointer.middleButton.isDown&&(t=1),this.game.input.activePointer.rightButton.isDown&&(t=2),t},t.prototype.debuggerString=function(t){return"Button_"+t+" | {x: "+this.metrics.location[t].x+", y: "+this.metrics.location[t].y+"} | active: "+(this.metrics.sensitivityBuffer[t]>0)+" | state: "+this.metrics.state[t]().state+" | duration: "+this.metrics.state[t]().val+" | type: "+this.metrics.state[t]().type},t.prototype.setDebugger=function(t){void 0===t&&(t=!0),this.debugger.enabled=t},t.prototype.updateDebugger=function(){for(var t=0,e=this.mouseMapping;t<e.length;t++){var i=e[t];this.debugger.text[i].setText(this.debugger.enabled?this.debuggerString(i):"").bringToTop()}this.debugger.pointer.setText(this.debugger.enabled?"Pointer: {x: "+this.game.input.mousePointer.x+", y: "+this.game.input.mousePointer.y+"}":"").bringToTop()},t.prototype.clearAllControlIntervals=function(){for(var t=0,e=this.mouseMapping;t<e.length;t++){var i=e[t];this.metrics.sensitivityBuffer[i]=0,clearInterval(this.metrics.sensitivityPress[i])}},t.prototype.checkWithDelay=function(t){if(this.read(t.key).active===t.isActive){var e=this.mouseMap[t.key.toUpperCase()];return this.game.time.now>this.inputDelay.delay[e]&&(this.inputDelay.delay[e]=t.delay+this.game.time.now,!0)}return!1},t.prototype.read=function(t){void 0===t&&(t="LEFT");var e=this.mouseMap[t.toUpperCase()];return{id:e,x:this.metrics.location[e].x,y:this.metrics.location[e].y,active:this.metrics.sensitivityBuffer[e]>0,duration:this.metrics.sensitivityBuffer[e],state:this.metrics.state[e]().state,type:this.metrics.state[e]().type}},t.prototype.getBtnPressType=function(t){var e=this,i="NONE",r=0,n=0;return Object.keys(this.clickSensitvity).forEach(function(o){n++,t>e.clickSensitvity[o]&&(i=o,r=n)}),{val:t,type:i,state:r}},t}(),PHASER_PRELOADER=function(){function t(t){this.game=t.game,this.init(t.delayInSeconds,t.done)}return t.prototype.init=function(t,e){var i,r,n=this;this.game.load.onLoadStart.add(function(){(i=n.game.add.text(n.game.world.centerX,n.game.world.centerY/2,"",{font:"18px Impact",fill:"#fff",align:"center"})).anchor.set(.5),(r=n.game.add.text(n.game.world.centerX,n.game.world.centerY,"",{font:"32px Impact",fill:"#fff",align:"center"})).anchor.set(.5)},this),this.game.load.onFileComplete.add(function(t,e,n,o,a){i.setText("Please wait..."),r.setText(t+"%")},this),this.game.load.onLoadComplete.add(function(){i.setText("File loaded!"),r.setText(""),n.game.time.events.add(Phaser.Timer.SECOND*t,function(){i.destroy(),r.destroy(),e()},n).autoDestroy=!0},this)},t}(),PHASER_SPRITE_MANAGER=function(){function t(){this.game=null,this.sprites={array:[],object:{}},this.spriteCount=0}return t.prototype.assign=function(t){this.game=t},t.prototype.add=function(t){if(0===this.sprites.array.filter(function(e){return e.name===t.name}).length){t.x=void 0!==t.x?t.x:0,t.y=void 0!==t.y?t.y:0,t.group=void 0!==t.group?t.group:null,t.visible=void 0===t.visible||t.visible;var e=this.game.add.sprite(t.x,t.y,t.reference);return e.name=t.name,e.group=t.group,e.defaultPosition={x:t.x,y:t.y},e.visible=t.visible,e.setDefaultPositions=function(t,e){this.defaultPosition.x=t,this.defaultPosition.y=e},e.getDefaultPositions=function(){return this.defaultPosition},this.sprites.array.push(e),this.sprites.object[t.name]=e,e}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.destroy=function(t){if(void 0!==this.sprites.object[t]){for(var e=[],i=0,r=this.sprites.array.filter(function(e){return e.name===t});i<r.length;i++){var n=r[i];e.push(n.name),n.destroy()}return delete this.sprites.object[t],this.sprites.array=this.sprites.array.filter(function(e){return e.name!==t}),e}return console.log("Cannot delete "+t+" because it does not exist."),null},t.prototype.destroyGroup=function(t){for(var e=[],i=0,r=this.sprites.array.filter(function(e){return e.group===t});i<r.length;i++){var n=r[i];e.push(n.name),n.destroy()}return delete this.sprites.object[t],this.sprites.array=this.sprites.array.filter(function(e){return e.group!==t}),e},t.prototype.get=function(t){return this.sprites.object[t]},t.prototype.getGroup=function(t){return this.sprites.array.filter(function(e){return e.group===t})},t.prototype.getAll=function(t){return void 0===t&&(t="BOTH"),"ARRAY"===t?this.sprites.array:"OBJECT"==t?this.sprites.object:{object:this.sprites.object,array:this.sprites.array}},t.prototype.count=function(){return this.spriteCount++,{total:this.sprites.array.length,unique:this.spriteCount}},t.prototype.centerWorld=function(t){if(void 0===this.sprites.object[t])return console.log("Error centering sprite:  key does not exists."),null;var e=this.sprites.object[t];return e.alignIn(this.game.world.bounds,Phaser.CENTER),e},t.prototype.centerOnPoint=function(t,e,i){if(void 0===this.sprites.object[t])return console.log("Error centering sprite:  key does not exists."),null;var r=this.sprites.object[t];return r.x=e-r.width/2,r.y=i-r.height/2,r},t}(),PHASER_TEXT_MANAGER=function(){function t(){this.game=null,this.texts={array:[],object:{}}}return t.prototype.assign=function(t){this.game=t},t.prototype.add=function(t){var e=this.texts.array.filter(function(e){return e.name===t.name});if(t.x=void 0!==t.x?t.x:0,t.y=void 0!==t.y?t.y:0,t.group=void 0!==t.group?t.group:null,t.size=void 0!==t.size?t.size:12,t.default=void 0!==t.default?t.default:"",t.visible=void 0===t.visible||t.visible,0===e.length){var i=this.game.add.bitmapText(t.x,t.y,t.font,t.default,t.size);return i.name=t.name,i.group=t.group,i.visible=t.visible,this.texts.array.push(i),this.texts.object[t.name]=i,i}console.log("Duplicate key name not allowed: "+t.name)},t.prototype.destroy=function(t){for(var e=[],i=0,r=this.texts.array.filter(function(e){return e.name===t});i<r.length;i++){var n=r[i];e.push(n.name),n.destroy()}return delete this.texts.object[t],this.texts.array=this.texts.array.filter(function(e){return e.name!==t}),e},t.prototype.destroyGroup=function(t){for(var e=[],i=0,r=this.texts.array.filter(function(e){return e.group===t});i<r.length;i++){var n=r[i];e.push(n.key),n.destroy()}return delete this.texts.object[t],this.texts.array=this.texts.array.filter(function(e){return e.group!==t}),e},t.prototype.get=function(t){return this.texts.object[t]},t.prototype.getGroup=function(t){return this.texts.array.filter(function(e){return e.group===t})},t.prototype.getAll=function(t){return void 0===t&&(t="BOTH"),"ARRAY"===t?this.texts.array:"OBJECT"==t?this.texts.object:{object:this.texts.object,array:this.texts.array}},t.prototype.alignToBottomLeftCorner=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],r=this.game;return i.x=e,i.y=r.canvas.height-i.height-e,i},t.prototype.alignToBottomCenter=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],r=this.game;return i.x=r.canvas.width/2-i.width/2,i.y=r.canvas.height-i.height-e,i},t.prototype.alignToBottomRightCorner=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],r=this.game;return i.x=r.canvas.width-i.width-e,i.y=r.canvas.height-i.height-e,i},t.prototype.alignToCenterRight=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],r=this.game;return i.x=r.canvas.width-i.width-e,i.y=r.canvas.height/2-i.height/2,i},t.prototype.alignToTopRightCorner=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],r=this.game;return i.x=r.canvas.width-i.width-e,i.y=e,i},t.prototype.alignToTopCenter=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],r=this.game;return i.x=r.canvas.width/2-i.width/2-e,i.y=e,i},t.prototype.alignToTopLeftCorner=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t];this.game;return i.x=e,i.y=e,i},t.prototype.alignToCenterLeft=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],r=this.game;return i.x=e,i.y=r.canvas.height/2-i.height/2,i},t.prototype.alignToCenter=function(t,e){if(void 0===e&&(e=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var i=this.texts.object[t],r=this.game;return i.x=r.canvas.width/2-i.width/2,i.y=r.canvas.height/2-i.height/2,i},t.prototype.center=function(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=0),void 0===this.texts.object[t])return console.log("Error centering sprite:  key does not exists."),null;var r=this.texts.object[t],n=this.game;return r.x=n.canvas.width/2-r.width/2+e,r.y=n.canvas.height/2-r.height/2+i,r},t}(),BULLET_CLASS=function(){function t(t,e,i,r,n,o,a){this.game=e.game();r.getGroup("bullets").length,e.get("primaryWeapon");this.bullet=r.add({x:a.x,y:a.y,name:"bullet_"+this.game.rnd.integer(),group:"bullets",reference:"bullet"}),this.game.physics.enable(this.bullet,t.Physics.ARCADE),this.bullet.body.velocity.y=-100,i.add(2,this.bullet),this.COLLIDABLES=o,this.bullet.onUpdate=this.onUpdate()}return t.prototype.accelerate=function(){},t.prototype.destroyIt=function(){},t.prototype.onUpdate=function(){var t=this;this.accelerate(),this.y<0&&this.destroyIt(),this.COLLIDABLES.forEach(function(e){e.game.physics.arcade.overlap(t,e,function(e,i){t.WEAPON_DATA.pierce||e.destroyIt(),i.damageIt(t.WEAPON_DATA.damage*t.options.damageMod)},null,t)})},t}();